<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Serverless — from the beginning, using Azure functions ( Azure portal ), part II</title>
    <meta name="description" content="[object Object]">
    
    
    <link rel="preload" href="/assets/css/0.styles.70976983.css" as="style"><link rel="preload" href="/assets/js/app.b3ccf621.js" as="script"><link rel="preload" href="/assets/js/5.218403d0.js" as="script"><link rel="preload" href="/assets/js/4.5f5dd8b1.js" as="script"><link rel="preload" href="/assets/js/51.38d8e88e.js" as="script"><link rel="prefetch" href="/assets/js/1.87395e1a.js"><link rel="prefetch" href="/assets/js/10.39a58581.js"><link rel="prefetch" href="/assets/js/11.48005f74.js"><link rel="prefetch" href="/assets/js/12.16c3febe.js"><link rel="prefetch" href="/assets/js/13.d1becdba.js"><link rel="prefetch" href="/assets/js/14.11a1ed13.js"><link rel="prefetch" href="/assets/js/15.b30cb08a.js"><link rel="prefetch" href="/assets/js/16.6d727d0b.js"><link rel="prefetch" href="/assets/js/17.37d90118.js"><link rel="prefetch" href="/assets/js/18.b53edd4c.js"><link rel="prefetch" href="/assets/js/19.d798447c.js"><link rel="prefetch" href="/assets/js/20.77dd395a.js"><link rel="prefetch" href="/assets/js/21.91ed5e26.js"><link rel="prefetch" href="/assets/js/22.3bc3cf71.js"><link rel="prefetch" href="/assets/js/23.c0a090ba.js"><link rel="prefetch" href="/assets/js/24.221a1ed1.js"><link rel="prefetch" href="/assets/js/25.b24b0455.js"><link rel="prefetch" href="/assets/js/26.2a638c2a.js"><link rel="prefetch" href="/assets/js/27.06e8c3f0.js"><link rel="prefetch" href="/assets/js/28.1637d68f.js"><link rel="prefetch" href="/assets/js/29.f9ef135e.js"><link rel="prefetch" href="/assets/js/3.045049e4.js"><link rel="prefetch" href="/assets/js/30.51c7e0ff.js"><link rel="prefetch" href="/assets/js/31.82522e6e.js"><link rel="prefetch" href="/assets/js/32.be535b9e.js"><link rel="prefetch" href="/assets/js/33.d216d6d1.js"><link rel="prefetch" href="/assets/js/34.193de55d.js"><link rel="prefetch" href="/assets/js/35.b99f9336.js"><link rel="prefetch" href="/assets/js/36.19a0007e.js"><link rel="prefetch" href="/assets/js/37.cdfbb1d7.js"><link rel="prefetch" href="/assets/js/38.b3f30674.js"><link rel="prefetch" href="/assets/js/39.84d85d8f.js"><link rel="prefetch" href="/assets/js/40.236fba80.js"><link rel="prefetch" href="/assets/js/41.23a64035.js"><link rel="prefetch" href="/assets/js/42.bdee99cb.js"><link rel="prefetch" href="/assets/js/43.2901a31e.js"><link rel="prefetch" href="/assets/js/44.dab8c016.js"><link rel="prefetch" href="/assets/js/45.a6379e83.js"><link rel="prefetch" href="/assets/js/46.a912208b.js"><link rel="prefetch" href="/assets/js/47.b5da29cd.js"><link rel="prefetch" href="/assets/js/48.e7e31177.js"><link rel="prefetch" href="/assets/js/49.cbd23f5a.js"><link rel="prefetch" href="/assets/js/50.68ef5ecc.js"><link rel="prefetch" href="/assets/js/52.a1c505f9.js"><link rel="prefetch" href="/assets/js/53.69c2ec7f.js"><link rel="prefetch" href="/assets/js/54.e8185ee7.js"><link rel="prefetch" href="/assets/js/55.462eb094.js"><link rel="prefetch" href="/assets/js/56.219bfd23.js"><link rel="prefetch" href="/assets/js/6.d2537d81.js"><link rel="prefetch" href="/assets/js/7.e6aa3834.js"><link rel="prefetch" href="/assets/js/8.f3baf431.js"><link rel="prefetch" href="/assets/js/9.eb210b13.js">
    <link rel="stylesheet" href="/assets/css/0.styles.70976983.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Serverless — from the beginning, using Azure functions ( Azure portal ), part II</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/serverless-two.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/serverless-two.html#recap-and-next-steps" class="sidebar-link">Recap and next steps</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/serverless-two.html#getting-to-know-your-portal-ide" class="sidebar-link">Getting to know your portal IDE</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/serverless-two.html#refactoring" class="sidebar-link">Refactoring</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#expand-menu" class="sidebar-link">Expand menu</a></li><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#add-a-new-file-and-move-the-list-in-there" class="sidebar-link">Add a new file and move the list in there</a></li><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#import-our-jokes-js-file-as-a-node-module" class="sidebar-link">Import our jokes.js file as a Node module</a></li><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#move-remaining-static-content-to-separate-files" class="sidebar-link">Move remaining static content to separate files</a></li></ul></li><li><a href="/pages/serverless-two.html#a-new-project-using-a-rest-endpoint" class="sidebar-link">A new project using a REST endpoint</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#adding-a-library" class="sidebar-link">Adding a library</a></li><li class="sidebar-sub-header"><a href="/pages/serverless-two.html#working-with-logs" class="sidebar-link">Working with logs</a></li></ul></li><li><a href="/pages/serverless-two.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://cdn-images-1.medium.com/max/1000/1%2AJekyFSPow0EApgI0zgtvPw.jpeg" alt=""></p> <p>This is the second part of this series:</p> <ul><li><a href="https://dev.to/azure/serverless-from-the-beginning-using-azure-functions-azure-portal-part-i-28o1" target="_blank" rel="noopener noreferrer">Serverless — from the beginning, using Azure functions ( Azure portal )<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, part I, this part focuses on presenting the concept Serverless and also shows how you can build your first Azure function using the portal</li> <li>Serverless — from the beginning, using Azure functions ( Azure portal ), part II, <strong>we are here</strong></li> <li>Serverless — from the beginning, using Azure functions ( VS Code ), part III, in progress</li> <li>Serverless — from the beginning, using Azure functions ( Azure CLI ), part IV, in progress</li></ul> <p>In this article we will cover the following:</p> <ul><li><strong>Getting to know the IDE generally</strong> , The portal may not be the ideal IDE to write your Azure Functions in but it does contain a lot of great functionality to author your function</li> <li><strong>Splitting up in modules</strong> , As this is Node.js we can definitely use the CommonJS module system</li> <li><strong>Using libraries,</strong> You can definitely use NPM to install libraries</li> <li><strong>Use HTTP and async/await</strong> , you can definitely call other endpoints from our function and present the result</li> <li><strong>Logging</strong> , there are different ways we can work with logging, let’s see how we can log statements and log at them afterward</li></ul> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <p>There is always a ton more to learn about functions such as how to work with different types of trigger, how to create APIS, how to document those APIs and so on. We have merely scratched the surface</p> <ul><li><a href="https://azure.microsoft.com/en-gb/services/functions/?wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-gb/services/functions/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, General landing page for Azure functions</li> <li><a href="https://docs.microsoft.com/en-gb/azure/?wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-gb/azure/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> , Main docs page for Azure</li> <li><a href="https://docs.microsoft.com/en-gb/azure/azure-functions/?wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-gb/azure/azure-functions/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, landing page for Azure Functions documentation</li> <li><a href="https://docs.microsoft.com/en-gb/azure/azure-functions/functions-create-first-azure-function?wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-gb/azure/azure-functions/functions-create-first-azure-function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, Tutorial to how you create your first function</li> <li><a href="https://docs.microsoft.com/en-gb/azure/azure-functions/functions-create-serverless-api?wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">https://docs.microsoft.com/en-gb/azure/azure-functions/functions-create-serverless-api<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, How to create an Serverless API</li> <li><a href="https://docs.microsoft.com/en-us/learn/browse/?roles=developer&amp;resource_type=module&amp;term=Azure%20functions&amp;wt.mc_id=medium-blog-chnoring" target="_blank" rel="noopener noreferrer">Link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to all the LEARN modules on Azure functions,</li></ul> <h2 id="recap-and-next-steps"><a href="#recap-and-next-steps" aria-hidden="true" class="header-anchor">#</a> Recap and next steps</h2> <p>Ok, so hopefully you’ve read the first part in this series so you know your way around creating a <code>Function app</code> and your first <code>Azure function</code> and how to run the same in your Portal IDE and in the browser. If not, have a look <a href="https://dev.to/azure/serverless-from-the-beginning-using-azure-functions-azure-portal-part-i-28o1" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>At this point, we’ve merely scratched the surface of what the portal IDE can do. So let’s try to refactor our code from our first post in this series and discover some of the Portal IDEs while we do so.</p> <h2 id="getting-to-know-your-portal-ide"><a href="#getting-to-know-your-portal-ide" aria-hidden="true" class="header-anchor">#</a> Getting to know your portal IDE</h2> <p>Once your function has been generated it’s time to get to know your portal IDE. It looks like this:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*gbl5ptIHPPmXm6ike56NSg.png" alt=""></p> <p>It consists of the following:</p> <p><strong>Left menu</strong> , this is placed on the left side right under your function</p> <ul><li><strong>Integrate</strong> , this lets you control things like allowed HTTP method, Authorization level, and probably most important Inputs and Outputs, here you can configure what type of events can trigger our function but also what kind of events we can trigger in turn by returning something from the function</li> <li><strong>Manage</strong>, this is where we manage <em>function keys</em> and <em>host keys</em>. Depending on authorization level you will need one or more of these keys in your requests to be able to call a specific function in your Function app</li> <li><strong>Monitor</strong>, this shows all the executions of a function, if it went well and how long it took</li></ul> <p><strong>Toolbar</strong>, this is placed at the top and lets you do things like Save, Run and get a URL for your function</p> <p><strong>The right menu</strong>, this is a tabulated menu on your left that allows you to do two things:</p> <ul><li><strong>add/remove files</strong> to your project, yes you can have a project consisting of many files. It’s Node.js and CommonJS so we can expect things like require and module.exports to work</li> <li><strong>Test</strong> , we get help constructing requests towards our service, both choice of HTTP method and payload</li></ul> <p><strong>The bottom menu</strong>, this contains two different things:</p> <ul><li><strong>Logs</strong>, this will show you log output from your function</li> <li><strong>Console</strong>, this is a terminal window that allows you to browse the directory your Function app project is in and allows you to do most things a terminal would allow</li></ul> <h2 id="refactoring"><a href="#refactoring" aria-hidden="true" class="header-anchor">#</a> Refactoring</h2> <p>Ok, so we understand better what parts our Portal IDE consists of, let’s now have a look at our code we created in the <a href="https://dev.to/azure/serverless-from-the-beginning-using-azure-functions-azure-portal-part-i-28o1" target="_blank" rel="noopener noreferrer">first part<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> of this series. The first thing we have is this static list of questionable jokes:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> req</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token keyword">let</span> jokes <span class="token operator">=</span> <span class="token punctuation">[</span>

  <span class="token string">&quot;Did you hear about the restaurant on the moon? Great food, no atmosphere.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;What do you call a fake noodle? An Impasta.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;How many apples grow on a tree? All of them.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;Want to hear a joke about paper? Nevermind it's tearable.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;I just watched a program about beavers. It was the best dam program I've ever seen.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;Why did the coffee file a police report? It got mugged.&quot;</span><span class="token punctuation">,</span>

  <span class="token string">&quot;How does a penguin build it's house? Igloos it together.&quot;</span><span class="token punctuation">,</span>

<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// the rest of the code omitted for brevity</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>What we normally do in Node.js project is to move those to a separate file that we call jokes.js. So, therefore, let’s use our right menu and create a file. We need to take the following steps:</p> <ol><li>Expand the right menu</li> <li>Add a new file by clicking <code>+ Add</code></li> <li>enter the filename jokes.js</li> <li>move our list to jokes.js</li> <li>import jokes.js as a module from our main file <code>index.js</code></li></ol> <h3 id="expand-menu"><a href="#expand-menu" aria-hidden="true" class="header-anchor">#</a> Expand menu</h3> <p>This is pretty straight forward, just click on the menu itself, like so:</p> <p><img src="https://cdn-images-1.medium.com/max/124/1*xRy4G_2danLGJG8HXcMgHg.png" alt=""></p> <p>and it ends up looking like so:</p> <p><img src="https://cdn-images-1.medium.com/max/960/1*EAWgnLpeAiKaRHwbOxlJmA.png" alt=""></p> <h3 id="add-a-new-file-and-move-the-list-in-there"><a href="#add-a-new-file-and-move-the-list-in-there" aria-hidden="true" class="header-anchor">#</a> Add a new file and move the list in there</h3> <p>Ok, so we click <code>+ Add</code> and end up with this:</p> <p><img src="https://cdn-images-1.medium.com/max/406/1*Kxf0XHtlHKceOO57yOkUQA.png" alt=""></p> <p>We fill in our filename <code>jokes.js</code> and move over the content from <code>index.js</code> and we should now have:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*QcpH-pA1OIWkrq0llzOvTw.png" alt=""></p> <blockquote><p>Don’t forget to addmodule.exports = jokes at the end of <code>jokes.js</code> to ensure we can import our jokes list properly.</p></blockquote> <h3 id="import-our-jokes-js-file-as-a-node-module"><a href="#import-our-jokes-js-file-as-a-node-module" aria-hidden="true" class="header-anchor">#</a> Import our jokes.js file as a Node module</h3> <p>At the top of our <code>index.js</code> file we can now write:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>

<span class="token keyword">const</span> jokes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./jokes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>and that’s enough to make it work.</p> <h3 id="move-remaining-static-content-to-separate-files"><a href="#move-remaining-static-content-to-separate-files" aria-hidden="true" class="header-anchor">#</a> Move remaining static content to separate files</h3> <p>We also had a list of URLs for pictures of laughing Dogs that we found on the Internet. Let’s create a file <code>dogUrls.js</code> and place all the URLs in there. It should look something like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// dogUrls.js</span>

<span class="token keyword">let</span> dogUrls <span class="token operator">=</span> <span class="token punctuation">[</span>

<span class="token comment">// your URLs</span>

<span class="token punctuation">]</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> dogUrls<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Just like with jokes.js we can now import <code>dogUrls.js</code> as a Node module as well. So the top of our <code>index.js</code> should now look like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>

<span class="token keyword">const</span> jokes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./jokes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> dogUrls <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dogUrls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="a-new-project-using-a-rest-endpoint"><a href="#a-new-project-using-a-rest-endpoint" aria-hidden="true" class="header-anchor">#</a> A new project using a REST endpoint</h2> <p>At this point we will move away from our DadJokes service, it’s probably as good as it’s ever going to get, which isn’t saying much 😉 It’s time to take on another favorite of the Internet, cat pictures !!.</p> <p>I think I heard your squeal of despair all the way from here. Don’t worry this is just for educational purposes so we learn how to work with HTTP calls and downloading dependencies 😃.</p> <p>Because we are building a new function we need to first create a new function and give it a suitable name so first click on adding a new function:</p> <p><img src="https://cdn-images-1.medium.com/max/478/1*ewlMtEciveoyutMezOXymg.png" alt=""></p> <p>and then when you are presented with Triggers choose HTTP trigger:</p> <p><img src="https://cdn-images-1.medium.com/max/986/1*RPkwTErISVx0AS1zpiiZhQ.png" alt=""></p> <p>Thereafter set authorization level to Anonymous and give it the name CatsAsAService , like so:</p> <p><img src="https://cdn-images-1.medium.com/max/912/1*Lii0rdxH-J5kTkuqRxjIZg.png" alt=""></p> <h3 id="adding-a-library"><a href="#adding-a-library" aria-hidden="true" class="header-anchor">#</a> Adding a library</h3> <p>At this point, we have a new function but we need to add the capability to do HTTP calls. To make that happen we need to use a library that can do that for us. We could use the built-in http library but we opt to install the <code>node-fetch</code> library instead with is just like the fetch that you use in the browser. We need to do two things at this point:</p> <ol><li>Initialize a proper Node.js project, we do that by running the command <code>npm init -y</code> in the terminal</li> <li>install the node-fetch library, we do that by running the command <code>npm install node-fetch</code></li></ol> <p>To accomplish the above we need to head to the bottom menu and click <code>Console</code>, like so:</p> <p><img src="https://cdn-images-1.medium.com/max/1012/1*oC3V5-8srl1lxPJIbwC84w.png" alt=""></p> <p>Ok, let’s first hit the command <code>dir</code>, to list our files, we are inside of Windows system 😃</p> <p><img src="https://cdn-images-1.medium.com/max/990/1*TEpOPKcnOkU6SdVpT3flCg.png" alt=""></p> <p>Ok, above we can see we have the files function.json and <code>index.js</code>. Lets now run our commands <code>npm init -y</code> followed by <code>npm install node-fetch</code>. Those commands create a <code>package.json</code> file and a <code>package-lock.json</code> as a result of us initializing our Node project but also downloading <code>node-fetch</code>.</p> <p><img src="https://cdn-images-1.medium.com/max/968/1*HcESWOk3U2Z1H9tC4UyGpw.png" alt=""></p> <p>We can also see that <code>node-fetch</code> have been installed by inspecting <code>package.json</code>:</p> <p><img src="https://cdn-images-1.medium.com/max/404/1*SK2JsKzIse7GjxC5yg2_Lg.png" alt=""></p> <p>Great, so node-fetch is there and we can thereby use it to make HTTP calls.</p> <h3 id="working-with-logs"><a href="#working-with-logs" aria-hidden="true" class="header-anchor">#</a> Working with logs</h3> <p>With Azure functions, we have an excellent way of logging namely by using our first argument in our Azure function called <code>context</code>. <code>context</code> has a <code>log()</code> method on it that when used can log to our <code>Logs</code> window in our bottom menu.</p> <p>Let’s do the following:</p> <ol><li>Import node-fetch and make a fetch call towards an API</li> <li>log the resulting JSON using context.log()</li></ol> <p>Ok let’s first declare a function that will do the HTTP call, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fetch <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-fetch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getHttp</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 context<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'calling HTTP service'</span><span class="token punctuation">)</span>

 <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'https://swapi.co/api/people/'</span><span class="token punctuation">)</span>

<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Above we declare the method <code>getHttp()</code> and then we use our <code>fetch()</code> method and give it a URL. In the <code>then()</code> callback we ensure that we transform the result into JSON, so far so good.</p> <p>For our next step, we go into our Azure function and invoke <code>getHttp()</code>,. Because it’s using the <em>async</em> keyword we can use await to wait for the result to come back and then log it out, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// excerpt from index.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> req</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token operator">**</span><span class="token keyword">await</span><span class="token operator">**</span> <span class="token function">getHttp</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>

 context<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// rest of the function down here</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Running the function at this point gives us the following output in Logs :</p> <p><img src="https://cdn-images-1.medium.com/max/1004/1*1Or2qENQE8GNUEc3G1--jQ.png" alt=""></p> <p>As you can see above we get a nice response, however, it returns 87 records so I cut it after the first item in the list it returns. The URL we were using was for the open Star Wars API and it contains everything we could possibly want to know about the franchise. Let's stay on mission however and go back to Cats..</p> <p><img src="https://cdn-images-1.medium.com/max/355/1*pnfHD-Z1MSfizhmITuE1Lg.gif" alt=""></p> <p>Sorry Luke 😃</p> <p>Not at all surprising, trying to Google a Cat API you get a HUGE amount of responses, cause we all know that Internet was designed to support Cat memes, right 😉 I’ve decided on a specific API, cause it didn’t require me to sign up for an API key. I went with <code>thecatapi</code> and the following URL in particular:</p> <blockquote><p><a href="https://api.thecatapi.com/v1/images/search" target="_blank" rel="noopener noreferrer">https://api.thecatapi.com/v1/images/search<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>You can definitely sign up and get an API key and get a richer experience, but we will only use the free version and we end up getting a response looking something like this:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
 <span class="token property">&quot;breeds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>

 <span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;26k&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;[https://cdn2.thecatapi.com/images/26k.jpg](https://cdn2.thecatapi.com/images/26k.jpg)&quot;</span><span class="token punctuation">,</span>
 <span class="token property">&quot;width&quot;</span><span class="token operator">:</span> <span class="token number">3817</span><span class="token punctuation">,</span>
 <span class="token property">&quot;height&quot;</span><span class="token operator">:</span> <span class="token number">2553</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>We can definitely work with the above and try presenting that in an HTML image, as we did with our Dad Jokes, so let’s do that next:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>cat<span class="token punctuation">]</span> <span class="token operator">=</span> json<span class="token punctuation">;</span>

context<span class="token punctuation">.</span>res <span class="token operator">=</span> <span class="token punctuation">{</span>
 status<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
 headers<span class="token punctuation">:</span> <span class="token punctuation">{</span>
 <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;text/html&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 body<span class="token punctuation">:</span> <span class="token string">'&lt;h3&gt;Cat&lt;/h3&gt;'</span> <span class="token operator">+</span> <span class="token string">'&lt;br&gt;&lt;img src=&quot;'</span><span class="token operator">+</span> cat<span class="token punctuation">.</span>url <span class="token operator">+</span><span class="token string">'&quot;/&gt;'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The above digs out the URL from the response and we populate a response object, give it the response type HTML and we let the body consist of an IMG tag with its src set to our JSON URL. The result looks like:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*G5P-Rhzj74nVJuy93gMUbQ.png" alt=""></p> <p>Isn’t that something 😃</p> <p>That was the end of this part. In our next part, we will show you how to work with functions in VS Code, cause let’s face it, even though the Portal seems to have some nice functions it’s not really the IDE of our dreams. See you in VS Code.</p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We aimed to describe the IDE in the portal a bit better and we managed to describe and explain what parts it consisted of and what their purpose was. Moving on we took our old DadJokesAsAService function and refactored it and we thereby introduced how you could be using Node modules. Thereafter we created a new Azure function and learned how we could install a library like <code>node-fetch</code>. We then used <code>node-fetch</code> to call a Cat API responding with JSON and we ended up responding with yet another page with cats on it. Thereby we contributed to Internets original purpose 😉</p> <p>This was the last part of our Portal series but in our next part, we will look at how we can author Azure functions from VS Code so I hope you are excited about that.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b3ccf621.js" defer></script><script src="/assets/js/5.218403d0.js" defer></script><script src="/assets/js/4.5f5dd8b1.js" defer></script><script src="/assets/js/51.38d8e88e.js" defer></script>
  </body>
</html>
