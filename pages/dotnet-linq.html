<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Learn how to use Linq in C# and .NET - SQL like syntax on all your data sources, DB, XML, and even objects</title>
    <meta name="description" content="If you are not using Linq when coding .NET - you are missing out.">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.5ae3c088.css" as="style"><link rel="preload" href="/assets/js/app.e3a22685.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/153.ecd63d9d.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.dd884694.js"><link rel="prefetch" href="/assets/js/100.f7776fae.js"><link rel="prefetch" href="/assets/js/101.83c4ff25.js"><link rel="prefetch" href="/assets/js/102.d3a51c53.js"><link rel="prefetch" href="/assets/js/103.e4fd7175.js"><link rel="prefetch" href="/assets/js/104.3f860f10.js"><link rel="prefetch" href="/assets/js/105.5e05c250.js"><link rel="prefetch" href="/assets/js/106.d1698fcc.js"><link rel="prefetch" href="/assets/js/107.39206cda.js"><link rel="prefetch" href="/assets/js/108.b717e412.js"><link rel="prefetch" href="/assets/js/109.a0275c41.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.acd428a7.js"><link rel="prefetch" href="/assets/js/111.85c1f355.js"><link rel="prefetch" href="/assets/js/112.877451fc.js"><link rel="prefetch" href="/assets/js/113.0c756607.js"><link rel="prefetch" href="/assets/js/114.2dcc568f.js"><link rel="prefetch" href="/assets/js/115.2ee55351.js"><link rel="prefetch" href="/assets/js/116.4c7211b0.js"><link rel="prefetch" href="/assets/js/117.3fa386ab.js"><link rel="prefetch" href="/assets/js/118.8bd003cb.js"><link rel="prefetch" href="/assets/js/119.eee9a7e2.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.d8458857.js"><link rel="prefetch" href="/assets/js/121.d06bb8bc.js"><link rel="prefetch" href="/assets/js/122.ad0893bf.js"><link rel="prefetch" href="/assets/js/123.37bf1483.js"><link rel="prefetch" href="/assets/js/124.92ff020a.js"><link rel="prefetch" href="/assets/js/125.88e1d9ef.js"><link rel="prefetch" href="/assets/js/126.dc6e1538.js"><link rel="prefetch" href="/assets/js/127.1a4d6785.js"><link rel="prefetch" href="/assets/js/128.4387dd5e.js"><link rel="prefetch" href="/assets/js/129.57ea763a.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.58e7dbf8.js"><link rel="prefetch" href="/assets/js/131.42d28338.js"><link rel="prefetch" href="/assets/js/132.d36de42a.js"><link rel="prefetch" href="/assets/js/133.f30adb75.js"><link rel="prefetch" href="/assets/js/134.31f31974.js"><link rel="prefetch" href="/assets/js/135.28ac6845.js"><link rel="prefetch" href="/assets/js/136.fa8c6434.js"><link rel="prefetch" href="/assets/js/137.e5700d8f.js"><link rel="prefetch" href="/assets/js/138.7a324443.js"><link rel="prefetch" href="/assets/js/139.2f7c0a4b.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.b91b86f6.js"><link rel="prefetch" href="/assets/js/141.96580e9a.js"><link rel="prefetch" href="/assets/js/142.0a5ba9b1.js"><link rel="prefetch" href="/assets/js/143.c459fa93.js"><link rel="prefetch" href="/assets/js/144.6c70d423.js"><link rel="prefetch" href="/assets/js/145.bb0bf891.js"><link rel="prefetch" href="/assets/js/146.6f256034.js"><link rel="prefetch" href="/assets/js/147.49ca51ce.js"><link rel="prefetch" href="/assets/js/148.2ab13d25.js"><link rel="prefetch" href="/assets/js/149.a33263c4.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.b4ba556a.js"><link rel="prefetch" href="/assets/js/151.5a70a140.js"><link rel="prefetch" href="/assets/js/152.1069f6c2.js"><link rel="prefetch" href="/assets/js/154.65c33956.js"><link rel="prefetch" href="/assets/js/155.6c1cd07d.js"><link rel="prefetch" href="/assets/js/156.cb9f8044.js"><link rel="prefetch" href="/assets/js/157.f967f5fd.js"><link rel="prefetch" href="/assets/js/158.1ea63677.js"><link rel="prefetch" href="/assets/js/159.6e55156d.js"><link rel="prefetch" href="/assets/js/16.119e91d4.js"><link rel="prefetch" href="/assets/js/160.88cccab3.js"><link rel="prefetch" href="/assets/js/161.71318bd8.js"><link rel="prefetch" href="/assets/js/162.c8cea25d.js"><link rel="prefetch" href="/assets/js/163.a7833ee3.js"><link rel="prefetch" href="/assets/js/164.ea1e3d74.js"><link rel="prefetch" href="/assets/js/165.e9a99c14.js"><link rel="prefetch" href="/assets/js/166.f2e26ff9.js"><link rel="prefetch" href="/assets/js/167.6a4d1f51.js"><link rel="prefetch" href="/assets/js/168.c58bc120.js"><link rel="prefetch" href="/assets/js/169.eae6e4e5.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/170.cf5fa6a3.js"><link rel="prefetch" href="/assets/js/171.f0dd0748.js"><link rel="prefetch" href="/assets/js/172.5909c6a2.js"><link rel="prefetch" href="/assets/js/173.0682325b.js"><link rel="prefetch" href="/assets/js/174.8b371e6b.js"><link rel="prefetch" href="/assets/js/175.bdf4d597.js"><link rel="prefetch" href="/assets/js/176.5925b373.js"><link rel="prefetch" href="/assets/js/177.f678005e.js"><link rel="prefetch" href="/assets/js/178.91a77396.js"><link rel="prefetch" href="/assets/js/179.245c4e4c.js"><link rel="prefetch" href="/assets/js/18.6ebceaf1.js"><link rel="prefetch" href="/assets/js/180.aedfb4ca.js"><link rel="prefetch" href="/assets/js/181.d284539a.js"><link rel="prefetch" href="/assets/js/182.4fd4793b.js"><link rel="prefetch" href="/assets/js/183.06ee29e0.js"><link rel="prefetch" href="/assets/js/184.5493ba8e.js"><link rel="prefetch" href="/assets/js/185.6ffaf117.js"><link rel="prefetch" href="/assets/js/186.40ce91dd.js"><link rel="prefetch" href="/assets/js/187.3f8498e2.js"><link rel="prefetch" href="/assets/js/188.62070c23.js"><link rel="prefetch" href="/assets/js/189.10a10400.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/190.f28d6eb5.js"><link rel="prefetch" href="/assets/js/191.846582fc.js"><link rel="prefetch" href="/assets/js/192.9904f081.js"><link rel="prefetch" href="/assets/js/193.e9a4d1b1.js"><link rel="prefetch" href="/assets/js/194.f93671b1.js"><link rel="prefetch" href="/assets/js/195.7c4863b9.js"><link rel="prefetch" href="/assets/js/196.3175eb48.js"><link rel="prefetch" href="/assets/js/197.29d26ccf.js"><link rel="prefetch" href="/assets/js/198.0402c523.js"><link rel="prefetch" href="/assets/js/199.44b5e9aa.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/200.d226b6ae.js"><link rel="prefetch" href="/assets/js/201.043fccbf.js"><link rel="prefetch" href="/assets/js/202.29dec5af.js"><link rel="prefetch" href="/assets/js/203.c72e7565.js"><link rel="prefetch" href="/assets/js/21.710dadb0.js"><link rel="prefetch" href="/assets/js/22.f4b7a74b.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.95c29410.js"><link rel="prefetch" href="/assets/js/25.a9fce161.js"><link rel="prefetch" href="/assets/js/26.8b31cf1a.js"><link rel="prefetch" href="/assets/js/27.4cf46a26.js"><link rel="prefetch" href="/assets/js/28.21397a71.js"><link rel="prefetch" href="/assets/js/29.ef58c202.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.4fc73e4a.js"><link rel="prefetch" href="/assets/js/31.b2211550.js"><link rel="prefetch" href="/assets/js/32.f2e286bb.js"><link rel="prefetch" href="/assets/js/33.aec83ce9.js"><link rel="prefetch" href="/assets/js/34.9e368969.js"><link rel="prefetch" href="/assets/js/35.ccde8210.js"><link rel="prefetch" href="/assets/js/36.561677ad.js"><link rel="prefetch" href="/assets/js/37.59283e16.js"><link rel="prefetch" href="/assets/js/38.8d764594.js"><link rel="prefetch" href="/assets/js/39.94b70e03.js"><link rel="prefetch" href="/assets/js/40.ee22aa00.js"><link rel="prefetch" href="/assets/js/41.accb996e.js"><link rel="prefetch" href="/assets/js/42.dcae85a4.js"><link rel="prefetch" href="/assets/js/43.ec66ae23.js"><link rel="prefetch" href="/assets/js/44.6fc9906e.js"><link rel="prefetch" href="/assets/js/45.be8d4fd7.js"><link rel="prefetch" href="/assets/js/46.9edeab5a.js"><link rel="prefetch" href="/assets/js/47.fb12d4b7.js"><link rel="prefetch" href="/assets/js/48.52640be3.js"><link rel="prefetch" href="/assets/js/49.33d9d0c4.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.13c266ab.js"><link rel="prefetch" href="/assets/js/51.51580cbc.js"><link rel="prefetch" href="/assets/js/52.5c6157b8.js"><link rel="prefetch" href="/assets/js/53.df1e6c41.js"><link rel="prefetch" href="/assets/js/54.eb903e59.js"><link rel="prefetch" href="/assets/js/55.eb47d641.js"><link rel="prefetch" href="/assets/js/56.8246b35d.js"><link rel="prefetch" href="/assets/js/57.e6f2d2ce.js"><link rel="prefetch" href="/assets/js/58.f7fff5bb.js"><link rel="prefetch" href="/assets/js/59.1e33c33c.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.67ca9192.js"><link rel="prefetch" href="/assets/js/61.028819ef.js"><link rel="prefetch" href="/assets/js/62.9b98c3b5.js"><link rel="prefetch" href="/assets/js/63.efc8f547.js"><link rel="prefetch" href="/assets/js/64.ecda83e6.js"><link rel="prefetch" href="/assets/js/65.a5e5b25b.js"><link rel="prefetch" href="/assets/js/66.2e6b6c8e.js"><link rel="prefetch" href="/assets/js/67.09614dba.js"><link rel="prefetch" href="/assets/js/68.8d40a19e.js"><link rel="prefetch" href="/assets/js/69.76c62200.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.8f3a0f45.js"><link rel="prefetch" href="/assets/js/71.4d8bdcb1.js"><link rel="prefetch" href="/assets/js/72.e816ed3a.js"><link rel="prefetch" href="/assets/js/73.d791feee.js"><link rel="prefetch" href="/assets/js/74.073c9d53.js"><link rel="prefetch" href="/assets/js/75.89cad8df.js"><link rel="prefetch" href="/assets/js/76.232ad0b0.js"><link rel="prefetch" href="/assets/js/77.49a534d4.js"><link rel="prefetch" href="/assets/js/78.134a5d5e.js"><link rel="prefetch" href="/assets/js/79.6ca3cd68.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.b733d6fd.js"><link rel="prefetch" href="/assets/js/81.4b4b8b2f.js"><link rel="prefetch" href="/assets/js/82.b53dae89.js"><link rel="prefetch" href="/assets/js/83.38d82ae3.js"><link rel="prefetch" href="/assets/js/84.7a0b2839.js"><link rel="prefetch" href="/assets/js/85.569d3ef1.js"><link rel="prefetch" href="/assets/js/86.f7c2d0fe.js"><link rel="prefetch" href="/assets/js/87.badf9ea1.js"><link rel="prefetch" href="/assets/js/88.4904c176.js"><link rel="prefetch" href="/assets/js/89.14501534.js"><link rel="prefetch" href="/assets/js/90.9f31e266.js"><link rel="prefetch" href="/assets/js/91.cd9f26cc.js"><link rel="prefetch" href="/assets/js/92.f68b9b5c.js"><link rel="prefetch" href="/assets/js/93.c0237329.js"><link rel="prefetch" href="/assets/js/94.87777679.js"><link rel="prefetch" href="/assets/js/95.7deabe56.js"><link rel="prefetch" href="/assets/js/96.8ac1aaf0.js"><link rel="prefetch" href="/assets/js/97.0ad4d44e.js"><link rel="prefetch" href="/assets/js/98.6406ef0c.js"><link rel="prefetch" href="/assets/js/99.9fedc5bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ae3c088.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Learn how to use Linq in C# and .NET - SQL like syntax on all your data sources, DB, XML, and even objects</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dotnet-linq.html#references" class="sidebar-link">References</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-linq.html#learning-linq" class="sidebar-link">Learning Linq</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#get-the-data-source" class="sidebar-link">Get the data source</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#create-the-query" class="sidebar-link">Create the query</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#execute-the-query" class="sidebar-link">Execute the query</a></li></ul></li><li><a href="/pages/dotnet-linq.html#there-are-two-versions-to-create-queries" class="sidebar-link">There are two versions to create queries</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/dotnet-linq.html#simple-operators" class="sidebar-link">Simple operators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#filter-and-select" class="sidebar-link">Filter and Select</a></li></ul></li><li><a href="/pages/dotnet-linq.html#complex-operators" class="sidebar-link">Complex operators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#ordering" class="sidebar-link">Ordering</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#grouping" class="sidebar-link">Grouping</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#joining" class="sidebar-link">Joining</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-linq.html#hierarchical-data" class="sidebar-link">Hierarchical data</a></li></ul></li><li><a href="/pages/dotnet-linq.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="learn-how-to-use-linq-in-c-and-net"><a href="#learn-how-to-use-linq-in-c-and-net" aria-hidden="true" class="header-anchor">#</a> Learn how to use Linq in C# and .NET</h1> <blockquote><p>SQL like syntax on all your data sources, DB, XML, and even objects</p></blockquote> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/8r6y1gbu9lalgenvdscx.jpg" alt=""></p> <blockquote><p>What is Linq? Linq stands for <strong>L</strong>anguage <strong>In</strong>tegrated <strong>Q</strong>uery. It is the name for a set of technologies based on the integration of query capabilities directly into the C# language. English? it means you have SQL like syntax on Lists, XML files, Databases, well any kind of queryable data. It is probably the most important thing you want to learn in C#.</p></blockquote> <p>TLDR; This article describes the usage of the library Linq that is part of the .NET framework. Linq enables you to query all sorts of data sources with a <em>SQL like</em> syntax. IMO it's the most powerful feature to ever hit the .NET framework.</p> <blockquote><p>If you are not using Linq when coding .NET - you are missing out.</p></blockquote> <h2 id="references"><a href="#references" aria-hidden="true" class="header-anchor">#</a> References</h2> <ul><li><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/join-clause?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">More on joins in Linq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
There is more than one way to do joins, this should cover most scenarios.</p></li> <li><p><a href="https://www.csharp-examples.net/linq-sum/" target="_blank" rel="noopener noreferrer">Linq by example site<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Great site to quickly refer to the syntax for different types of operators.</p></li> <li><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/standard-query-operators-overview?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Operators - overview page<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Good docs page that intros you to operators, lots of good sub pages for further navigation.</p></li> <li><p><a href="https://docs.microsoft.com/en-us/dotnet/standard/using-linq?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Docs starter page for Linq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://github.com/aaubry/YamlDotNet" target="_blank" rel="noopener noreferrer">YAML for Linq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Yes, you can even do YAML with Linq.</p></li> <li><p><a href="https://www.linqpad.net/" target="_blank" rel="noopener noreferrer">Linq pad<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
An invaluable tool for trying out Linq expressions</p></li> <li><p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/linq-to-xml-overview?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Linq for XML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Good docs page for doing Linq with XML.</p></li></ul> <p>## The Problem</p> <blockquote><p>Ok so Linq is supposedly changing everything. How exactly?</p></blockquote> <p>Today you are most likely doing things such as <em>grouping</em>, <em>sorting</em>, <em>transforming</em> your data from one Poco, one <strong>P</strong>lain <strong>O</strong>ld <strong>C</strong># <strong>O</strong>bject, to another.</p> <blockquote><p>Yea, I know, not the most fun work, but it needs to be done. What about it?</p></blockquote> <p>You said it was boring. I can tell you why it's boring, it's not declarative and you use utility methods like <code>Array.sort</code> to get the job done. This leads to you having to type way more than you need to.</p> <blockquote><p>That's what programming is I thought, a patchwork of different approaches and libraries that spits out the correct data at the other end.</p></blockquote> <p>It doesn't have to be you know. You can have a high-level approach, that's declarative, that works for all data source types, or well most of them.</p> <blockquote><p>There's that word again <em>declarative</em> and tell me about the data sources, I'm intrigued?</p></blockquote> <p>Declarative is more about describing what you want, without saying exactly how to achieve it. Like SQL for example:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">column</span><span class="token punctuation">,</span> column1
<span class="token keyword">FROM</span> <span class="token keyword">table</span>
<span class="token keyword">WHERE</span> condition
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">column</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>Ok so you are saying I should be using something high-level, <em>SQL like</em> to <em>transform</em>, <em>group</em>, <em>sort</em>, etc. Instead of my horrible mix of utility functions and for-loops, I'm using today?</p></blockquote> <p>Yes, exactly that. 😃</p> <blockquote><p>What about the other data sources you talked about?</p></blockquote> <p>Linq is already implemented to work with an ORM like Entity Framework, XML and just plain code. So you just define a Linq query in pretty much the same way regardless of the data source. Isn't that neat?</p> <blockquote><p>Yea for sure. I will need to see this to believe it though.</p></blockquote> <p>Sure thing.</p> <blockquote><p>One more question, does it work for YAML?</p></blockquote> <p>Yes it does, albeit with a 3rd party library like</p> <blockquote><p><code>https://github.com/aaubry/YamlDotNet</code></p></blockquote> <p>To sum up, just asking for the data we need is possibly error prone and we need to learn a new approach to do it for each data type. Linq solves all that and yes you have tooling support, intellisense.</p> <blockquote><p>Sweet, I was waiting for you to say intellisense, teach me Obi Wan</p></blockquote> <p>Patience my young Padawan. 😃</p> <p>## What</p> <blockquote><p>So what does Linq give us?</p></blockquote> <ul><li><p><strong>First class construct</strong>,
With LINQ, a query is a first-class language construct, just like classes, methods, events.</p></li> <li><p><strong>Language keywords and familiar operators</strong>,
You write queries against strongly typed collections of objects by using language keywords and familiar operators.</p></li> <li><p><strong>Consistent query experience</strong>, The LINQ family of technologies provides a consistent query experience for objects (LINQ to Objects), relational databases (LINQ to SQL), and XML (LINQ to XML).</p></li></ul> <p>Same query language regardless of the type of source, now THAT is powerful 😃</p> <blockquote><p>Yes sounds amazing.</p></blockquote> <p>It is.</p> <blockquote><p>What can I use it on?</p></blockquote> <p>Everything that supports <code>IEnumerable</code> or <code>IEnumerable&lt;T&gt;</code>.</p> <blockquote><p>That all sounds good but how does it look?</p></blockquote> <p>Well, the first time I saw Linq queries I thought, Sweet, I got SQL in my source code. I know SQL so that's half the battle 😃</p> <blockquote><p>Can you show me?</p></blockquote> <p>Sure. Here's an example:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>IEnumerable<span class="token operator">&lt;</span>Character<span class="token operator">&gt;</span> rows <span class="token operator">=</span>
  <span class="token keyword">from</span> row <span class="token keyword">in</span> characters
  <span class="token keyword">where</span> row<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Gandalf&quot;</span>
  <span class="token keyword">select</span> row<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>You're right, that's totally SQL. <code>SELECT</code>, <code>FROM</code>, <code>WHERE</code> 😃 It does look backward though, the table first I mean?</p></blockquote> <p>You are correct, and this is on purpose, it's so we are <em>context-aware</em> and have IntelliSense/tooling support early on.</p> <blockquote><p>Oh, so by defining the data source first, I know what columns/properties are on it?</p></blockquote> <p>Yes, exactly.</p> <h2 id="learning-linq"><a href="#learning-linq" aria-hidden="true" class="header-anchor">#</a> Learning Linq</h2> <p>You may think you know Linq just because of the above example but there are some concepts that we need to know to understand how it operates. We should think of Linq as having a three step process:</p> <ol><li><strong>Get the data source</strong>, this data source could be anything, a list, an XML file, a table in a Database.</li> <li><strong>Create the query</strong>, query represents the intent, something that you want to do. It's important to understand that you are NOT getting the data at this point but something of type <code>IQueryable</code>, the question, not the actual data.</li> <li><strong>Execute the query</strong>, this is when you actually get the data.</li></ol> <h3 id="get-the-data-source"><a href="#get-the-data-source" aria-hidden="true" class="header-anchor">#</a> Get the data source</h3> <p>As I stated before this could look in any number of ways, depending on the data source, like the below:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// objects</span>
<span class="token keyword">var</span> scores <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// XML</span>
<span class="token class-name">XElement</span> characters <span class="token operator">=</span> XElement<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">@&quot;c:\characters.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// DB using Entity Framework</span>
<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MovieEntities</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>    
    <span class="token keyword">var</span> movies <span class="token operator">=</span> db<span class="token punctuation">.</span>Movies
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="create-the-query"><a href="#create-the-query" aria-hidden="true" class="header-anchor">#</a> Create the query</h3> <p>Here we are essentially defining a query in the following way:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>IQueryable<span class="token operator">&lt;</span>type<span class="token operator">&gt;</span> <span class="token operator">=</span> 
<span class="token class-name">FROM</span> row <span class="token keyword">in</span> <span class="token operator">&lt;</span>data source<span class="token operator">&gt;</span>
WHERE <span class="token operator">&lt;</span>condition<span class="token operator">&gt;</span>
SELECT <span class="token operator">&lt;</span>columns <span class="token keyword">from</span> row<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Remember that the above only represent an intent of what we want, we are not actually executing the query.</p> <h3 id="execute-the-query"><a href="#execute-the-query" aria-hidden="true" class="header-anchor">#</a> Execute the query</h3> <p>So when do we actually execute the query? It's when we access it, for example start looping through it like this:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> scores <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> 
  <span class="token keyword">from</span> score <span class="token keyword">in</span> scores
  <span class="token keyword">where</span> score <span class="token operator">&gt;</span> <span class="token number">5</span>
  <span class="token keyword">select</span> score<span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword">var</span> r <span class="token keyword">in</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Score: {0}&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>Force execution</strong></p> <p>We can make the query happen right away by using certain operators. Example of these operators are <code>Count()</code>, <code>Max()</code>, <code>Average()</code> and <code>First()</code>. We can also be using <code>ToList()</code> or <code>ToArray()</code>, this forces the data to be fetched and turned into a <code>List</code> or <code>Array</code> type.</p> <p>Here's an example:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> scores <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">from</span> score <span class="token keyword">in</span> scores
<span class="token keyword">where</span> score <span class="token operator">&gt;</span> <span class="token number">5</span>
<span class="token keyword">select</span> score<span class="token punctuation">;</span>

<span class="token keyword">var</span> listResult <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Why does this matter? I've found it matters when you are dealing with for example databases. It's a quite common mistake that you think you've executed the query and you have really only created the query. Then when you start iterating through your collection you initiate a call to your database and that can be really bad for performance.</p> <p>Next, let's go through a set of demos so you hopefully feel like you understand enough Linq to use it in your service layer as well as towards databases and other data sources.</p> <h2 id="there-are-two-versions-to-create-queries"><a href="#there-are-two-versions-to-create-queries" aria-hidden="true" class="header-anchor">#</a> There are two versions to create queries</h2> <p>I started this article comparing Linq to SQL and that works if you got a background working with databases. But there is a different way to create queries namely by using method names. We call the SQL like style <code>Query Syntax style</code> and the more method driven style <code>Selector style</code>. Let's show an example of both styles so you can compare and see what works for you.</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Query Syntax style</span>
<span class="token keyword">from</span> c <span class="token keyword">in</span> characters
<span class="token keyword">where</span> c<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Gandalf&quot;</span>
<span class="token keyword">select</span> c<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>VS</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// Selector style</span>

characters
<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Gandalf&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>It's very similar, yet different. I clearly prefer the <em>SQL like</em> way of doing it but <em>you do you</em> 😃</p> <h2 id="simple-operators"><a href="#simple-operators" aria-hidden="true" class="header-anchor">#</a> Simple operators</h2> <p>In this demo we will learn the following:</p> <ol><li><strong>Filter and select</strong> columns from a data source</li> <li><strong>Transform</strong> the output the response</li></ol> <h3 id="filter-and-select"><a href="#filter-and-select" aria-hidden="true" class="header-anchor">#</a> Filter and Select</h3> <p>Using filtering is as simple as using the <code>Where</code> construct.</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">from</span> c <span class="token keyword">in</span> characters
<span class="token keyword">where</span> c<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;Gandalf&quot;</span>
<span class="token keyword">select</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We see above how we <em>filter</em> out so we only get the record matching a specific condition. For selection though it becomes different. If we are used to SQL, it's tempting to think we can just comma separate between columns, if we need more than one <code>c.Name, c.Age</code>. That doesn't work. How you would do that in Linq is to instead create an anonymous object like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">from</span> c <span class="token keyword">in</span> characters
<span class="token keyword">where</span> c<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;Gandalf&quot;</span>
<span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Age <span class="token operator">=</span> c<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>or use a typed object like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">from</span> c <span class="token keyword">in</span> characters
<span class="token keyword">where</span> c<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">&quot;Gandalf&quot;</span>
<span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Age <span class="token operator">=</span> c<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="complex-operators"><a href="#complex-operators" aria-hidden="true" class="header-anchor">#</a> Complex operators</h2> <p>If we have the mental model of operating on the data like it was data in Database there are a few things that should be possible to do like:</p> <ul><li><strong>Ordering</strong>, we should be able to sort our data in Ascending and Descending order</li> <li><strong>Grouping</strong>, we should be able to group our data based on different keys</li> <li><strong>Joining</strong>, it should be possible to join different data sources together based on a common key</li> <li><strong>Hierarchical queries</strong>, this is really a special case of joining the data together but depending on the data is given to you it's either different data sources that we need to stitch together or it is one object graph that we need to traverse.</li></ul> <p>Let's work through each of the scenarios above:</p> <h3 id="ordering"><a href="#ordering" aria-hidden="true" class="header-anchor">#</a> Ordering</h3> <p>So for ordering, we need to use the <code>orderby</code> construct, like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> characters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Bilbo&quot;</span><span class="token punctuation">,</span>
      Age<span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">,</span>
      Type<span class="token operator">=</span><span class="token string">&quot;Hobbit&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Ent number 1&quot;</span><span class="token punctuation">,</span>
      Age<span class="token operator">=</span> <span class="token number">1500</span><span class="token punctuation">,</span>
      Type<span class="token operator">=</span><span class="token string">&quot;Ent&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Gandalf&quot;</span><span class="token punctuation">,</span>
      Age<span class="token operator">=</span> <span class="token number">770</span><span class="token punctuation">,</span>
      Type<span class="token operator">=</span><span class="token string">&quot;Maya&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> orderedResult <span class="token operator">=</span> 
  <span class="token keyword">from</span> ch <span class="token keyword">in</span> characters
  <span class="token keyword">orderby</span> ch<span class="token punctuation">.</span><span class="token class-name">Age</span>
  <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> ch<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Age <span class="token operator">=</span> ch<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword">var</span> ch <span class="token keyword">in</span> orderedResult<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Ordered , Name: {0}, Age: {1}&quot;</span><span class="token punctuation">,</span> ch<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> ch<span class="token punctuation">.</span>Age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>Note, how the <code>orderby</code> statement happens before the <code>select</code> if you compare it to SQL.</p> <p>This produces the following result:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>Ordered <span class="token punctuation">,</span> Name<span class="token punctuation">:</span> Bilbo<span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">90</span>
Ordered <span class="token punctuation">,</span> Name<span class="token punctuation">:</span> Gandalf<span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">770</span>
Ordered <span class="token punctuation">,</span> Name<span class="token punctuation">:</span> <span class="token class-name">Ent</span> number <span class="token number">1</span><span class="token punctuation">,</span> Age<span class="token punctuation">:</span> <span class="token number">1500</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>What about ascending/descending order? That's simple we just add the keyword <code>descending</code> or <code>ascending</code> after our <code>orderby</code> statement like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> orderedResult <span class="token operator">=</span> 
  <span class="token keyword">from</span> ch <span class="token keyword">in</span> characters
  <span class="token keyword">orderby</span> ch<span class="token punctuation">.</span><span class="token class-name">Age</span> <span class="token keyword">descending</span>
  <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> ch<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Age <span class="token operator">=</span> ch<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// alt syntax</span>
<span class="token keyword">var</span> oo <span class="token operator">=</span> 
  characters
  <span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Age <span class="token operator">=</span> c<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="grouping"><a href="#grouping" aria-hidden="true" class="header-anchor">#</a> Grouping</h3> <p>Grouping is something we need to do quite often. There are a few things to <em>grouping</em> that we should consider:</p> <ol><li><strong>What to group</strong>, this is your call but imagine having a record of students, what could be interesting to group on. All students from the same place, maybe enrollment year or something else.</li> <li><strong>Calculations/Aggregations</strong>, when you produce a group you usually want to do something with it like maybe count the number of rows or do some other operations like calculating the average</li> <li><strong>How to read</strong> from a grouping, we will learn how to iterate over the group that is produced from our grouping statement.</li></ol> <p>Let's have a look at a couple of examples where we address the above. First out let's look at simple grouping:</p> <p><strong>Simple grouping</strong></p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> characters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Bilbo&quot;</span><span class="token punctuation">,</span>
      Age<span class="token operator">=</span> <span class="token number">290</span><span class="token punctuation">,</span>
      Type<span class="token operator">=</span><span class="token string">&quot;Hobbit&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Frodo&quot;</span><span class="token punctuation">,</span>
      Age <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">,</span>
      Type <span class="token operator">=</span> <span class="token string">&quot;Hobbit&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">Character</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> <span class="token string">&quot;Gandalf&quot;</span><span class="token punctuation">,</span>
      Age<span class="token operator">=</span> <span class="token number">770</span><span class="token punctuation">,</span>
      Type<span class="token operator">=</span><span class="token string">&quot;Maya&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> result <span class="token operator">=</span>
  <span class="token keyword">from</span> c <span class="token keyword">in</span> characters
  <span class="token keyword">group</span> c by c<span class="token punctuation">.</span><span class="token class-name">Type</span> <span class="token keyword">into</span> gr
  <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Characters <span class="token operator">=</span> gr<span class="token punctuation">,</span> Race <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// alt syntax</span>
<span class="token keyword">var</span> groupedResult <span class="token operator">=</span> 
  characters
  <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span> c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Type<span class="token punctuation">)</span> 
  <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>gr <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Characters <span class="token operator">=</span> gr<span class="token punctuation">,</span> Race <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> obj <span class="token keyword">in</span> result<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Key: --{0}--&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>Race<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> c <span class="token keyword">in</span> obj<span class="token punctuation">.</span>Characters<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Name: {0}&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>Let's zoom in on the code doing the grouping:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">from</span> c <span class="token keyword">in</span> characters
  <span class="token keyword">group</span> c by c<span class="token punctuation">.</span><span class="token class-name">Type</span> <span class="token keyword">into</span> gr
  <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Characters <span class="token operator">=</span> gr<span class="token punctuation">,</span> Race <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>We see above how we group on the property <code>Type</code>. Additionally, we see how we produce a result consisting of the group <code>gr</code> and the key we group on <code>gr.Key</code>, i.e <code>Type</code>.</p> <p>Finally, we then iterate over the result we need to do so with a nested for-loop as we first get a list of groups and inside of every group we have a number of entries, like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> obj <span class="token keyword">in</span> result<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Key: --{0}--&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>Race<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> c <span class="token keyword">in</span> obj<span class="token punctuation">.</span>Characters<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Name: {0}&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Let's look at a second example but this time we will do a calculation, in this computing the total age for a group. Given the same input data we produce the following statement:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> totalAgeResult <span class="token operator">=</span>
<span class="token keyword">from</span> c <span class="token keyword">in</span> characters
<span class="token keyword">group</span> c by c<span class="token punctuation">.</span><span class="token class-name">Type</span> <span class="token keyword">into</span> gr
<span class="token keyword">select</span> <span class="token keyword">new</span>
<span class="token punctuation">{</span>
    Type <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
    TotalAge <span class="token operator">=</span> gr<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// alt syntax</span>
<span class="token keyword">var</span> totalAgeResult <span class="token operator">=</span>
  characters
    <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Type<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Select</span><span class="token punctuation">(</span>gr <span class="token operator">=&gt;</span> <span class="token keyword">new</span> 
    <span class="token punctuation">{</span>
      Type <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
      TotalAge <span class="token operator">=</span> gr<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Total age by Race&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> obj <span class="token keyword">in</span> totalAgeResult<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Race: {0}&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>Type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;TotalAge: {0}&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>TotalAge<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>Let's zoom in especially on the <code>select</code> where we produce a record consisting of the grouping key and our computation:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">select</span> <span class="token keyword">new</span>
<span class="token punctuation">{</span>
  Type <span class="token operator">=</span> gr<span class="token punctuation">.</span>Key<span class="token punctuation">,</span>
  TotalAge <span class="token operator">=</span> gr<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>Age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="joining"><a href="#joining" aria-hidden="true" class="header-anchor">#</a> Joining</h3> <p>Joining data is something we are used to from working with Databases. In fact we have many different joins for different purposes. Let's talk about sum of them:</p> <ol><li><strong>inner join</strong>, this join takes all the records that match a certain condition and exclude any matching records</li> <li><strong>left join</strong>, this join does an attempt of stitching together records that may not match. Where it matches we get proper values and where it doesn't we get NULL. I've usually seen this one used when we want to produce for example a sales record of your inventory. Not all items for sale might actually have been sold but for the ones who have you want to know how many have. Usually, the output looks something like this:</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>--------- --------
ProductId Quantity
--------- --------
1         5
2         NULL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>So how can we use Join with Linq? Here's the syntax for a simple join, but keep in mind there are many joins and this is a big topic, refer to the References section to see more joins:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">// our data we are about to join</span>

<span class="token keyword">var</span> movies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Movie</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
      Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> 
      Name<span class="token operator">=</span><span class="token string">&quot;Episode IV - A new Hope&quot;</span><span class="token punctuation">,</span> 
      ReleaseYear<span class="token operator">=</span><span class="token number">1977</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
      Id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> 
      Name<span class="token operator">=</span><span class="token string">&quot;Episode V - Empire Strikes back&quot;</span><span class="token punctuation">,</span> 
      ReleaseYear<span class="token operator">=</span><span class="token number">1980</span> 
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> 
      Id <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> 
      Name<span class="token operator">=</span><span class="token string">&quot;Episode VI - Return of the Jedi&quot;</span><span class="token punctuation">,</span> 
      ReleaseYear<span class="token operator">=</span><span class="token number">1983</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> movieCharacters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>MovieCharacter<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">MovieCharacter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> MovieId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Name<span class="token operator">=</span> <span class="token string">&quot;Luke Skywalker&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">MovieCharacter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> MovieId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Name<span class="token operator">=</span> <span class="token string">&quot;Princess Leia&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> resultJoined <span class="token operator">=</span> 
  <span class="token keyword">from</span> m <span class="token keyword">in</span> movies
  <span class="token keyword">join</span> c <span class="token keyword">in</span> characters on m<span class="token punctuation">.</span><span class="token class-name">Id</span> equals c<span class="token punctuation">.</span><span class="token class-name">MovieId</span>
  <span class="token keyword">select</span> <span class="token keyword">new</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
      Movie <span class="token operator">=</span> m<span class="token punctuation">.</span>Name
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> resultJoinedAlt <span class="token operator">=</span> 
  movies
    <span class="token punctuation">.</span><span class="token function">Join</span><span class="token punctuation">(</span> 
      characters<span class="token punctuation">,</span> <span class="token comment">// join with collection</span>
      m <span class="token operator">=&gt;</span> m<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>  <span class="token comment">// key from outer collection</span>
      c <span class="token operator">=&gt;</span> c<span class="token punctuation">.</span>MovieId<span class="token punctuation">,</span> <span class="token comment">// key from inner collection</span>
      <span class="token punctuation">(</span>m<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> Movie <span class="token operator">=</span> m<span class="token punctuation">.</span>Name <span class="token punctuation">}</span> <span class="token comment">// result selector </span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword">var</span> r <span class="token keyword">in</span> resultJoined<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
  Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;Joined {0} {1}&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>Let's zoom in on our <code>join</code> query:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> resultJoined <span class="token operator">=</span> 
  <span class="token keyword">from</span> m <span class="token keyword">in</span> movies
  <span class="token keyword">join</span> c <span class="token keyword">in</span> characters on m<span class="token punctuation">.</span><span class="token class-name">Id</span> equals c<span class="token punctuation">.</span><span class="token class-name">MovieId</span>
  <span class="token keyword">select</span> <span class="token keyword">new</span>
  <span class="token punctuation">{</span>
      Name <span class="token operator">=</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
      Movie <span class="token operator">=</span> m<span class="token punctuation">.</span>Name
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>We see that we, just like in SQL, start with one data source <code>movies</code> and then we bind it to another data source <code>characters</code> using <code>join</code> and <code>on</code> to state what columns belong together. In this case, we are saying that <code>Id</code> from <code>movies</code> is the same thing as <code>MovieId</code> from <code>characters</code>.</p> <p>Producing a result like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Joined Luke Skywalker Episode IV - A new Hope
Joined Princess Leia Episode IV - A new Hope
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>But I thought Luke &amp; Leia were in all the movies?</p></blockquote> <p>Ssh, don't ruin the demo 😉</p> <h3 id="hierarchical-data"><a href="#hierarchical-data" aria-hidden="true" class="header-anchor">#</a> Hierarchical data</h3> <p>Let's talk about hierarchical data. In the join example, we had two separate data sources <code>movies</code> and <code>characters</code>. Sometimes we have everything in one object graph like so:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
    Created <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">,</span>
    OrderItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token class-name">OrderItem</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">OrderItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Quantity <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
            Price <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
            Product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Name <span class="token operator">=</span> <span class="token string">&quot;Random ssschwaag&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">OrderItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Quantity <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
            Price <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span>
            Product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                Name <span class="token operator">=</span> <span class="token string">&quot;Stickers pack&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>The good news is that Linq can help us to ask for data over the entire graph using an operator referred to as <code>SelectMany()</code>. When we use our SQL like syntax however it looks a lot like the <code>join</code> statement. Let's show it:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token keyword">from</span> o <span class="token keyword">in</span> orders
  <span class="token keyword">from</span> item <span class="token keyword">in</span> o<span class="token punctuation">.</span><span class="token class-name">OrderItems</span>
  <span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span>
    OrderId <span class="token operator">=</span> o<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
    Sum <span class="token operator">=</span> item<span class="token punctuation">.</span>Quantity <span class="token operator">*</span> item<span class="token punctuation">.</span>Price<span class="token punctuation">,</span>
    Name <span class="token operator">=</span> item<span class="token punctuation">.</span>Product<span class="token punctuation">.</span>Name
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// alt syntax</span>
<span class="token keyword">var</span> r <span class="token operator">=</span> orders
  <span class="token punctuation">.</span><span class="token function">SelectMany</span><span class="token punctuation">(</span> 
    o <span class="token operator">=&gt;</span> o<span class="token punctuation">.</span>OrderItems<span class="token punctuation">,</span> <span class="token comment">// go at depth</span>
    <span class="token punctuation">(</span>order<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token comment">// result selector, containing outer and inner collection</span>
    <span class="token punctuation">{</span>
        OrderId <span class="token operator">=</span> order<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
        Sum <span class="token operator">=</span> item<span class="token punctuation">.</span>Quantity <span class="token operator">*</span> item<span class="token punctuation">.</span>Price<span class="token punctuation">,</span>
        Name <span class="token operator">=</span> item<span class="token punctuation">.</span>Product<span class="token punctuation">.</span>Name
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>What we can see from the above is how we have two data sources <code>orders</code> and <code>o.OrderItems</code>. The first is the <code>order</code> itself and the other data source is the nested <code>OrderItems</code> on the <code>order</code>. Then we create a projection consisting of data from both an <code>order</code>, <code>orderitem</code> and even the <code>product</code>:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">select</span> <span class="token keyword">new</span> <span class="token punctuation">{</span>
  OrderId <span class="token operator">=</span> o<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
  Sum <span class="token operator">=</span> item<span class="token punctuation">.</span>Quantity <span class="token operator">*</span> item<span class="token punctuation">.</span>Price<span class="token punctuation">,</span>
  Name <span class="token operator">=</span> item<span class="token punctuation">.</span>Product<span class="token punctuation">.</span>Name
<span class="token punctuation">}</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">in</span> result<span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot; Nested, Order: {0} Sum: {1} Name: {2}&quot;</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>OrderId<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Sum<span class="token punctuation">,</span> item<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>This produces the result:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Nested, Order: 1 Sum: 10 Name: Random ssschwaag
Nested, Order: 1 Sum: 300 Name: Stickers pack
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>As you can see this is quite powerful.</p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We've covered how the what and why of Linq and hopefully you saw the need for one unifying language regardless of the data source. Furthermore, we've covered different operators in Linq and how you can use them to <em>group</em>, <em>transform</em> and <em>compute</em> what you need. It's impossible to cover everything so I urge you to have a look at the references section of this article to dive deeper. Hopefully, your understanding is now good enough so you can study further on your own.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e3a22685.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/153.ecd63d9d.js" defer></script>
  </body>
</html>
