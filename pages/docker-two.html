<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Learn Docker, from the beginning, part II</title>
    <meta name="description" content="[object Object]">
    <head link="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-abap.js"></head>
    
    <link rel="preload" href="/assets/css/0.styles.93390a24.css" as="style"><link rel="preload" href="/assets/js/app.b5d15e4f.js" as="script"><link rel="preload" href="/assets/js/9.4bb2b8d6.js" as="script"><link rel="preload" href="/assets/js/4.4e8b8d29.js" as="script"><link rel="preload" href="/assets/js/111.c15bb740.js" as="script"><link rel="prefetch" href="/assets/js/1.24c608c1.js"><link rel="prefetch" href="/assets/js/10.3c14d46c.js"><link rel="prefetch" href="/assets/js/100.b2add775.js"><link rel="prefetch" href="/assets/js/101.928f5dd0.js"><link rel="prefetch" href="/assets/js/102.0aeafa5b.js"><link rel="prefetch" href="/assets/js/103.5f99b812.js"><link rel="prefetch" href="/assets/js/104.6aac54a0.js"><link rel="prefetch" href="/assets/js/105.515585f2.js"><link rel="prefetch" href="/assets/js/106.983710b4.js"><link rel="prefetch" href="/assets/js/107.1d6966ad.js"><link rel="prefetch" href="/assets/js/108.c23e0f28.js"><link rel="prefetch" href="/assets/js/109.7e7a671a.js"><link rel="prefetch" href="/assets/js/11.a62beca1.js"><link rel="prefetch" href="/assets/js/110.81e9f7f0.js"><link rel="prefetch" href="/assets/js/112.287d3b62.js"><link rel="prefetch" href="/assets/js/113.6e421530.js"><link rel="prefetch" href="/assets/js/114.9deea547.js"><link rel="prefetch" href="/assets/js/115.4411d9d0.js"><link rel="prefetch" href="/assets/js/116.a9bdc1af.js"><link rel="prefetch" href="/assets/js/117.821073db.js"><link rel="prefetch" href="/assets/js/118.e4f04bc7.js"><link rel="prefetch" href="/assets/js/119.abfdb5e0.js"><link rel="prefetch" href="/assets/js/12.07aa0299.js"><link rel="prefetch" href="/assets/js/120.5ef5af10.js"><link rel="prefetch" href="/assets/js/121.078b4cfe.js"><link rel="prefetch" href="/assets/js/122.4f840c0a.js"><link rel="prefetch" href="/assets/js/123.14778f84.js"><link rel="prefetch" href="/assets/js/124.97a77cd3.js"><link rel="prefetch" href="/assets/js/125.f715af09.js"><link rel="prefetch" href="/assets/js/126.33667150.js"><link rel="prefetch" href="/assets/js/127.0cfd65ab.js"><link rel="prefetch" href="/assets/js/128.e2276a9a.js"><link rel="prefetch" href="/assets/js/129.e5f5228b.js"><link rel="prefetch" href="/assets/js/13.2ad02b9b.js"><link rel="prefetch" href="/assets/js/130.21dd9e59.js"><link rel="prefetch" href="/assets/js/131.28c43f99.js"><link rel="prefetch" href="/assets/js/132.41823ed8.js"><link rel="prefetch" href="/assets/js/133.e23e9758.js"><link rel="prefetch" href="/assets/js/134.bdb416b1.js"><link rel="prefetch" href="/assets/js/135.67a0e4ce.js"><link rel="prefetch" href="/assets/js/136.7203e28c.js"><link rel="prefetch" href="/assets/js/137.4ab0b11b.js"><link rel="prefetch" href="/assets/js/138.ffa4c4fa.js"><link rel="prefetch" href="/assets/js/139.3d916307.js"><link rel="prefetch" href="/assets/js/14.29c9effd.js"><link rel="prefetch" href="/assets/js/140.ed352d8b.js"><link rel="prefetch" href="/assets/js/141.188f5713.js"><link rel="prefetch" href="/assets/js/142.92c9ffbd.js"><link rel="prefetch" href="/assets/js/143.058155c4.js"><link rel="prefetch" href="/assets/js/144.e1aa87ae.js"><link rel="prefetch" href="/assets/js/145.1220dcf1.js"><link rel="prefetch" href="/assets/js/146.285efe6c.js"><link rel="prefetch" href="/assets/js/147.a114fb93.js"><link rel="prefetch" href="/assets/js/148.2e990988.js"><link rel="prefetch" href="/assets/js/149.a5dd475a.js"><link rel="prefetch" href="/assets/js/15.94228c4c.js"><link rel="prefetch" href="/assets/js/150.b8c75c15.js"><link rel="prefetch" href="/assets/js/151.51529c52.js"><link rel="prefetch" href="/assets/js/152.8e041d4e.js"><link rel="prefetch" href="/assets/js/153.073a877d.js"><link rel="prefetch" href="/assets/js/154.58ad47ca.js"><link rel="prefetch" href="/assets/js/155.357b2ba0.js"><link rel="prefetch" href="/assets/js/156.f9fd8c77.js"><link rel="prefetch" href="/assets/js/157.466eea0a.js"><link rel="prefetch" href="/assets/js/16.f3d226a0.js"><link rel="prefetch" href="/assets/js/17.f01c72ab.js"><link rel="prefetch" href="/assets/js/18.0fbc545b.js"><link rel="prefetch" href="/assets/js/19.4162c2d8.js"><link rel="prefetch" href="/assets/js/20.ad1e1678.js"><link rel="prefetch" href="/assets/js/21.3d1dd8a6.js"><link rel="prefetch" href="/assets/js/22.19dc5d2b.js"><link rel="prefetch" href="/assets/js/23.1d2a2eb8.js"><link rel="prefetch" href="/assets/js/24.cddc6c39.js"><link rel="prefetch" href="/assets/js/25.9e7af4eb.js"><link rel="prefetch" href="/assets/js/26.d3389bb6.js"><link rel="prefetch" href="/assets/js/27.f27845d4.js"><link rel="prefetch" href="/assets/js/28.f100b299.js"><link rel="prefetch" href="/assets/js/29.203a89ad.js"><link rel="prefetch" href="/assets/js/3.95140222.js"><link rel="prefetch" href="/assets/js/30.0646cb52.js"><link rel="prefetch" href="/assets/js/31.6dc5c171.js"><link rel="prefetch" href="/assets/js/32.0c08c75c.js"><link rel="prefetch" href="/assets/js/33.084539d2.js"><link rel="prefetch" href="/assets/js/34.cd9c78e2.js"><link rel="prefetch" href="/assets/js/35.7470d6c4.js"><link rel="prefetch" href="/assets/js/36.fbddd3e7.js"><link rel="prefetch" href="/assets/js/37.bed7fd15.js"><link rel="prefetch" href="/assets/js/38.420adfd4.js"><link rel="prefetch" href="/assets/js/39.9c2cbea6.js"><link rel="prefetch" href="/assets/js/40.136e806f.js"><link rel="prefetch" href="/assets/js/41.1d6d37ab.js"><link rel="prefetch" href="/assets/js/42.e98d8316.js"><link rel="prefetch" href="/assets/js/43.944e926a.js"><link rel="prefetch" href="/assets/js/44.419e7011.js"><link rel="prefetch" href="/assets/js/45.8fecc792.js"><link rel="prefetch" href="/assets/js/46.a411ef92.js"><link rel="prefetch" href="/assets/js/47.c7c1d6d6.js"><link rel="prefetch" href="/assets/js/48.711f6d14.js"><link rel="prefetch" href="/assets/js/49.b98ceaf5.js"><link rel="prefetch" href="/assets/js/5.44d1fb4e.js"><link rel="prefetch" href="/assets/js/50.c7600199.js"><link rel="prefetch" href="/assets/js/51.6d0c8155.js"><link rel="prefetch" href="/assets/js/52.7a8c0bb3.js"><link rel="prefetch" href="/assets/js/53.9771efd0.js"><link rel="prefetch" href="/assets/js/54.eece5e74.js"><link rel="prefetch" href="/assets/js/55.04bbe8e4.js"><link rel="prefetch" href="/assets/js/56.7ac42bac.js"><link rel="prefetch" href="/assets/js/57.824782a9.js"><link rel="prefetch" href="/assets/js/58.e05884bd.js"><link rel="prefetch" href="/assets/js/59.75711e56.js"><link rel="prefetch" href="/assets/js/6.67cc1f3f.js"><link rel="prefetch" href="/assets/js/60.6e45a6d4.js"><link rel="prefetch" href="/assets/js/61.988bbee4.js"><link rel="prefetch" href="/assets/js/62.84f797dc.js"><link rel="prefetch" href="/assets/js/63.f38ea92b.js"><link rel="prefetch" href="/assets/js/64.fa48b3c7.js"><link rel="prefetch" href="/assets/js/65.39ac169b.js"><link rel="prefetch" href="/assets/js/66.9c7391a1.js"><link rel="prefetch" href="/assets/js/67.ce48dc12.js"><link rel="prefetch" href="/assets/js/68.62a7b0ea.js"><link rel="prefetch" href="/assets/js/69.e9afc083.js"><link rel="prefetch" href="/assets/js/7.e50b16ef.js"><link rel="prefetch" href="/assets/js/70.4bb9f5e8.js"><link rel="prefetch" href="/assets/js/71.f8cf7633.js"><link rel="prefetch" href="/assets/js/72.77c6a3b3.js"><link rel="prefetch" href="/assets/js/73.efeb4873.js"><link rel="prefetch" href="/assets/js/74.c0f5fa6e.js"><link rel="prefetch" href="/assets/js/75.1e92a1f7.js"><link rel="prefetch" href="/assets/js/76.7662f685.js"><link rel="prefetch" href="/assets/js/77.d1006e5a.js"><link rel="prefetch" href="/assets/js/78.26cf6a79.js"><link rel="prefetch" href="/assets/js/79.965e4d48.js"><link rel="prefetch" href="/assets/js/8.988484b0.js"><link rel="prefetch" href="/assets/js/80.9517eb36.js"><link rel="prefetch" href="/assets/js/81.cd32c4e1.js"><link rel="prefetch" href="/assets/js/82.6c28eb63.js"><link rel="prefetch" href="/assets/js/83.e6f31907.js"><link rel="prefetch" href="/assets/js/84.5f965d20.js"><link rel="prefetch" href="/assets/js/85.bcac1afd.js"><link rel="prefetch" href="/assets/js/86.83f4f46e.js"><link rel="prefetch" href="/assets/js/87.85a69ae3.js"><link rel="prefetch" href="/assets/js/88.6f8d7a68.js"><link rel="prefetch" href="/assets/js/89.9ffeafb5.js"><link rel="prefetch" href="/assets/js/90.0c0adb7a.js"><link rel="prefetch" href="/assets/js/91.2d7b1a33.js"><link rel="prefetch" href="/assets/js/92.1aeaf73e.js"><link rel="prefetch" href="/assets/js/93.7f4d3060.js"><link rel="prefetch" href="/assets/js/94.b453a3de.js"><link rel="prefetch" href="/assets/js/95.69298361.js"><link rel="prefetch" href="/assets/js/96.52f52fac.js"><link rel="prefetch" href="/assets/js/97.ddb48565.js"><link rel="prefetch" href="/assets/js/98.ce30c36c.js"><link rel="prefetch" href="/assets/js/99.a80b0689.js">
    <link rel="stylesheet" href="/assets/css/0.styles.93390a24.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Learn Docker, from the beginning, part II</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/docker-two.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/docker-two.html#recap-and-the-problem-of-not-using-a-volume" class="sidebar-link">Recap and the problem of not using a volume</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/docker-two.html#run-a-container" class="sidebar-link">Run a container</a></li><li class="sidebar-sub-header"><a href="/pages/docker-two.html#update-our-app" class="sidebar-link">Update our app</a></li></ul></li><li><a href="/pages/docker-two.html#using-a-volume" class="sidebar-link">Using a volume</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/docker-two.html#creating-and-managing-a-volume" class="sidebar-link">Creating and managing a volume</a></li><li class="sidebar-sub-header"><a href="/pages/docker-two.html#mounting-a-volume-in-your-application" class="sidebar-link">Mounting a volume in your application</a></li><li class="sidebar-sub-header"><a href="/pages/docker-two.html#mounting-a-subdirectory-as-a-volume" class="sidebar-link">Mounting a subdirectory as a volume</a></li><li class="sidebar-sub-header"><a href="/pages/docker-two.html#treating-our-application-as-a-volume" class="sidebar-link">Treating our application as a volume</a></li></ul></li><li><a href="/pages/docker-two.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="learn-docker-from-the-beginning-part-ii"><a href="#learn-docker-from-the-beginning-part-ii" aria-hidden="true" class="header-anchor">#</a> Learn Docker, from the beginning, part II</h1> <p><img src="https://cdn-images-1.medium.com/max/800/1*8DG81gjTPZ2cmTfZmeD9nw.jpeg" alt=""></p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p>This article is part of a series:</p> <ul><li><a href="https://softchris.github.io/pages/docker-one.html" target="_blank" rel="noopener noreferrer">Docker — from the beginning part I<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, This covers why Docker and the basic concepts such containers, images and Dockerfile and of course the commands you need to manage them.</li> <li>Docker — from the beginning, Part II, <strong>we are here</strong></li> <li><a href="https://softchris.github.io/pages/docker-three.html" target="_blank" rel="noopener noreferrer">Docker — from the beginning, Part III<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, this is about how to deal with Databases, putting them into containers and how to make containers talk to other containers using legacy linking but also the new standard through networks</li> <li><a href="https://softchris.github.io/pages/docker-four.html" target="_blank" rel="noopener noreferrer">Docker — from the beginning, Part IV<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, Part IV, this is how we manage more than one service using Docker Compose ( this is 1/2 part on Docker Compose)</li> <li><a href="https://softchris.github.io/pages/docker-five.html" target="_blank" rel="noopener noreferrer">Docker - from the beginning, Part V<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, this part is the second and concluding part on Docker Compose where we cover Volumes, Environment Variables and working with Databases and Networks</li></ul> <p>Welcome to the second part of this series about Docker. Hopefully, you have read the first part to gain some basic understanding of Dockers core concepts and its basic commands or you have acquired that knowledge elsewhere.</p> <p>In this article, we will attempt to cover the following topics</p> <ul><li><strong>recap and problem introduction</strong> , let’s recap on the lessons learned from part I and let’s try to describe how not using a volume can be quite painful</li> <li><strong>persist data</strong> , we can use Volumes to persist files we create or Databases that we change ( e.g Sqllite).</li> <li><strong>turning our workdir into a volume</strong> , Volumes also give us a great way to work with our application without having to <em>set up</em> and <em>tear down</em> the container for every change.</li></ul> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <p>Using Docker and containerization is about breaking apart a monolith into microservices. Throughout this series, we will learn to master Docker and all its commands. Sooner or later you will want to take your containers to a production environment. That environment is usually the Cloud. When you feel you've got enough Docker experience have a look at these links to see how Docker can be used in the Cloud as well:</p> <ul><li><a href="https://docs.microsoft.com/en-gb/azure/containers/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Containers in the Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Great overview page that shows what else there is to know about containers in the Cloud</li> <li><a href="https://docs.microsoft.com/en-gb/azure/container-instances/container-instances-tutorial-prepare-app?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Deploying your containers in the Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Tutorial that shows how easy it is to leverage your existing Docker skill and get your services running in the Cloud</li> <li><a href="https://docs.microsoft.com/en-gb/azure/container-instances/container-instances-tutorial-prepare-acr?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Creating a container registry<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Your Docker images can be in Docker Hub but also in a Container Registry in the Cloud. Wouldn't it be great to store your images somewhere and actually be able to create a service from that Registry in a matter of minutes?</li></ul> <h2 id="recap-and-the-problem-of-not-using-a-volume"><a href="#recap-and-the-problem-of-not-using-a-volume" aria-hidden="true" class="header-anchor">#</a> Recap and the problem of not using a volume</h2> <p>Ok, so we will keep working on the application we created in the first part of this series, that is a Node.js application with the library express installed.</p> <p>We will do the following in this section:</p> <ul><li><strong>run a container</strong>, we will start a container and thereby repeat some basic Docker commands we learned in the first part of this series</li> <li><strong>update our app</strong>, update our source code and start and stop a container and realize why this way of working <em>is quite painful</em></li></ul> <h3 id="run-a-container"><a href="#run-a-container" aria-hidden="true" class="header-anchor">#</a> Run a container</h3> <p>As our application grows we might want to do add routes to it or change what is rendered on a specific route. Let’s show the source code we have so far:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// app.js</span>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Example app listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Now let’s see if we remember our basic commands. Let’s type:</p> <blockquote><p>docker ps</p></blockquote> <p><img src="https://cdn-images-1.medium.com/max/1024/1*DJkCfLKMeApcIwxlHWnmgA.png" alt=""></p> <p>Ok, that looks empty. So we cleaned up last time with docker stop or docker kill , regardless of what we used we don’t have a container that we can start, so we need to build one. Let’s have a look at what images we have:</p> <blockquote><p>docker images</p></blockquote> <p><img src="https://cdn-images-1.medium.com/max/1024/1*I3vpLrl_I_v5y-63oFlOPg.png" alt=""></p> <p>Ok, so we have our image there, let’s create and run a container:</p> <blockquote><p>docker run -d -p 8000:3000 chrisnoring/node</p></blockquote> <p>That should lead to a container up and running at port 8000 and it should run in detached mode, thanks to us specifying the -d flag.</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*JXYLtwX_J0vFqgXvqaNyzg.png" alt=""></p> <p>We get a container ID above, good. Let’s see if we can find our application at <a href="http://localhost:8000:" target="_blank" rel="noopener noreferrer">http://localhost:8000:<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://cdn-images-1.medium.com/max/528/1*e3m0bmN42AEsQcYIurlPGQ.png" alt=""></p> <p>Ok, good there it is. Now we are ready for the next step which is to update our source code.</p> <h3 id="update-our-app"><a href="#update-our-app" aria-hidden="true" class="header-anchor">#</a> Update our app</h3> <p>Let’s start by changing the default route to render out hello Chris , that is add the following line:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello Chris!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Ok, so we save our change and we head back to the browser and we notice it is still saying Hello World. It seems the container is not reflecting our changes. For that to happen we need to bring down the container, remove it, rebuild the image and then run the container again. Because we need to carry out a whole host of commands, we will need to change how we build and run our container namely by actively giving it a name, so instead of running the container like so:</p> <blockquote><p>docker run -d -p 8000:3000 chrisnoring/node</p></blockquote> <p>We now type:</p> <blockquote><p>docker run -d -p 8000:3000 <strong>--name my-container</strong> chrisnoring/node</p></blockquote> <p>This means our container will get the name my-container and it also means that when we refer to our container we can now use its name instead of its container ID, which for our scenario is better as the container ID will change for every setup and tear down.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker stop my-container // this will stop the container, it can still be started if we want to

docker rm my-container // this will remove the container completely

docker build -t chrisnoring/node . // creates an image

docker run -d -p 8000:3000 --name my-container chrisnoring/node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>You can chain these commands to look like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker stop my-container &amp;&amp; docker rm my-container &amp;&amp; docker build -t chrisnoring/node . &amp;&amp; docker run -d -p 8000:3000 --name my-container chrisnoring/node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>My first seeing thought seeing that is WOW, that’s a lot of commands. There has got to be a better way right, especially when I’m in the development phase?</p> <p><img src="https://cdn-images-1.medium.com/max/572/1*LQxLEO4X3SkeqF1y4dMUZA.gif" alt=""></p> <p>Well yes, there is a better way, using a volume. So let’s look at volumes next.</p> <h2 id="using-a-volume"><a href="#using-a-volume" aria-hidden="true" class="header-anchor">#</a> Using a volume</h2> <p>Volumes or data volumes is a way for us to create a place in the host machine where we can write files so they are persisted. Why would we want that? Well, when we are under development we might need to put the application in a certain state so we don’t have to start from the beginning. Typically we would want to store things like log files, JSON files and perhaps even databases (SQLite ) on a volume.</p> <p>It’s quite easy to create a volume and we can do so in many different ways, but mainly there are two ways:</p> <ul><li>before you create a container</li> <li>lazily, e.g while creating the container</li></ul> <h3 id="creating-and-managing-a-volume"><a href="#creating-and-managing-a-volume" aria-hidden="true" class="header-anchor">#</a> Creating and managing a volume</h3> <p>To create a volume you type the following:</p> <blockquote><p>docker volume create [name of volume]</p></blockquote> <p>we can verify that our volume was created by typing:</p> <blockquote><p>docker volume ls</p></blockquote> <p><img src="https://cdn-images-1.medium.com/max/1024/1*pedNxjX7vxC9_U7fFFzhww.png" alt=""></p> <p>This will list all the different volumes we have. Now, this will after a while lead to you having tons of volumes created so it’s good to know how to keep down the number of volumes. For that you can type:</p> <blockquote><p>docker volume prune</p></blockquote> <p>This will remove all the volumes you currently are not using. You will be given a question if you want to proceed.</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*l6Jnu2zeWHeWoM5AZNxEhw.png" alt=""></p> <p>If you want to remove a single volume you can do so by typing:</p> <blockquote><p>docker volume rm [name of volume]</p></blockquote> <p>Another command you most likely will want to know about is the inspect command that allows us to see more details on our created volume and probably most important where it will place the persisted files.</p> <blockquote><p>docker inspect [name of volume]</p></blockquote> <p>A comment on this though is that most of the time you might not care where Docker place these files but sometimes you would want to know due to debugging purposes. As we will see later in this section controlling where files are persisted can work to our advantage when we develop our application.</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*xXyRmDbym7BCrbVNHkPR2g.png" alt=""></p> <p>As you can see the Mountpoint field is telling us where Docker is planning to persist your files.</p> <h3 id="mounting-a-volume-in-your-application"><a href="#mounting-a-volume-in-your-application" aria-hidden="true" class="header-anchor">#</a> Mounting a volume in your application</h3> <p>Ok, so we have come to the point that we want to use our volume in an application. We want to be able to change or create files in our container so that when we pull it down and start it up again our changes will still be there.</p> <p>For this we can use two different commands that achieve relatively the same thing with a different syntax, those are:</p> <ul><li><code>-v</code>, —-volume, the syntax looks like the following -v [name of volume]:[directory in the container], for example -v my-volume:/app</li> <li><code>--mount</code>, the syntax looks like the following--mount source=[name of volume],target=[directory in container] , for example —-mount source=my-volume,target=/app</li></ul> <p>Used in conjuncture with running a container it would look like this for example:</p> <blockquote><p>docker run -d -p 8000:3000 --name my-container --volume my-volume:/logs chrisnoring/node</p></blockquote> <p>Let’s try this out. First off let’s run our container:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*PVaYu78H7_KXw0DoCwGbWQ.png" alt=""></p> <p>Then let’s run our inspect command to ensure our volume has been correctly mounted inside of our container. When we run said command we get a giant JSON output but we are looking for the Mounts property:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*4Nm9GuJEgal4cgXVBoHtqg.png" alt=""></p> <p>Ok, our volume is there, good. Next step is to locate our volume inside of our container. Let’s get into our container with:</p> <blockquote><p>docker exec -it my-container bash</p></blockquote> <p>and thereafter navigate to our <code>/logs</code> directory:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*XT8H3-K8FmutSAriJtiKlA.png" alt=""></p> <p>Ok, now if we bring down our container everything we created in our volume should be persisted and everything that is not placed in the volume should be gone right? Yep, that’s the idea. Good, we understand the principle of volumes.</p> <h3 id="mounting-a-subdirectory-as-a-volume"><a href="#mounting-a-subdirectory-as-a-volume" aria-hidden="true" class="header-anchor">#</a> Mounting a subdirectory as a volume</h3> <p>So far we have been creating a volume and have let Docker decide on where the files are being persisted. What happens if we decide where these files are persisted?</p> <p>Well if we point to a directory on our hard drive it will not only look at that directory and place files there but it will pick the pre-existing files that are in there and bring them into our mount point in the container. Let’s do the following to demonstrate what I mean:</p> <ul><li><strong>create a directory</strong>, let’s create a directory /logs</li> <li><strong>create a file</strong>, let’s create a file logs.txt and write some text in it</li> <li><strong>run our container</strong>, let’s create a mount point to our local directory + /logs</li></ul> <p>The first two commands lead to us having a file structure like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>app.js
Dockerfile
/logs
 logs.txt // contains 'logging host...'
package.json
package-lock.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Now for the run command to get our container up and running:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*iDGnN0fJ7O_Yq1-dJRhGJw.png" alt=""></p> <p>Above we observe that our --volume command looks a bit different. The first argument is <code>$(pwd)/logs</code> which means our current working directory and the subdirectory <code>logs</code>. The second argument is <code>/logs</code> which means we are saying mount our host computers logs directory to a directory with the same name in the container.</p> <p>Let’s dive into the container and establish that the container has indeed pulled in the files from our host computers logs directory:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*CAlhLracjsV5TvhjIjX8hw.png" alt=""></p> <p>As you we can see from the above set of commands we go into the container with <code>docker exec -it my-container bash</code> and then we proceed to navigate ourselves to the logs directory and finally we read out the content of logs.txt with the command <code>cat logs.txt</code>. The result is logging host... e.g the exact file and content that we have on the host computer.</p> <p>But this is a volume however which means there is a connection between the volume in the host computer and the container. Let’s edit the file next on the host computer and see what happens to the container:</p> <p><img src="https://cdn-images-1.medium.com/max/786/1*Jn2xuW_RJFq5n4LKDPY9sg.png" alt=""></p> <p>Wow, it changed in the container as well without us having to tear it down or restarting it.</p> <h3 id="treating-our-application-as-a-volume"><a href="#treating-our-application-as-a-volume" aria-hidden="true" class="header-anchor">#</a> Treating our application as a volume</h3> <p>To make our whole application be treated as a volume we need to tear down the container like so:</p> <blockquote><p>docker kill my-container &amp;&amp; docker rm my-container</p></blockquote> <p>Why do we need to do all that? Well, we are about to change the Dockerfile as well as the source code and our container won’t pick up these changes, unless we use a Volume, like I am about to show you below.</p> <p>Thereafter we need to rerun our container this time with a different volume argument namely <code>--volume $(PWD):/app</code>.</p> <blockquote><p>NOTE, if your PWD consists of a directory with space in it you might need to specify the argument as <code>&quot;$(PWD)&quot;:/app</code> instead, i.e we need to surround <code>$(PWD)</code> with double quotes. Thank you to Vitaly for pointing that out 😃</p></blockquote> <p>The full command looks like this:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*37Ee0rxOCvKNr7I2N3zJKA.png" alt=""></p> <p>This will effectively make our entire app directory a volume and every time we change something in there our container should reflect the changes.</p> <p>So let’s try adding a route in our Node.js Express application like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/docker&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;hello from docker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Ok, so from what we know from dealing with the express library we should be able to reach http://localhost:8000/docker in our browser or?</p> <p><img src="https://cdn-images-1.medium.com/max/674/1*XXzp0H1eTDXIuo2QJ1EYjQ.png" alt=""></p> <p>Sad face 😦. It didn’t work, what did we do wrong? Well here is the thing. If you change the source in a Node.js Express application you need to restart it. This means that we need to take a step back and think how can we restart our Node.js Express web server as soon as there is a file change. There are several ways to accomplish this like for example:</p> <ul><li><strong>install</strong> a library like nodemon or forever that restarts the web server</li> <li><strong>run</strong> a PKILL command and kill the running node.js process and the run node app.js</li></ul> <p>It feels a little less cumbersome to just install a library like nodemon so let’s do that:</p> <p><img src="https://cdn-images-1.medium.com/max/1024/1*-BUicUx8zVeSijJnOI3Z-Q.png" alt=""></p> <p>This means we now have another library dependency in package.json but it means we will need to change how we start our app. We need to start our app using the command <code>nodemon app.js</code>. This means <code>nodemon</code> will take care of the whole restart as soon as there is a change. While we are at it let’s add a start script to package.json, after all, that is the more Node.js -ish way of doing things:</p> <p><img src="https://cdn-images-1.medium.com/max/750/1*o9LH57gAsnkcA2N6osgAEw.png" alt=""></p> <p>Let's describe what we did above, in case you are new to Node.js. Adding a start script to a package.json file means we go into a section called &quot;scripts&quot; and we add an entry start, like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// excerpt package.json
&quot;scripts&quot;: {
  &quot;start&quot;: &quot;nodemon app.js&quot;
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>By default a command defined in <code>&quot;scripts&quot;</code> is run by you typing <code>npm run [name of command]</code>. There are however <em>known</em> commands, like <code>start</code> and <code>test</code> and with known commands we can omit the keyword <code>run</code>, so instead of typing <code>npm run start</code>, we can type <code>npm start</code>.   Let's add another command <code>&quot;log&quot;</code> like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// excerpt package.json

&quot;scripts&quot;: {
  &quot;start&quot;: &quot;nodemon app.js&quot;,
  &quot;log&quot;: &quot;echo \&quot;Logging something to screen\&quot;&quot;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>To run this new command <code>&quot;log&quot;</code> we would type <code>npm run log</code>.</p> <p>Ok, one thing remains though and that is changing the Dockerfile to change how it starts our app. We only need to change the last line from:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ENTRYPOINT [&quot;node&quot;, &quot;app.js&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>to</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ENTRYPOINT [&quot;npm&quot;, &quot;start&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Because we changed the Dockerfile this leads to us having to rebuild the image. So let’s do that:</p> <blockquote><p>docker build -t chrisnoring/node .</p></blockquote> <p>Ok, the next step is to bring up our container:</p> <blockquote><p>docker run -d -p 8000:3000 --name my-container --volume $(PWD):/app chrisnoring/node</p></blockquote> <p>Worth noting is how we expose the entire directory we are currently standing in and mapping that to <code>/app</code> inside the container.</p> <p>Because we’ve already added the /docker route we need to add a new one, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/nodemon'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello from nodemon'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Now we hope that <code>nodemon</code> has done it’s part when we save our change in app.js :</p> <p><img src="https://cdn-images-1.medium.com/max/688/1*65hjrpy7SNfF5_ENUZTXbA.png" alt=""></p> <p>Aaaand, we have a winner. It works to route to /nodemon . I don’t know about you but the first time I got this to work this was me:</p> <p><img src="https://cdn-images-1.medium.com/max/220/1*PyeUlERT6b8VmSF1V0iv5Q.gif" alt=""></p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>This has brought us to the end of our article. We have learned about Volumes which is quite a cool and useful feature and more importantly I’ve shown how you can turn your whole development environment into a volume and keep working on your source code without having to restart the container.</p> <p>In the third part of our series, we will be covering how to work linked containers and databases. So stay tuned.</p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <hr></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b5d15e4f.js" defer></script><script src="/assets/js/9.4bb2b8d6.js" defer></script><script src="/assets/js/4.4e8b8d29.js" defer></script><script src="/assets/js/111.c15bb740.js" defer></script>
  </body>
</html>
