<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Testing your apps like a boss with React.js and Jest</title>
    <meta name="description" content="[object Object]">
    <head link="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-abap.js"></head>
    
    <link rel="preload" href="/assets/css/0.styles.92bf3894.css" as="style"><link rel="preload" href="/assets/js/app.26388f3c.js" as="script"><link rel="preload" href="/assets/js/9.20ba5650.js" as="script"><link rel="preload" href="/assets/js/4.b33b06f6.js" as="script"><link rel="preload" href="/assets/js/107.daffe558.js" as="script"><link rel="prefetch" href="/assets/js/1.76e1fa2c.js"><link rel="prefetch" href="/assets/js/10.5bc7cce6.js"><link rel="prefetch" href="/assets/js/100.7d4da4d2.js"><link rel="prefetch" href="/assets/js/101.3eaa2d62.js"><link rel="prefetch" href="/assets/js/102.20b699c2.js"><link rel="prefetch" href="/assets/js/103.db03b7aa.js"><link rel="prefetch" href="/assets/js/104.c802d704.js"><link rel="prefetch" href="/assets/js/105.0856b4fa.js"><link rel="prefetch" href="/assets/js/106.4dfe3d4d.js"><link rel="prefetch" href="/assets/js/108.2465f7cf.js"><link rel="prefetch" href="/assets/js/109.2bdf55df.js"><link rel="prefetch" href="/assets/js/11.393f848d.js"><link rel="prefetch" href="/assets/js/110.5f942d10.js"><link rel="prefetch" href="/assets/js/111.0fd60c24.js"><link rel="prefetch" href="/assets/js/112.d64efa07.js"><link rel="prefetch" href="/assets/js/113.1e20cdd2.js"><link rel="prefetch" href="/assets/js/114.865941ce.js"><link rel="prefetch" href="/assets/js/115.7d935e27.js"><link rel="prefetch" href="/assets/js/116.fcc98a0d.js"><link rel="prefetch" href="/assets/js/117.5c57dd4a.js"><link rel="prefetch" href="/assets/js/118.264454f3.js"><link rel="prefetch" href="/assets/js/119.25f0debc.js"><link rel="prefetch" href="/assets/js/12.0ed640a1.js"><link rel="prefetch" href="/assets/js/120.e081fd4a.js"><link rel="prefetch" href="/assets/js/13.9b870990.js"><link rel="prefetch" href="/assets/js/14.cc3491a4.js"><link rel="prefetch" href="/assets/js/15.e392c70f.js"><link rel="prefetch" href="/assets/js/16.019de8ce.js"><link rel="prefetch" href="/assets/js/17.c74abd7b.js"><link rel="prefetch" href="/assets/js/18.4ab7403e.js"><link rel="prefetch" href="/assets/js/19.ae2840ee.js"><link rel="prefetch" href="/assets/js/20.09f9c6ec.js"><link rel="prefetch" href="/assets/js/21.4b8a4546.js"><link rel="prefetch" href="/assets/js/22.976a3745.js"><link rel="prefetch" href="/assets/js/23.d4b48fdb.js"><link rel="prefetch" href="/assets/js/24.297c5891.js"><link rel="prefetch" href="/assets/js/25.077254a4.js"><link rel="prefetch" href="/assets/js/26.75dd9db7.js"><link rel="prefetch" href="/assets/js/27.dcb00858.js"><link rel="prefetch" href="/assets/js/28.a4db86ee.js"><link rel="prefetch" href="/assets/js/29.9d917509.js"><link rel="prefetch" href="/assets/js/3.95140222.js"><link rel="prefetch" href="/assets/js/30.e2c51e74.js"><link rel="prefetch" href="/assets/js/31.2f6479c3.js"><link rel="prefetch" href="/assets/js/32.68a73a81.js"><link rel="prefetch" href="/assets/js/33.6407b065.js"><link rel="prefetch" href="/assets/js/34.088d869f.js"><link rel="prefetch" href="/assets/js/35.74235618.js"><link rel="prefetch" href="/assets/js/36.1f9582f8.js"><link rel="prefetch" href="/assets/js/37.bf5d6087.js"><link rel="prefetch" href="/assets/js/38.5b6560fc.js"><link rel="prefetch" href="/assets/js/39.e5757cb4.js"><link rel="prefetch" href="/assets/js/40.9ed5a9e0.js"><link rel="prefetch" href="/assets/js/41.b40ed077.js"><link rel="prefetch" href="/assets/js/42.4172e39e.js"><link rel="prefetch" href="/assets/js/43.b152737d.js"><link rel="prefetch" href="/assets/js/44.19adf854.js"><link rel="prefetch" href="/assets/js/45.4705ec48.js"><link rel="prefetch" href="/assets/js/46.04efbaf9.js"><link rel="prefetch" href="/assets/js/47.cd593f3b.js"><link rel="prefetch" href="/assets/js/48.57ed38b2.js"><link rel="prefetch" href="/assets/js/49.1b30035f.js"><link rel="prefetch" href="/assets/js/5.44d1fb4e.js"><link rel="prefetch" href="/assets/js/50.7fe77565.js"><link rel="prefetch" href="/assets/js/51.16083d55.js"><link rel="prefetch" href="/assets/js/52.222f6cb2.js"><link rel="prefetch" href="/assets/js/53.e9b90e93.js"><link rel="prefetch" href="/assets/js/54.649fb5ce.js"><link rel="prefetch" href="/assets/js/55.036e444e.js"><link rel="prefetch" href="/assets/js/56.297fda50.js"><link rel="prefetch" href="/assets/js/57.a55e641d.js"><link rel="prefetch" href="/assets/js/58.78d82242.js"><link rel="prefetch" href="/assets/js/59.bda880a8.js"><link rel="prefetch" href="/assets/js/6.67cc1f3f.js"><link rel="prefetch" href="/assets/js/60.8d4e87f5.js"><link rel="prefetch" href="/assets/js/61.aa8ee057.js"><link rel="prefetch" href="/assets/js/62.c27f5f3f.js"><link rel="prefetch" href="/assets/js/63.bce219b7.js"><link rel="prefetch" href="/assets/js/64.6e2381f6.js"><link rel="prefetch" href="/assets/js/65.d8a69dca.js"><link rel="prefetch" href="/assets/js/66.8a35e415.js"><link rel="prefetch" href="/assets/js/67.18e461c8.js"><link rel="prefetch" href="/assets/js/68.6f6b80b0.js"><link rel="prefetch" href="/assets/js/69.cc8504ff.js"><link rel="prefetch" href="/assets/js/7.c663ff3b.js"><link rel="prefetch" href="/assets/js/70.6d130260.js"><link rel="prefetch" href="/assets/js/71.32090224.js"><link rel="prefetch" href="/assets/js/72.120c008d.js"><link rel="prefetch" href="/assets/js/73.7968ba45.js"><link rel="prefetch" href="/assets/js/74.6223b8aa.js"><link rel="prefetch" href="/assets/js/75.6e2fbfbe.js"><link rel="prefetch" href="/assets/js/76.c8afe4ea.js"><link rel="prefetch" href="/assets/js/77.85dfd29a.js"><link rel="prefetch" href="/assets/js/78.48b6dd73.js"><link rel="prefetch" href="/assets/js/79.f4800a89.js"><link rel="prefetch" href="/assets/js/8.988484b0.js"><link rel="prefetch" href="/assets/js/80.950ead2a.js"><link rel="prefetch" href="/assets/js/81.93f56455.js"><link rel="prefetch" href="/assets/js/82.909d5110.js"><link rel="prefetch" href="/assets/js/83.9e3357aa.js"><link rel="prefetch" href="/assets/js/84.602dfc87.js"><link rel="prefetch" href="/assets/js/85.f5ebffe9.js"><link rel="prefetch" href="/assets/js/86.4acc7392.js"><link rel="prefetch" href="/assets/js/87.6401c50e.js"><link rel="prefetch" href="/assets/js/88.c7c4444e.js"><link rel="prefetch" href="/assets/js/89.9837a1df.js"><link rel="prefetch" href="/assets/js/90.dc8ae67f.js"><link rel="prefetch" href="/assets/js/91.cb72f099.js"><link rel="prefetch" href="/assets/js/92.7fad9f42.js"><link rel="prefetch" href="/assets/js/93.b499e50b.js"><link rel="prefetch" href="/assets/js/94.9d0cd305.js"><link rel="prefetch" href="/assets/js/95.b5f7873d.js"><link rel="prefetch" href="/assets/js/96.61c5e02c.js"><link rel="prefetch" href="/assets/js/97.cd67c643.js"><link rel="prefetch" href="/assets/js/98.34e5195f.js"><link rel="prefetch" href="/assets/js/99.fb6f5121.js">
    <link rel="stylesheet" href="/assets/css/0.styles.92bf3894.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Testing your apps like a boss with React.js and Jest</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/react-jest.html#get-started" class="sidebar-link">Get started</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#writing-our-first-test" class="sidebar-link">Writing our first test</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#running-our-test" class="sidebar-link">Running our test</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#debugging" class="sidebar-link">Debugging</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/react-jest.html#run-specific-tests" class="sidebar-link">Run specific tests</a></li></ul></li><li><a href="/pages/react-jest.html#debugging-with-breakpoints" class="sidebar-link">Debugging with Breakpoints</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#snapshot-testing" class="sidebar-link">Snapshot testing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/react-jest.html#managing-the-snapshot" class="sidebar-link">Managing the snapshot</a></li></ul></li><li><a href="/pages/react-jest.html#mocking" class="sidebar-link">Mocking</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#coverage" class="sidebar-link">Coverage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-jest.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="testing-your-apps-like-a-boss-with-react-js-and-jest"><a href="#testing-your-apps-like-a-boss-with-react-js-and-jest" aria-hidden="true" class="header-anchor">#</a> Testing your apps like a boss with React.js and Jest</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/e4sxd09l07dzghz35f81.jpg" alt="alt text" title="Cover image, cards"></p> <p>In this article, we will cover the testing framework Jest. We will learn how to:</p> <ul><li><strong>write tests</strong>, it’s a breeze to write tests and assert on specific conditions</li> <li><strong>manage our test suite</strong>, by running specific tests as well as specific test files by utilizing the pattern matching functionality</li> <li><strong>debug our tests</strong>, by augmenting VS Code we can gain the ability to set breakpoints in our tests and create a really nice debugging experience</li> <li><strong>snapshot mastery</strong>, learn how using snapshots can give you increased confidence that your components are still working after a change you made</li> <li><strong>leverage mocking</strong>, mocking dependencies can ensure you only test what you want to test and Jest has great defaults when it comes to mocking</li> <li><strong>coverage reports</strong>, we have come to expect a good coverage tool to be included in all good testing libraries. Jest is no different and it’s really easy to run coverage reports and quickly find what parts of your code that could benefit from some more testing</li></ul> <p>Jest sells itself by saying it’s</p> <blockquote><p>Delightful JavaScript testing</p></blockquote> <p>What makes is delightful? It boasts that it has a <em>zero-configuration</em> experience.</p> <p>Ok, we are getting closer to the answer.</p> <ul><li>Great performance by tests running in parallel thanks to workers.</li> <li>Built-in coverage tool</li> <li>Works with typescript thanks to <a href="https://github.com/kulshekhar/ts-jest" target="_blank" rel="noopener noreferrer">ts-jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="get-started"><a href="#get-started" aria-hidden="true" class="header-anchor">#</a> Get started</h2> <p>Let’s try to set it up and see how much configuration is needed. If you just want to try it, there is a <a href="https://repl.it/languages/jest" target="_blank" rel="noopener noreferrer">Jest REPL<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> where you will be able to write tests among other things.</p> <h2 id="writing-our-first-test"><a href="#writing-our-first-test" aria-hidden="true" class="header-anchor">#</a> Writing our first test</h2> <p>To make the test runner find the tests we need to follow one of three conventions:</p> <ul><li><strong>Create</strong> a <code>__tests__</code> directory and place your files in there</li> <li><strong>Make</strong> file match <code>*spec.js</code></li> <li><strong>Make</strong> file match <code>.test.js</code></li></ul> <p>Ok, so now we know how Jest will find our files, how about writing a test?</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// add.js</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> add<span class="token punctuation">;</span> 

<span class="token comment">// add.spec.js</span>

<span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../add'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should add two numbers'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>We see above that we are using <code>describe</code> to create a test suite and it to create a test within the test suite. We also see that we use <code>expect</code> to assert on the result. The <code>expect</code> gives us access to a lot of <code>matchers</code>, a <em>matcher</em> is a function we call after the expect:</p> <blockquote><p>expect(something).matcher(value)</p></blockquote> <p>As you can see in our test example we are using a matcher called <code>toBe()</code> which essentially matches what's inside the expect to what's inside the matcher, example:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// succeeds </span>
<span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// fails</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>There are a ton of matchers so I urge you to have a look at the ones that exist and try to use the appropriate matcher <a href="https://jestjs.io/docs/en/expect.html" target="_blank" rel="noopener noreferrer">Matchers<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="running-our-test"><a href="#running-our-test" aria-hidden="true" class="header-anchor">#</a> Running our test</h2> <p>The simplest thing we can do is just to create a project using <code>create-react-app</code>, cause Jest is already set up in there. Once we have the project created and all dependencies installed we can simply run:</p> <blockquote><p>yarn test</p></blockquote> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/n8inzr2jxdit6qw29nvg.png" alt="alt text" title="First test run"></p> <p>It will show the above image containing:</p> <ul><li><strong>One</strong> executed test suite,</li> <li><strong>One passing tests</strong> and host of commands that we will explore in a bit. It seems to have run the file <code>src/App.test.js</code>.</li></ul> <p>Let's have a look at the said file:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span> 

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders without crashing'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> div<span class="token punctuation">)</span><span class="token punctuation">;</span> 
  ReactDOM<span class="token punctuation">.</span><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>As we can see it has created a test using it and have also created a component using <code>ReactDOM.render(&lt;App /&gt;, div)</code>, followed by cleaning up after itself by calling <code>ReactDOM.unmount(div)</code>. We haven't really done any assertions at this point, we have just tried to create a component with no errors as the result, which is good to know though.</p> <p>How about we try adding <code>add.js</code> file and its corresponding test?</p> <p>Let’s first add <code>add.js</code>, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// add.js</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> <span class="token punctuation">}</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> add<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>followed by the test:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// add.spec.js</span>

<span class="token keyword">import</span> add <span class="token keyword">from</span> <span class="token string">'../add'</span><span class="token punctuation">;</span> 

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Our Jest session is still running in the terminal:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/s64h8twfsg2ap32steei.png" alt="alt text" title="Jest running"></p> <p>We can see that we now have two passing tests.</p> <h2 id="debugging"><a href="#debugging" aria-hidden="true" class="header-anchor">#</a> Debugging</h2> <p>Any decent test runner/framework should give us the ability to debug our tests. It should give us the ability to:</p> <ul><li><strong>run</strong> specific tests</li> <li><strong>ignore</strong> tests</li> <li><strong>set breakpoints</strong>, let us add breakpoints in our IDE (more up to the IDE vendor to make that happen)</li> <li><strong>run in browser</strong>, let us run our tests in a Browser</li></ul> <p>###Run specific test files
Let us look at how to do these things, let’s start with running specific tests. First off we will add another file <code>subtract.js</code> and a corresponding test.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// subtract.js</span>

<span class="token keyword">function</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">return</span> a <span class="token operator">-</span> b<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> subtract<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>and the test:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// subtract.spec.js</span>

<span class="token keyword">import</span> subtract <span class="token keyword">from</span> <span class="token string">'../subtract'</span><span class="token punctuation">;</span> 

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing subtract'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Let’s have a look at our terminal again and especially at the bottom of it:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/k3zdrw8lmvh4p0gfeqxm.png" alt="alt text" title="Jest running in eatch mode"></p> <p>If you don’t see this press <code>w</code> as indicated on the screen. The above gives us a range of commands which will make our debugging easier:</p> <ul><li><code>a</code>, runs all the tests</li> <li><code>p</code>, this will allow us to specify a pattern, typically we want to specify the name of a file here to make it only run that file.</li> <li><code>t</code>, it does the same as p but it lets us specify a test name instead</li> <li><code>q</code>, quits the watch mode</li> <li><code>Return</code>, to trigger a test run</li></ul> <p>Given the above description we will try to filter it down to only test the <code>add.js</code> file so we type <code>p</code>:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/oxo80iea0c4ph27v3gzs.png" alt="alt text" title="Jest pattern matching"></p> <p>This takes us to a pattern dialog where we can type in the file name. Which we do:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/9up0r4g2q8wxjpdjvoc0.png" alt="alt text" title="Jest pattern matching - typing"></p> <p>Above we can now see that only the <code>add.js</code> file will be targeted.</p> <h3 id="run-specific-tests"><a href="#run-specific-tests" aria-hidden="true" class="header-anchor">#</a> Run specific tests</h3> <p>We have learned how to narrow it down to specific files. We can narrow it down to specific tests even using the <code>p</code>, pattern approach. First off we will need to add a test so we can actually filter it down:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//add.spec.js</span>

<span class="token keyword">import</span> add <span class="token keyword">from</span> <span class="token string">'../add'</span><span class="token punctuation">;</span> 

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing add - should be negative'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>At this point our terminal looks like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/lxhjwxojn9iba0alo96m.png" alt="alt text" title="Jest running specific tests"></p> <p>So we have two passing tests in the same file but we only want to run a specific test. We do that by adding the <code>.only()</code> call to the test, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>it<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span><span class="token string">'testing add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>and the terminal now looks like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/6qo8onxowr9eqxkxxqxm.png" alt="alt text" title="Jest running specific tests with only() function"></p> <p>We can see that adding <code>.only()</code> works really fine if we only want to run that test. We can use <code>.skip()</code> to make the test runner skip a specific test:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>it<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token string">'testing add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The resulting terminal clearly indicated that we skipped a test:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/nt8qpin8o37sssgf2zf7.png" alt="alt text" title="Jest skipping specific tests with skip() function"></p> <h2 id="debugging-with-breakpoints"><a href="#debugging-with-breakpoints" aria-hidden="true" class="header-anchor">#</a> Debugging with Breakpoints</h2> <p>Now, this one is a bit IDE dependant, for this section we will cover how to do this in VS Code. The first thing we are going to do is install an extension. Head over to the extension menu and search for Jest. The following should be showing:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/qjtycapctzj1qbgqfgbd.png" alt="alt text" title="Jest extension VSCode"></p> <p>Install this extension and head back to your code. Now we have some added capabilities. All of our tests should have a <code>Debug link</code> over every single test.</p> <p>At this point, we can add a breakpoint and then press our <code>Debug link</code>. Your breakpoint should now be hit and it should look like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/sm9uriw3jfhes6s25dti.png" alt="alt text" title="Jest extension VSCode"></p> <h2 id="snapshot-testing"><a href="#snapshot-testing" aria-hidden="true" class="header-anchor">#</a> Snapshot testing</h2> <p>Snapshot is about creating a snapshot, a view of what the DOM looks like when you render your component. It’s used to ensure that when you or someone else does a change to the component the snapshot is there to tell you, you did a change, does the change look ok?</p> <p>If you agree with the change you made you can easily update the snapshot with what DOM it now renders. So snapshot is your friend to safeguard you from unintentional changes.</p> <p>Let’s see how we can create a snapshot. First off we might need to install a dependency:</p> <blockquote><p>yarn add react-test-renderer --save</p></blockquote> <p>Next step is to write a component and a test to go along with it. It should look something like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// Todos.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token function-variable function">Todos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span> 
  <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span> 
   <span class="token punctuation">{</span>todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>todo<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">}</span> 
  <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">&gt;</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> Todos<span class="token punctuation">;</span>
<span class="token comment">// Todos.spec.js</span>
<span class="token keyword">import</span> renderer <span class="token keyword">from</span> <span class="token string">'react-test-renderer'</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> Todos <span class="token keyword">from</span> <span class="token string">'../Todos'</span><span class="token punctuation">;</span> 
<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Todo - should create snapshot'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token keyword">const</span> component <span class="token operator">=</span> renderer<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span> 
    <span class="token operator">&lt;</span>Todos todos<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'item1'</span><span class="token punctuation">,</span> <span class="token string">'item2'</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span> 
  <span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">let</span> tree <span class="token operator">=</span> component<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">expect</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatchSnapshot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>Note how import, <code>imports</code> the component we are about to test:</p> <blockquote><p>import Todos from '../Todos';</p></blockquote> <p>This is followed by using the renderer to create an instance of our component. Next step is to turn that component into a JSON representation like so <code>component.toJSON()</code> and lastly, we assert on this by calling <code>expect(tree).toMatchSnapshot()</code>, this will call a snapshot that will place itself in a <code>__snapshots__</code> directory under your tests directory.</p> <h3 id="managing-the-snapshot"><a href="#managing-the-snapshot" aria-hidden="true" class="header-anchor">#</a> Managing the snapshot</h3> <p>Ok, so we have a snapshot, now what? Let’s do a change to our todo component, like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Todos.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token function-variable function">Todos</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> todos <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span> 
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>
    todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">todo</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span> 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>todo<span class="token punctuation">.</span>description<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span> 
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> Todos<span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>We see that our <code>todo</code> is an object instead of a string so it has a <code>title</code> and <code>description</code> property. This WILL make our snapshot react and it will say the following:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/mp16bab37i44pu8tnkw8.png" alt="alt text" title="Jest snapshot failed"></p> <p>It clearly indicates something is different and asks us to inspect the code. If we are happy with the changes we should press <code>u</code> to update the snapshot to its new version. So look at the code and yes this is an intended change so therefore we press <code>u</code>. We end up with the following image telling us everything is ok:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/zn3gr1kh0wnr9jbdwtt8.png" alt="alt text" title="Jest snapshot failed"></p> <h2 id="mocking"><a href="#mocking" aria-hidden="true" class="header-anchor">#</a> Mocking</h2> <p>Mocking is one of those things that needs to work well. Mocking in Jest is quite easy. You need to create your mocks in a directory that is adjacent to your module, or more like a child directory to the module. Let’s show what I mean in code. Imagine you have the following module:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// repository.js</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'data from database'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> data<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Let’s look at a test for this one:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// repository.spec.js</span>

<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'../repository'</span><span class="token punctuation">;</span> 

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'testing repository data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return 1 item'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Not the best of tests but it is a <em>test</em>. Let’s create our mock so that our file structure looks like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>// directory structure

repository.js // our repo file
__mocks__/repository.js // our mock
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Our mock should look like this:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// __mock__/repository.js</span>

<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'mocked data'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> data<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>To use this mock we need to call <code>jest.mock()</code> inside of our test, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token comment">// repository.spec.js</span>

<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'../repository'</span><span class="token punctuation">;</span> 
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'../repository'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// taking __mock/repository instead of the actual one</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'testing repository data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return 1 item'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Now it uses our mock instead of the actual module. Ok you say, why would I want to mock the very thing I want to test. Short answer is : you wouldn’t. So, therefore, we are going to create another file <code>consumer.js</code> that use our <code>repository.js</code>. So let's look at the code for that and its corresponding test:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// consumer.js</span>

<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'./repository'</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'consumer'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span> <span class="token operator">...</span>data<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>item<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Above we clearly see how our consumer use our <code>repository.js</code> and now we want to mock it so we can focus on testing the consumer module. Let's have a look at the test:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// consumer.spec.js</span>

<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'../consumer'</span><span class="token punctuation">;</span> 
jest<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'../repository'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'testing consumer data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return 2 items'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>We use <code>jest.mock()</code> and mocks away the only external dependency this module had.</p> <p>What about libs like <code>lodash</code> or <code>jquery</code>, things that are not modules that we created but is dependant on? We can create mocks for those at the highest level by creating a <code>__mocks__</code> directory.</p> <p>There is a lot more that can be said about mocking, for more details check out the documentation <a href="https://jestjs.io/docs/en/mock-functions.html" target="_blank" rel="noopener noreferrer">Mocking docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="coverage"><a href="#coverage" aria-hidden="true" class="header-anchor">#</a> Coverage</h2> <p>We have come to the final section in this chapter. This is about realizing how much of our code is covered by tests. To check this we just run:</p> <blockquote><p>yarn test coverage</p></blockquote> <p>This will give us a table inside of the terminal that will tell us about the coverage in percentage per file. It will also produce a <code>coverage</code> directory that we can navigate into and find a HTML report of our coverage. But first off let's change the <code>add.js</code> file to add a piece of logic that needs a test, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// add.js</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> b <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span> 
  <span class="token punctuation">}</span> 
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'parameters must be larger than zero'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">export</span> <span class="token keyword">default</span> add<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>Now we can see we have more than one path through the application. If our input params are larger than zero then we have existing tests that cover it.</p> <p>However, if one or more parameters is below zero then we enter a new execution path and that one is NOT covered by tests. Let’s see what that looks like in the coverage report by navigating to <code>coverage/lcov-report</code>. We can show this by typing for example</p> <blockquote><p>http-server -p 5000</p></blockquote> <p>and we will get a report looking like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/6b2zqhuz5pu75ata1wu5.png" alt="alt text" title="Jest coverage overview"></p> <p>Now we can navigate to <code>src/add.js</code> and it should look like this:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/sjb9z28lst8h4cqkme72.png" alt="alt text" title="Jest coverage function"></p> <p>Now we can clearly see how our added code is indicated in red and that we need to add a test to cover that new execution path.</p> <p>Next, we add a test to cover for this, like so:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// add.spec.js</span>

<span class="token keyword">import</span> add <span class="token keyword">from</span> <span class="token string">'../add'</span><span class="token punctuation">;</span> 
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing addition'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    <span class="token keyword">const</span> actual <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span>actual<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'testing addition with neg number'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> 
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toThrow</span><span class="token punctuation">(</span><span class="token string">'parameters must be larger than zero'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Our second case should now cover for the execution path that leads to an exception being thrown. Let’s rerun our coverage report:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/xal8rkmf0odrwjjv1lyn.png" alt="alt text" title="Jest coverage success"></p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>We’ve looked at how to write tests. We’ve also looked at how to debug our tests using an extension from VS Code which has allowed us to set breakpoints.</p> <p>Furthermore, we’ve learned what snapshots are and how to best use them to our advantage.</p> <p>Next up we’ve been looking at leveraging mocking to ensure we are in complete isolation when we test.</p> <p>Lastly, we’ve looked at how we can generate coverage reports and how that can help you to track down parts of your code that could really benefit from some more testing.</p> <p>###Further reading</p> <ul><li>official docs for Jest can be found here <a href="https://jestjs.io/en/" target="_blank" rel="noopener noreferrer">Official docs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>My free <a href="https://legacy.gitbook.com/book/chrisnoring/react/details" target="_blank" rel="noopener noreferrer">React book<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.26388f3c.js" defer></script><script src="/assets/js/9.20ba5650.js" defer></script><script src="/assets/js/4.b33b06f6.js" defer></script><script src="/assets/js/107.daffe558.js" defer></script>
  </body>
</html>
