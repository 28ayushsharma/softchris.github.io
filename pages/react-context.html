<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How YOU can use the Context API in React.js to pubsub</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.32616fcf.css" as="style"><link rel="preload" href="/assets/js/app.b3d08b1f.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/144.610d3a75.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.c579e12d.js"><link rel="prefetch" href="/assets/js/100.3dc81b50.js"><link rel="prefetch" href="/assets/js/101.72742bb2.js"><link rel="prefetch" href="/assets/js/102.c5b6b37f.js"><link rel="prefetch" href="/assets/js/103.1820b033.js"><link rel="prefetch" href="/assets/js/104.eb93834d.js"><link rel="prefetch" href="/assets/js/105.85ce7f52.js"><link rel="prefetch" href="/assets/js/106.3c5e0dfc.js"><link rel="prefetch" href="/assets/js/107.93610e3a.js"><link rel="prefetch" href="/assets/js/108.649f86fc.js"><link rel="prefetch" href="/assets/js/109.1eea06b1.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.aef9a48e.js"><link rel="prefetch" href="/assets/js/111.68a42b05.js"><link rel="prefetch" href="/assets/js/112.41c0d8e4.js"><link rel="prefetch" href="/assets/js/113.4d6c0e43.js"><link rel="prefetch" href="/assets/js/114.01233fba.js"><link rel="prefetch" href="/assets/js/115.58a117ca.js"><link rel="prefetch" href="/assets/js/116.31eb0de0.js"><link rel="prefetch" href="/assets/js/117.d93071ba.js"><link rel="prefetch" href="/assets/js/118.77fde6ba.js"><link rel="prefetch" href="/assets/js/119.d082b2b6.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.1eeaa590.js"><link rel="prefetch" href="/assets/js/121.0008565a.js"><link rel="prefetch" href="/assets/js/122.11adbe32.js"><link rel="prefetch" href="/assets/js/123.c0cc81ac.js"><link rel="prefetch" href="/assets/js/124.492211f9.js"><link rel="prefetch" href="/assets/js/125.a1d286cc.js"><link rel="prefetch" href="/assets/js/126.67d04a2e.js"><link rel="prefetch" href="/assets/js/127.946f0328.js"><link rel="prefetch" href="/assets/js/128.0163d3ea.js"><link rel="prefetch" href="/assets/js/129.c471fa72.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.5e5f2dad.js"><link rel="prefetch" href="/assets/js/131.57c3edaa.js"><link rel="prefetch" href="/assets/js/132.733a653e.js"><link rel="prefetch" href="/assets/js/133.b3a6ace1.js"><link rel="prefetch" href="/assets/js/134.4875d74f.js"><link rel="prefetch" href="/assets/js/135.0d676867.js"><link rel="prefetch" href="/assets/js/136.8fa215a1.js"><link rel="prefetch" href="/assets/js/137.d1a37767.js"><link rel="prefetch" href="/assets/js/138.daf177ae.js"><link rel="prefetch" href="/assets/js/139.a9e6afdb.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.7b6a9dc2.js"><link rel="prefetch" href="/assets/js/141.431d1d8f.js"><link rel="prefetch" href="/assets/js/142.03364e92.js"><link rel="prefetch" href="/assets/js/143.5140e806.js"><link rel="prefetch" href="/assets/js/145.7a02f27f.js"><link rel="prefetch" href="/assets/js/146.932455f9.js"><link rel="prefetch" href="/assets/js/147.4aa312fb.js"><link rel="prefetch" href="/assets/js/148.3a179c70.js"><link rel="prefetch" href="/assets/js/149.9cbc4fb4.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/150.22162903.js"><link rel="prefetch" href="/assets/js/151.289291bd.js"><link rel="prefetch" href="/assets/js/152.557c4f3c.js"><link rel="prefetch" href="/assets/js/153.074d34f1.js"><link rel="prefetch" href="/assets/js/154.9f1b9dfe.js"><link rel="prefetch" href="/assets/js/155.1e0f09ba.js"><link rel="prefetch" href="/assets/js/156.1f86486d.js"><link rel="prefetch" href="/assets/js/157.3d0cc8fc.js"><link rel="prefetch" href="/assets/js/158.229892f9.js"><link rel="prefetch" href="/assets/js/159.d8f4503c.js"><link rel="prefetch" href="/assets/js/16.651173ea.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/18.31fbfd1d.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/21.8afea724.js"><link rel="prefetch" href="/assets/js/22.6ffcdce5.js"><link rel="prefetch" href="/assets/js/23.b53a4ebe.js"><link rel="prefetch" href="/assets/js/24.8940c321.js"><link rel="prefetch" href="/assets/js/25.b89393c2.js"><link rel="prefetch" href="/assets/js/26.e3067144.js"><link rel="prefetch" href="/assets/js/27.9214c9da.js"><link rel="prefetch" href="/assets/js/28.7a0f6ad5.js"><link rel="prefetch" href="/assets/js/29.2d61ba5c.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.b64b4f7c.js"><link rel="prefetch" href="/assets/js/31.1d52fcdf.js"><link rel="prefetch" href="/assets/js/32.2d0049bb.js"><link rel="prefetch" href="/assets/js/33.05b65ac5.js"><link rel="prefetch" href="/assets/js/34.e538e46b.js"><link rel="prefetch" href="/assets/js/35.4f5ca76f.js"><link rel="prefetch" href="/assets/js/36.b2037867.js"><link rel="prefetch" href="/assets/js/37.3c72162a.js"><link rel="prefetch" href="/assets/js/38.50de5acb.js"><link rel="prefetch" href="/assets/js/39.1d878b41.js"><link rel="prefetch" href="/assets/js/40.ab89e15b.js"><link rel="prefetch" href="/assets/js/41.a4d66623.js"><link rel="prefetch" href="/assets/js/42.5f225638.js"><link rel="prefetch" href="/assets/js/43.2208c523.js"><link rel="prefetch" href="/assets/js/44.be6612e4.js"><link rel="prefetch" href="/assets/js/45.8aa741b8.js"><link rel="prefetch" href="/assets/js/46.8ff3bd69.js"><link rel="prefetch" href="/assets/js/47.4fe07faf.js"><link rel="prefetch" href="/assets/js/48.9f02e5cb.js"><link rel="prefetch" href="/assets/js/49.698e3da5.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.535ea91c.js"><link rel="prefetch" href="/assets/js/51.1fcb3554.js"><link rel="prefetch" href="/assets/js/52.fc7407e8.js"><link rel="prefetch" href="/assets/js/53.9bcb2247.js"><link rel="prefetch" href="/assets/js/54.5469560c.js"><link rel="prefetch" href="/assets/js/55.ad7c79d3.js"><link rel="prefetch" href="/assets/js/56.4aeaa534.js"><link rel="prefetch" href="/assets/js/57.5355b3fb.js"><link rel="prefetch" href="/assets/js/58.f3c72a26.js"><link rel="prefetch" href="/assets/js/59.ce0b042e.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.d01a911c.js"><link rel="prefetch" href="/assets/js/61.34faf536.js"><link rel="prefetch" href="/assets/js/62.603ca7ac.js"><link rel="prefetch" href="/assets/js/63.bb5ee168.js"><link rel="prefetch" href="/assets/js/64.87766a1f.js"><link rel="prefetch" href="/assets/js/65.d6e07827.js"><link rel="prefetch" href="/assets/js/66.d8ba6fb6.js"><link rel="prefetch" href="/assets/js/67.0bdd4d2e.js"><link rel="prefetch" href="/assets/js/68.4c3afc1a.js"><link rel="prefetch" href="/assets/js/69.614262f5.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.966d8650.js"><link rel="prefetch" href="/assets/js/71.34a6911b.js"><link rel="prefetch" href="/assets/js/72.05fca5e9.js"><link rel="prefetch" href="/assets/js/73.c26d8425.js"><link rel="prefetch" href="/assets/js/74.1e1a53c7.js"><link rel="prefetch" href="/assets/js/75.a786eaf6.js"><link rel="prefetch" href="/assets/js/76.dca03d61.js"><link rel="prefetch" href="/assets/js/77.af3ce1d2.js"><link rel="prefetch" href="/assets/js/78.f0ad3cac.js"><link rel="prefetch" href="/assets/js/79.7fea66bd.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.c2c37ed9.js"><link rel="prefetch" href="/assets/js/81.a6c06daa.js"><link rel="prefetch" href="/assets/js/82.e9069ad7.js"><link rel="prefetch" href="/assets/js/83.1ead38f3.js"><link rel="prefetch" href="/assets/js/84.319e8c88.js"><link rel="prefetch" href="/assets/js/85.9e65a216.js"><link rel="prefetch" href="/assets/js/86.efc7bce8.js"><link rel="prefetch" href="/assets/js/87.2a4c1c4d.js"><link rel="prefetch" href="/assets/js/88.bbd6d45d.js"><link rel="prefetch" href="/assets/js/89.5c66f752.js"><link rel="prefetch" href="/assets/js/90.230bb3c6.js"><link rel="prefetch" href="/assets/js/91.f4e3893f.js"><link rel="prefetch" href="/assets/js/92.a2448b1e.js"><link rel="prefetch" href="/assets/js/93.31960c6b.js"><link rel="prefetch" href="/assets/js/94.4f4eb673.js"><link rel="prefetch" href="/assets/js/95.05346d83.js"><link rel="prefetch" href="/assets/js/96.0cd0bc5e.js"><link rel="prefetch" href="/assets/js/97.aeb018d6.js"><link rel="prefetch" href="/assets/js/98.ea119b6b.js"><link rel="prefetch" href="/assets/js/99.c65ccf16.js">
    <link rel="stylesheet" href="/assets/css/0.styles.32616fcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>How YOU can use the Context API in React.js to pubsub</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/react-context.html#why-context-api-and-what-is-it" class="sidebar-link">Why Context API and what is it?</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/react-context.html#when-to-use-not-use-it" class="sidebar-link">When to use /not use it</a></li><li class="sidebar-sub-header"><a href="/pages/react-context.html#building-blocks-and-api" class="sidebar-link">Building blocks and API</a></li></ul></li><li><a href="/pages/react-context.html#context-api-in-action" class="sidebar-link">Context API in action</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/react-context.html#creating-a-context-object" class="sidebar-link">Creating a Context object</a></li><li class="sidebar-sub-header"><a href="/pages/react-context.html#declare-a-provider" class="sidebar-link">Declare a Provider</a></li><li class="sidebar-sub-header"><a href="/pages/react-context.html#declare-a-consumer" class="sidebar-link">Declare a Consumer</a></li><li class="sidebar-sub-header"><a href="/pages/react-context.html#usage" class="sidebar-link">Usage</a></li></ul></li><li><a href="/pages/react-context.html#dynamic-context" class="sidebar-link">Dynamic Context</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/react-context.html#changing-the-state-example" class="sidebar-link">Changing the state example</a></li><li class="sidebar-sub-header"><a href="/pages/react-context.html#second-example-—-a-cart" class="sidebar-link">Second example — a cart</a></li></ul></li><li><a href="/pages/react-context.html#higher-order-component" class="sidebar-link">Higher order component</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/react-context.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p># How YOU can use the Context API in React.js</p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/ocnpbihczqqeq90j8tcz.jpg" alt=""></p> <blockquote><p>The React Context exists so you don’t have to pass in data manually at every level. Context is about sharing data to many components. So essentially it's about Publish and Subscribe or Pubsub for short.</p></blockquote> <p>In this article we will learn about the following topics:</p> <ul><li><strong>The context API</strong>, what it is and why use it</li> <li><strong>Building blocks</strong>, we will learn about the different building blocks using a Context and how they work together</li> <li><strong>In action</strong>, we will look at several examples of creating a Context and we will ensure we learn about Dynamic contexts and how HOC, higher order components can help clean up our Context code</li></ul> <p>If you ever get lost following the code samples in the article, have a look at this demo containing all the code shown below:</p> <p><a href="https://github.com/softchris/react-context-demo" target="_blank" rel="noopener noreferrer">https://github.com/softchris/react-context-demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="why-context-api-and-what-is-it"><a href="#why-context-api-and-what-is-it" aria-hidden="true" class="header-anchor">#</a> Why Context API and what is it?</h2> <p>The React Context exists so you don’t have to pass in data manually at every level. Context is about sharing data to many components. The reason we need the Context API is that it’s cumbersome to pass data from parent to child via props if there are many components requiring the same data. By using the Context API we no longer pass this kind of shared data with props.</p> <h3 id="when-to-use-not-use-it"><a href="#when-to-use-not-use-it" aria-hidden="true" class="header-anchor">#</a> When to use /not use it</h3> <p>Things that belong in a context is data that is considered global like a <em>user</em> or a <em>cart</em> etc. So let’s try to list the different reasons for using a Context:</p> <ul><li><strong>data needed in many places</strong> , data that needs to be used by many components like a theme, user or a cart</li> <li><strong>pass props through many components</strong> , sometimes it’s better to use composition over context when you want to pass a <code>props</code> value through many components</li></ul> <h3 id="building-blocks-and-api"><a href="#building-blocks-and-api" aria-hidden="true" class="header-anchor">#</a> Building blocks and API</h3> <p>The Context API consists of some building blocks that it is important that we know about what they are called but also what their role is:</p> <ul><li><strong>context</strong> , the context object is an object holding the current context value and can be subscribed to</li> <li><strong>provider</strong> , This is a React component that provides the value in question, it grabs it from the context object</li> <li><strong>consumer</strong> , This is a React component that is able to consume the value provided by the <code>Provider</code> and is able to show the value</li></ul> <p>This is all a bit theoretical and may sound a little confusing so let’s dive right into an example to clear any confusion.</p> <h2 id="context-api-in-action"><a href="#context-api-in-action" aria-hidden="true" class="header-anchor">#</a> Context API in action</h2> <p>To utilize a Context in React we need to do the following:</p> <ul><li><strong>create a context</strong>, we do this with a call to React.createContext(), this will return a Context object that exposes a <code>Provider Component</code> as well as a <code>Consumer Component</code></li> <li><strong>declare a provider</strong>, this is us grabbing the <code>Provider</code> Component reference available in the context object we just created</li> <li><strong>declare a consumer</strong>, this is also a component that lives on the Context object and we use this to show the value to the user</li></ul> <h3 id="creating-a-context-object"><a href="#creating-a-context-object" aria-hidden="true" class="header-anchor">#</a> Creating a Context object</h3> <p>Let’s start by creating a React project using Create React App, CRA:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npx create-react-app context-demo
cd context-demo
npm start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Good, we have a project. Now let’s create a file called <code>theme.js</code>, it will hold our <code>Context</code> object.</p> <p>It’s quite straight-forward to create a Context object. For that we use the <code>React.createContext()</code> method like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// theme.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ThemeContext<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Above we call <code>createContext()</code> and we give it an input parameter which is simply the default value we want the context to have. We also export the object itself so we can use it in other places.</p> <p>That’s very little code to write to use something as powerful as a <code>Context</code>. We haven’t seen anything yet though, so the fun has just begun:</p> <h3 id="declare-a-provider"><a href="#declare-a-provider" aria-hidden="true" class="header-anchor">#</a> Declare a Provider</h3> <p>Ok, so we have a <code>Context</code> object let’s grab a reference to a <code>Provider</code> next. For this, we will first create a component file <code>Sample.js</code>, you can really call it anything you want but the point is to have a React component to demonstrate how the <code>Context</code> object works. Let’s create a component:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Sample.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Theme <span class="token keyword">from</span> <span class="token string">'./theme'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Sample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Provider</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>dark<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

// declare consumer

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Provider</span></span><span class="token punctuation">&gt;</span></span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Sample<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Above we are declaring a normal functional React component and we also import our <code>Theme</code>, our <code>Context</code> object. We then grab a reference to our provider by calling <code>Theme.Provider</code>. At this point, nothing really works, because we are lacking a <code>Consumer</code> component that can actually consume the value and thereby show it to a user.</p> <p>Furthermore, we also set the value property to <code>dark</code>.</p> <p>Wait wait, hold on… Didn’t we just set the value to light in our <code>theme.js</code> file, what’s the point of doing that if we are going to override it in the <code>Provider</code> anyway? Very good question, let’s save it a bit until we declared a Consumer and then it will all make sense.</p> <h3 id="declare-a-consumer"><a href="#declare-a-consumer" aria-hidden="true" class="header-anchor">#</a> Declare a Consumer</h3> <p>So next up is about declaring a <code>Consumer</code> component and show how we can show the value to the user. Let’s add that to our code:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Sample.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Theme <span class="token keyword">from</span> <span class="token string">'./theme'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Sample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Provider</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>dark<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
  </span><span class="token punctuation">{</span><span class="token parameter">theme</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Our theme is: </span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">   
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Provider</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Sample<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>Above we added our <code>Consumer</code>, in the form of <code>Theme.Consumer</code> component and we can see that we inside it define a function whose parameter is our theme value. We are then able to show the <code>theme</code> value in a div.</p> <p>Ok then, let’s get back to our question, why are we setting the value property in our <code>Theme.Provider</code> component if we already set a <em>default value</em> in our <code>theme.js</code> file, here:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// theme.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">'light'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ThemeContext<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Well, the default value above won’t be used if we declare a <code>Provider</code>. If we are missing a <code>Provider</code> component, however, it will use the <em>default value</em> as a fallback. So the following code will output <code>dark</code> as value, which is the value we give to the <code>Provider</code>:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">Sample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Provider</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>dark<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token punctuation">{</span><span class="token parameter">theme</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Theme value: </span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
 </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Provider</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>whereas this code will output <code>light</code> as value, e.g the <em>default value</em>:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Sample.js with a Provider missing</span>

<span class="token keyword">const</span> <span class="token function-variable function">Sample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
 </span><span class="token punctuation">{</span><span class="token parameter">theme</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Theme value: </span><span class="token punctuation">{</span>theme<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
 </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h3> <p>Taking our <code>Context</code> for a spin means we need to create a <code>Provider</code> and a <code>Consumer</code> as we did in the last section, however, most likely the <code>Consumer</code> part is baked into a Component like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// ThemedButton.js</span>
<span class="token keyword">import</span> Theme <span class="token keyword">from</span> <span class="token string">'theme.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ThemedButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

  </span><span class="token punctuation">{</span><span class="token parameter">theme</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>button <span class="token punctuation">{</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token operator">&gt;</span>button <span class="token keyword">with</span> them<span class="token punctuation">:</span> <span class="token punctuation">{</span>theme<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">

</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Consumer</span></span><span class="token punctuation">&gt;</span></span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ThemedButton
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>This means that our code from the last section can be cleaned up somewhat to look like this:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Sample.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Theme <span class="token keyword">from</span> <span class="token string">'./theme'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ThemedButton <span class="token keyword">from</span> <span class="token string">'./ThemedButton'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Sample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Theme.Provider</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>dark<span class="token punctuation">'</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemedButton</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Provider</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Sample<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>As you can see the value from the <code>Provider</code> is being passed down through the <code>props</code> and we can inside of the <code>ThemedButton</code> component access the <code>theme</code> property through the <code>Consumer</code>.</p> <h2 id="dynamic-context"><a href="#dynamic-context" aria-hidden="true" class="header-anchor">#</a> Dynamic Context</h2> <p>What if we want to change the provider value? One way of doing that is by having a <em>dynamic context</em>. We can achieve that by placing our <code>Provider</code> inside of a component and let its value depend on the component state like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// AnyComponent.js</span>
 <span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AnyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>  
    theme<span class="token punctuation">:</span> <span class="token string">'dark'</span>  
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

 <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme <span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
     </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemedButton</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Now it’s easy for us to change the state and thereby we can change the value the <code>Provider</code> is providing to any <code>Consumer</code>.</p> <h3 id="changing-the-state-example"><a href="#changing-the-state-example" aria-hidden="true" class="header-anchor">#</a> Changing the state example</h3> <p>Below we are creating a component containing a droplist with two different values <code>light</code> and <code>dark</code> and when we switch between the values, the state is altered and because the state is connected to the <code>Provider</code>, the provided value is changed with it.</p> <p>Let’ look at the code:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// AnyComponent.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Theme <span class="token keyword">from</span> <span class="token string">'./theme'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ThemedButton <span class="token keyword">from</span> <span class="token string">'./ThemedButton'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AnyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>  
    theme<span class="token punctuation">:</span> <span class="token string">'dark'</span><span class="token punctuation">,</span>  
    themes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'light'</span><span class="token punctuation">,</span> <span class="token string">'dark'</span><span class="token punctuation">]</span>  
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function-variable function">handleSelect</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Changing value to '</span> <span class="token operator">+</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
      theme<span class="token punctuation">:</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value  
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Any component</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      &lt;select value = </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">}</span><span class="token plain-text"> 
       onChange =</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSelect<span class="token punctuation">}</span><span class="token plain-text">&gt; 
      </span><span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>themes<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">t</span> <span class="token operator">=&gt;</span> 
      <span class="token operator">&lt;</span>option value <span class="token operator">=</span> <span class="token punctuation">{</span>t<span class="token punctuation">}</span> <span class="token operator">&gt;</span><span class="token punctuation">{</span>t<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      Selected theme: </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">}</span><span class="token plain-text"> 
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      &lt;Theme.Provider value =</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">}</span><span class="token plain-text">&gt;
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemedButton</span></span> <span class="token attr-name">theme</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Theme.Provider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> AnyComponent<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>We can see from the above code that when the <code>onChange</code> event is triggered we invoke the <code>handleSelect()</code> method and that leads to the state property <code>theme</code> being updated. That same property theme is what the <code>Theme.Provider</code> is assigning as its <code>value</code> attribute. Thereby a change in the droplist leads to the <code>Provider</code> component providing a new value. A fairly simple code flow but it does show where we should change things to get the Consumer component to display a new value.</p> <h3 id="second-example-—-a-cart"><a href="#second-example-—-a-cart" aria-hidden="true" class="header-anchor">#</a> Second example — a cart</h3> <p>Our next example is a little bit different. We have seen how we can expose a value from a components state and make that the value of the <code>Provider</code> component and thereby we can affect what the Provider provides. This can be taken to a further level. Further in the sense that we can not only expose the value of a Provider to a Consumer but also methods, methods that will allow us to change the provided value. Let’s look at some code for this:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// cart.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> CartContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
 cart<span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token number">0</span><span class="token punctuation">,</span>
 <span class="token function-variable function">addItem</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> CartContext<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>We start with creating our <code>Context</code> object and this time we give it a more complex data type than a string or a number. The input parameter to <code>createContext()</code> method is an object <code>{}</code> with a property <code>cart</code>.</p> <p>A note <code>void 0</code> is just the same as <code>undefined</code>.</p> <p>Next, we will create two different components:</p> <ul><li><strong>CartPage</strong>, this will contain our Consumer component and thereby display the value from our <code>Context</code> object</li> <li><strong>CartProvider</strong>, this will be a component that will not only provide the value from the <code>Context</code> object but also expose a method with which we can change the provided value</li></ul> <p>Let’s start with <code>CartPage</code> component:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// CartPage.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CartContext <span class="token keyword">from</span> <span class="token string">'./cart'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> products <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
 id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
 title<span class="token punctuation">:</span> <span class="token string">'Fortnite'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
 id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
 title<span class="token punctuation">:</span> <span class="token string">'Doom'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
 id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
 title<span class="token punctuation">:</span> <span class="token string">'Quake'</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> <span class="token function-variable function">CartPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartContext.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
 </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> cart<span class="token punctuation">,</span> addItem <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Product list</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token punctuation">{</span>products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">addItem</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>p<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>p<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token plain-text"> . </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
     </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Cart</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
     </span><span class="token punctuation">{</span>cart<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
   </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
 </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">&gt;</span></span>
 <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
 </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">CartContext.Consumer</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> CartPage<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>We see above that we use <code>CartContext</code> component and that we define and display our cart value, but there is an addition to it in the form of the <code>addItem()</code> method. This method will allow us to change the cart item, but how you ask? Let’s have a look at our <code>CartProvider</code> component next to find out the answer:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CartPage <span class="token keyword">from</span> <span class="token string">'./CartPage'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CartContext <span class="token keyword">from</span> <span class="token string">'./cart'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CartProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      cart<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token function-variable function">addItem</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
          cart<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>this<span class="token punctuation">.</span>state<span class="token punctuation">.</span>cart<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>item <span class="token punctuation">}</span><span class="token punctuation">]</span>  
        <span class="token punctuation">}</span><span class="token punctuation">)</span>  
      <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>CartContext<span class="token punctuation">.</span>Provider value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">}</span> <span class="token operator">&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartPage</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">CartContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> CartProvider<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>We can see here that the state object consists of the properties <code>cart</code> and <code>addItem</code> and what gets passed into the value property of the <code>CartContext.Provider</code>is this.state e.g both <code>cart</code> and <code>addItem()</code>. This means we could easily expand this with a <code>removeItem()</code> function or whatever we need, this is how we get more than just a value exposed to a <code>Consumer</code> component.</p> <h2 id="higher-order-component"><a href="#higher-order-component" aria-hidden="true" class="header-anchor">#</a> Higher order component</h2> <p>Sometimes a context needs to be provided in many places. In our example above imagine the <code>cart</code> being used inside of a header that wants to show how many items you have in a cart. There might also be dedicated Cart Page where you can see the cart content more in detail. It might get tedious to have to wrap all those component content in a <code>Consumer</code> tag. For those situations, it’s better to use a HOC, a higher order component. This means we can create a function where we use our component as input and we augment the context data.</p> <p>It can look like the following:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// withCart.js</span>
<span class="token keyword">import</span> CartContext <span class="token keyword">from</span> <span class="token string">'./cart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">withCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartContext.Consumer</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
     </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">context</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
     </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">CartContext.Consumer</span></span><span class="token punctuation">&gt;</span></span>
   <span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>As you can see above, we are using a <code>Consumer</code> to make this happen but we also use the spread parameter <code>{ ...context}</code> to transfer what is in the context object to the underlying component. Now we can easily use this function to decorate our component, like so:</p> <div class="language-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// Header.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> withCart <span class="token keyword">from</span> <span class="token string">'./withCart'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Header</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> cart <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token punctuation">{</span>cart<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token operator">?</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Empty cart</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">:</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Items in cart: (</span><span class="token punctuation">{</span>cart<span class="token punctuation">.</span>length<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">const</span> HeaderWithCart <span class="token operator">=</span> <span class="token function">withCart</span><span class="token punctuation">(</span>Header<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> HeaderWithCart<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>In this article, we have covered quite a lot. We have explained what the <code>Context</code> API is and when to use it. We also talked about its building blocks <code>Provider</code> and <code>Consumer</code>. Furthermore, we have covered how to update provided values and lastly how we can clean up a bit using a HOC, a higher order component. Hopefully, you have found this useful. 😃</p> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b3d08b1f.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/144.610d3a75.js" defer></script>
  </body>
</html>
