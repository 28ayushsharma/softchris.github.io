<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Learn Durable Functions with .NET Core and C#, stateful Serverless</title>
    <meta name="description" content="[object Object]">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.5ae3c088.css" as="style"><link rel="preload" href="/assets/js/app.e3a22685.js" as="script"><link rel="preload" href="/assets/js/9.454b5262.js" as="script"><link rel="preload" href="/assets/js/4.eac68367.js" as="script"><link rel="preload" href="/assets/js/150.b4ba556a.js" as="script"><link rel="prefetch" href="/assets/js/1.36663999.js"><link rel="prefetch" href="/assets/js/10.dd884694.js"><link rel="prefetch" href="/assets/js/100.f7776fae.js"><link rel="prefetch" href="/assets/js/101.83c4ff25.js"><link rel="prefetch" href="/assets/js/102.d3a51c53.js"><link rel="prefetch" href="/assets/js/103.e4fd7175.js"><link rel="prefetch" href="/assets/js/104.3f860f10.js"><link rel="prefetch" href="/assets/js/105.5e05c250.js"><link rel="prefetch" href="/assets/js/106.d1698fcc.js"><link rel="prefetch" href="/assets/js/107.39206cda.js"><link rel="prefetch" href="/assets/js/108.b717e412.js"><link rel="prefetch" href="/assets/js/109.a0275c41.js"><link rel="prefetch" href="/assets/js/11.e44a9c79.js"><link rel="prefetch" href="/assets/js/110.acd428a7.js"><link rel="prefetch" href="/assets/js/111.85c1f355.js"><link rel="prefetch" href="/assets/js/112.877451fc.js"><link rel="prefetch" href="/assets/js/113.0c756607.js"><link rel="prefetch" href="/assets/js/114.2dcc568f.js"><link rel="prefetch" href="/assets/js/115.2ee55351.js"><link rel="prefetch" href="/assets/js/116.4c7211b0.js"><link rel="prefetch" href="/assets/js/117.3fa386ab.js"><link rel="prefetch" href="/assets/js/118.8bd003cb.js"><link rel="prefetch" href="/assets/js/119.eee9a7e2.js"><link rel="prefetch" href="/assets/js/12.02e6e552.js"><link rel="prefetch" href="/assets/js/120.d8458857.js"><link rel="prefetch" href="/assets/js/121.d06bb8bc.js"><link rel="prefetch" href="/assets/js/122.ad0893bf.js"><link rel="prefetch" href="/assets/js/123.37bf1483.js"><link rel="prefetch" href="/assets/js/124.92ff020a.js"><link rel="prefetch" href="/assets/js/125.88e1d9ef.js"><link rel="prefetch" href="/assets/js/126.dc6e1538.js"><link rel="prefetch" href="/assets/js/127.1a4d6785.js"><link rel="prefetch" href="/assets/js/128.4387dd5e.js"><link rel="prefetch" href="/assets/js/129.57ea763a.js"><link rel="prefetch" href="/assets/js/13.215ad842.js"><link rel="prefetch" href="/assets/js/130.58e7dbf8.js"><link rel="prefetch" href="/assets/js/131.42d28338.js"><link rel="prefetch" href="/assets/js/132.d36de42a.js"><link rel="prefetch" href="/assets/js/133.f30adb75.js"><link rel="prefetch" href="/assets/js/134.31f31974.js"><link rel="prefetch" href="/assets/js/135.28ac6845.js"><link rel="prefetch" href="/assets/js/136.fa8c6434.js"><link rel="prefetch" href="/assets/js/137.e5700d8f.js"><link rel="prefetch" href="/assets/js/138.7a324443.js"><link rel="prefetch" href="/assets/js/139.2f7c0a4b.js"><link rel="prefetch" href="/assets/js/14.1a060010.js"><link rel="prefetch" href="/assets/js/140.b91b86f6.js"><link rel="prefetch" href="/assets/js/141.96580e9a.js"><link rel="prefetch" href="/assets/js/142.0a5ba9b1.js"><link rel="prefetch" href="/assets/js/143.c459fa93.js"><link rel="prefetch" href="/assets/js/144.6c70d423.js"><link rel="prefetch" href="/assets/js/145.bb0bf891.js"><link rel="prefetch" href="/assets/js/146.6f256034.js"><link rel="prefetch" href="/assets/js/147.49ca51ce.js"><link rel="prefetch" href="/assets/js/148.2ab13d25.js"><link rel="prefetch" href="/assets/js/149.a33263c4.js"><link rel="prefetch" href="/assets/js/15.34674cd6.js"><link rel="prefetch" href="/assets/js/151.5a70a140.js"><link rel="prefetch" href="/assets/js/152.1069f6c2.js"><link rel="prefetch" href="/assets/js/153.ecd63d9d.js"><link rel="prefetch" href="/assets/js/154.65c33956.js"><link rel="prefetch" href="/assets/js/155.6c1cd07d.js"><link rel="prefetch" href="/assets/js/156.cb9f8044.js"><link rel="prefetch" href="/assets/js/157.f967f5fd.js"><link rel="prefetch" href="/assets/js/158.1ea63677.js"><link rel="prefetch" href="/assets/js/159.6e55156d.js"><link rel="prefetch" href="/assets/js/16.119e91d4.js"><link rel="prefetch" href="/assets/js/160.88cccab3.js"><link rel="prefetch" href="/assets/js/161.71318bd8.js"><link rel="prefetch" href="/assets/js/162.c8cea25d.js"><link rel="prefetch" href="/assets/js/163.a7833ee3.js"><link rel="prefetch" href="/assets/js/164.ea1e3d74.js"><link rel="prefetch" href="/assets/js/165.e9a99c14.js"><link rel="prefetch" href="/assets/js/166.f2e26ff9.js"><link rel="prefetch" href="/assets/js/167.6a4d1f51.js"><link rel="prefetch" href="/assets/js/168.c58bc120.js"><link rel="prefetch" href="/assets/js/169.eae6e4e5.js"><link rel="prefetch" href="/assets/js/17.780050f1.js"><link rel="prefetch" href="/assets/js/170.cf5fa6a3.js"><link rel="prefetch" href="/assets/js/171.f0dd0748.js"><link rel="prefetch" href="/assets/js/172.5909c6a2.js"><link rel="prefetch" href="/assets/js/173.0682325b.js"><link rel="prefetch" href="/assets/js/174.8b371e6b.js"><link rel="prefetch" href="/assets/js/175.bdf4d597.js"><link rel="prefetch" href="/assets/js/176.5925b373.js"><link rel="prefetch" href="/assets/js/177.f678005e.js"><link rel="prefetch" href="/assets/js/178.91a77396.js"><link rel="prefetch" href="/assets/js/179.245c4e4c.js"><link rel="prefetch" href="/assets/js/18.6ebceaf1.js"><link rel="prefetch" href="/assets/js/180.aedfb4ca.js"><link rel="prefetch" href="/assets/js/181.d284539a.js"><link rel="prefetch" href="/assets/js/182.4fd4793b.js"><link rel="prefetch" href="/assets/js/183.06ee29e0.js"><link rel="prefetch" href="/assets/js/184.5493ba8e.js"><link rel="prefetch" href="/assets/js/185.6ffaf117.js"><link rel="prefetch" href="/assets/js/186.40ce91dd.js"><link rel="prefetch" href="/assets/js/187.3f8498e2.js"><link rel="prefetch" href="/assets/js/188.62070c23.js"><link rel="prefetch" href="/assets/js/189.10a10400.js"><link rel="prefetch" href="/assets/js/19.910fc8d0.js"><link rel="prefetch" href="/assets/js/190.f28d6eb5.js"><link rel="prefetch" href="/assets/js/191.846582fc.js"><link rel="prefetch" href="/assets/js/192.9904f081.js"><link rel="prefetch" href="/assets/js/193.e9a4d1b1.js"><link rel="prefetch" href="/assets/js/194.f93671b1.js"><link rel="prefetch" href="/assets/js/195.7c4863b9.js"><link rel="prefetch" href="/assets/js/196.3175eb48.js"><link rel="prefetch" href="/assets/js/197.29d26ccf.js"><link rel="prefetch" href="/assets/js/198.0402c523.js"><link rel="prefetch" href="/assets/js/199.44b5e9aa.js"><link rel="prefetch" href="/assets/js/20.f2e93d17.js"><link rel="prefetch" href="/assets/js/200.d226b6ae.js"><link rel="prefetch" href="/assets/js/201.043fccbf.js"><link rel="prefetch" href="/assets/js/202.29dec5af.js"><link rel="prefetch" href="/assets/js/203.c72e7565.js"><link rel="prefetch" href="/assets/js/21.710dadb0.js"><link rel="prefetch" href="/assets/js/22.f4b7a74b.js"><link rel="prefetch" href="/assets/js/23.fa51555f.js"><link rel="prefetch" href="/assets/js/24.95c29410.js"><link rel="prefetch" href="/assets/js/25.a9fce161.js"><link rel="prefetch" href="/assets/js/26.8b31cf1a.js"><link rel="prefetch" href="/assets/js/27.4cf46a26.js"><link rel="prefetch" href="/assets/js/28.21397a71.js"><link rel="prefetch" href="/assets/js/29.ef58c202.js"><link rel="prefetch" href="/assets/js/3.970a66a4.js"><link rel="prefetch" href="/assets/js/30.4fc73e4a.js"><link rel="prefetch" href="/assets/js/31.b2211550.js"><link rel="prefetch" href="/assets/js/32.f2e286bb.js"><link rel="prefetch" href="/assets/js/33.aec83ce9.js"><link rel="prefetch" href="/assets/js/34.9e368969.js"><link rel="prefetch" href="/assets/js/35.ccde8210.js"><link rel="prefetch" href="/assets/js/36.561677ad.js"><link rel="prefetch" href="/assets/js/37.59283e16.js"><link rel="prefetch" href="/assets/js/38.8d764594.js"><link rel="prefetch" href="/assets/js/39.94b70e03.js"><link rel="prefetch" href="/assets/js/40.ee22aa00.js"><link rel="prefetch" href="/assets/js/41.accb996e.js"><link rel="prefetch" href="/assets/js/42.dcae85a4.js"><link rel="prefetch" href="/assets/js/43.ec66ae23.js"><link rel="prefetch" href="/assets/js/44.6fc9906e.js"><link rel="prefetch" href="/assets/js/45.be8d4fd7.js"><link rel="prefetch" href="/assets/js/46.9edeab5a.js"><link rel="prefetch" href="/assets/js/47.fb12d4b7.js"><link rel="prefetch" href="/assets/js/48.52640be3.js"><link rel="prefetch" href="/assets/js/49.33d9d0c4.js"><link rel="prefetch" href="/assets/js/5.d1da013e.js"><link rel="prefetch" href="/assets/js/50.13c266ab.js"><link rel="prefetch" href="/assets/js/51.51580cbc.js"><link rel="prefetch" href="/assets/js/52.5c6157b8.js"><link rel="prefetch" href="/assets/js/53.df1e6c41.js"><link rel="prefetch" href="/assets/js/54.eb903e59.js"><link rel="prefetch" href="/assets/js/55.eb47d641.js"><link rel="prefetch" href="/assets/js/56.8246b35d.js"><link rel="prefetch" href="/assets/js/57.e6f2d2ce.js"><link rel="prefetch" href="/assets/js/58.f7fff5bb.js"><link rel="prefetch" href="/assets/js/59.1e33c33c.js"><link rel="prefetch" href="/assets/js/6.9bdf2d86.js"><link rel="prefetch" href="/assets/js/60.67ca9192.js"><link rel="prefetch" href="/assets/js/61.028819ef.js"><link rel="prefetch" href="/assets/js/62.9b98c3b5.js"><link rel="prefetch" href="/assets/js/63.efc8f547.js"><link rel="prefetch" href="/assets/js/64.ecda83e6.js"><link rel="prefetch" href="/assets/js/65.a5e5b25b.js"><link rel="prefetch" href="/assets/js/66.2e6b6c8e.js"><link rel="prefetch" href="/assets/js/67.09614dba.js"><link rel="prefetch" href="/assets/js/68.8d40a19e.js"><link rel="prefetch" href="/assets/js/69.76c62200.js"><link rel="prefetch" href="/assets/js/7.9ac2367b.js"><link rel="prefetch" href="/assets/js/70.8f3a0f45.js"><link rel="prefetch" href="/assets/js/71.4d8bdcb1.js"><link rel="prefetch" href="/assets/js/72.e816ed3a.js"><link rel="prefetch" href="/assets/js/73.d791feee.js"><link rel="prefetch" href="/assets/js/74.073c9d53.js"><link rel="prefetch" href="/assets/js/75.89cad8df.js"><link rel="prefetch" href="/assets/js/76.232ad0b0.js"><link rel="prefetch" href="/assets/js/77.49a534d4.js"><link rel="prefetch" href="/assets/js/78.134a5d5e.js"><link rel="prefetch" href="/assets/js/79.6ca3cd68.js"><link rel="prefetch" href="/assets/js/8.6b13a443.js"><link rel="prefetch" href="/assets/js/80.b733d6fd.js"><link rel="prefetch" href="/assets/js/81.4b4b8b2f.js"><link rel="prefetch" href="/assets/js/82.b53dae89.js"><link rel="prefetch" href="/assets/js/83.38d82ae3.js"><link rel="prefetch" href="/assets/js/84.7a0b2839.js"><link rel="prefetch" href="/assets/js/85.569d3ef1.js"><link rel="prefetch" href="/assets/js/86.f7c2d0fe.js"><link rel="prefetch" href="/assets/js/87.badf9ea1.js"><link rel="prefetch" href="/assets/js/88.4904c176.js"><link rel="prefetch" href="/assets/js/89.14501534.js"><link rel="prefetch" href="/assets/js/90.9f31e266.js"><link rel="prefetch" href="/assets/js/91.cd9f26cc.js"><link rel="prefetch" href="/assets/js/92.f68b9b5c.js"><link rel="prefetch" href="/assets/js/93.c0237329.js"><link rel="prefetch" href="/assets/js/94.87777679.js"><link rel="prefetch" href="/assets/js/95.7deabe56.js"><link rel="prefetch" href="/assets/js/96.8ac1aaf0.js"><link rel="prefetch" href="/assets/js/97.0ad4d44e.js"><link rel="prefetch" href="/assets/js/98.6406ef0c.js"><link rel="prefetch" href="/assets/js/99.9fedc5bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ae3c088.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Learn Durable Functions with .NET Core and C#, stateful Serverless</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/dotnet-durable.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/dotnet-durable.html#creating-our-project" class="sidebar-link">Creating our project</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-durable.html#orchestrator" class="sidebar-link">Orchestrator</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-durable.html#orchestration-hello" class="sidebar-link">Orchestration_Hello</a></li><li class="sidebar-sub-header"><a href="/pages/dotnet-durable.html#httpstart-response" class="sidebar-link">HttpStart response</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="learn-durable-functions-with-net-core-and-c-stateful-serverless"><a href="#learn-durable-functions-with-net-core-and-c-stateful-serverless" aria-hidden="true" class="header-anchor">#</a> Learn Durable Functions with .NET Core and C#, stateful Serverless</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/hghuwapkotgu4eznvvut.png" alt=""></p> <blockquote><p>Durable Functions are an extension of Azure Functions that lets you write stateful functions in a serverless environment. Durable functions manage state, checkpoints, and restarts for you.</p></blockquote> <p>What does that even mean you ask?</p> <p>It means you can have long-running functions like long-running functions. It also has a state which means it remembers where it is, like a workflow.</p> <p>How about this. Imagine you have a situation where:</p> <blockquote><p>you need to manage something by dividing it up in different checkpoints. Each checkpoint is one step closer for it to be considered handled. More concretely imagine a game for example where you need to load a bunch of different resources and only when everything is loaded and ready are you able to play the game.</p></blockquote> <blockquote><p>Oh, ok, so it's like a workflow framework</p></blockquote> <p>Yes exactly, it enables you to specify how something should be executed through a flow. There are even different architectural patterns that are recommended for different flows.</p> <blockquote><p>Sounds like that could be expensive, is it?</p></blockquote> <p>No not really, the payment model is close to the one Azure Functions use, only pay for when the functions/ workflow is executing.</p> <blockquote><p>Sounds great, tell me more</p></blockquote> <p>In this article we will cover:</p> <ul><li><strong>What are Durable functions</strong>, let's talk through what it is and what the central concepts are</li> <li><strong>How it works</strong>, we will explain a little bit of how it works
Resources, we will give out some resources so you can delve further in</li> <li><strong>Lab</strong>, we will code through an example, so you see the major concepts in use and what happens when</li></ul> <p>## Concepts and high-level explanation</p> <p>There are some concepts we need to know about when dealing with durable functions. All concepts play a role that together enables us to run our durable function.</p> <ul><li><strong>Orchestrator function</strong>, this is a function where we define the workflow, we set up what should happen in the workflow, what activities to carry out and what happens when it's done</li> <li><strong>Activity function</strong>, Activity functions are the basic unit of work in a durable function orchestration. Activity functions are the functions and tasks that are orchestrated in the process. You can have as many activity functions as you want. Make sure to give them descriptive names that represent steps in your flow</li> <li><strong>Client functions</strong>, Client functions are the triggered functions that create new instances of an orchestration. Client functions are the entry point for creating an instance of a Durable Functions orchestration</li></ul> <blockquote><p>Ok, I think I got but can you maybe explain it a bit more?</p></blockquote> <p>Sure, the best way to explain it is through a realistic example and an image. So let's talk about <em>order processing</em>. In order processing we imagine we have the following tasks to carry out:</p> <ol><li>Checking the inventory,</li> <li>Charging the customer,</li> <li>Creating a shipment</li> <li>Given that we know how an order is processed let's show you that image so you get a feeling for the workflow:</li></ol> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/eg639o5aybec4vokancw.png" alt="Order processing"></p> <p>Ok, above we see how a client function is being invoked. In the case of an order being created, this typically is an HTTP endpoint we hit from an application. The next thing to happen is that the client's function starts an instance of an orchestration. This means we will get an <code>instance id</code>, our unique reference to that specific flow. The next thing to happen is that we try to carry out everything inside of the orchestration like <code>checking the inventory</code>, <code>charging the customer</code> and <code>creating a shipment</code>.</p> <p>How it works
Let's talk a bit more about how this technically works. The thing with the orchestration is that what it orchestrates usually is asynchronous which means we don't know exactly when something finishes. To avoid that you pay running costs for it durable functions powers down and saves the state.</p> <p>When an orchestration function is given more work to do (for example, a response message is received or a durable timer expires), the orchestrator wakes up and re-executes the entire function from the start to rebuild the local state.</p> <blockquote><p>wait, re-running everything?</p></blockquote> <p>No worries, during the replay, if the code tries to call a function (or do any other async work), the Durable Task Framework consults the execution history of the current orchestration. If it finds that the activity function has already executed and yielded a result, it replays that function's result, and the orchestrator code continues to run.</p> <blockquote><p>Oh ok, that sounds better</p></blockquote> <p>Replay continues until the function code is finished or until it has scheduled new async work</p> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <ul><li><a href="https://azure.microsoft.com/en-gb/free/?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">Free account Azure account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> You will need to sign up on Azure to use Durable Functions</li> <li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/quickstart-js-vscode?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">Creating your first durable function with JavaScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Quickstart that takes you through creating a durable function</li> <li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-concepts?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">Durable functions concepts<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Read more here on concepts and patterns and how to implement said patterns.</li> <li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/durable/durable-functions-checkpointing-and-replay#orchestrator-code-constraints?wt.mc_id=devto-blog-chnoring" target="_blank" rel="noopener noreferrer">Orchestrator function constraints<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Constraints you need to be aware of.</li></ul> <p>## Lab - simple activity flow</p> <p>We believe the best way to learn is to build something with it. So how do we do it? Well, it's quite simple. Using VS Code we can install a plugin making this process really easy.</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/z6twu7tn3q3yyvejy6ug.png" alt=""></p> <h3 id="creating-our-project"><a href="#creating-our-project" aria-hidden="true" class="header-anchor">#</a> Creating our project</h3> <p>Open up the command palette or type <code>COMMAND + SHIFT + P</code>.</p> <p>Then we select the following, to create a new project</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/07e3b91mhymqih0kd51z.png" alt=""></p> <p>This is followed by us selecting a language, let's take <code>C#</code>. Then we are faced with this list of choices:</p> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/27d37tt20huw5bde3vhz.png" alt=""></p> <p>Select <code>Durable Functions Orchestration</code>, next name your function.</p> <p>You will next be asked to select a storage account, you will need to select <code>Subscription</code>, <code>Storage account</code> and <code>Resource group</code>. The reason for this is that when you save the state of your function it needs to be saved somewhere for later recovery.</p> <p>Your project should now look like this:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>-<span class="token operator">|</span> obj/
-<span class="token operator">|</span> bin/
-<span class="token operator">|</span> .gitignore
-<span class="token operator">|</span> <span class="token operator">&lt;</span>name of directory<span class="token operator">&gt;</span>.csproj
-<span class="token operator">|</span> local.settings.json
-<span class="token operator">|</span> Orchestration.cs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Let's take a closer look at <code>Orchestration.cs</code>:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">using</span> System<span class="token punctuation">.</span>Collections<span class="token punctuation">.</span>Generic<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>DurableTask<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Azure<span class="token punctuation">.</span>WebJobs<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Http<span class="token punctuation">;</span>
<span class="token keyword">using</span> Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>Logging<span class="token punctuation">;</span>

<span class="token keyword">namespace</span> Company<span class="token punctuation">.</span>Function
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Orchestration</span>
    <span class="token punctuation">{</span>
        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;&gt;</span> <span class="token function">RunOrchestrator</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token class-name">OrchestrationTrigger</span><span class="token punctuation">]</span> <span class="token class-name">IDurableOrchestrationContext</span> context<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">var</span> outputs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Replace &quot;hello&quot; with the name of your Durable Activity Function.</span>
            outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tokyo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Seattle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;London&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// returns [&quot;Hello Tokyo!&quot;, &quot;Hello Seattle!&quot;, &quot;Hello London!&quot;]</span>
            <span class="token keyword">return</span> outputs<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">string</span> <span class="token function">SayHello</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">ActivityTrigger</span><span class="token punctuation">]</span> <span class="token keyword">string</span> name<span class="token punctuation">,</span> <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span>$<span class="token string">&quot;Saying hello to {name}.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> $<span class="token string">&quot;Hello {name}!&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_HttpStart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">&gt;</span> <span class="token function">HttpStart</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Anonymous<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequestMessage</span> req<span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token class-name">DurableClient</span><span class="token punctuation">]</span> <span class="token class-name">IDurableOrchestrationClient</span> starter<span class="token punctuation">,</span>
            <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Function input comes from the request content.</span>
            <span class="token keyword">string</span> instanceId <span class="token operator">=</span> <span class="token keyword">await</span> starter<span class="token punctuation">.</span><span class="token function">StartNewAsync</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span>$<span class="token string">&quot;Started orchestration with ID = '{instanceId}'.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">return</span> starter<span class="token punctuation">.</span><span class="token function">CreateCheckStatusResponse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> instanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>Above you can see how three functions have been generated for you when you created the project. Every function has been decorated with <code>FunctionName(&quot;&lt;name of function&gt;&quot;)</code> decorator. This is how the runtime knows what these functions are and can generate endpoints from it, among other things.</p> <p>### Explaining the artifacts</p> <p>Ok, so we created three distinct functions or artifacts, an <code>orchestrator function</code>, an <code>HTTP start/client function</code>, and an <code>activity function</code>. How does this all work?</p> <p>Well, it all starts with a <code>HttpStart</code> function that kicks everything off. Then said function kicks off the Orchestrator that in turn starts the Activity functions specified in the orchestrator. Sounds a bit theoretical but let's dive into each of these artifacts and see what happens in the code.</p> <p>### HttpStart</p> <p>As mentioned above, this is the function that starts it all. Let's have a look at its source code and discuss what's happening:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_HttpStart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>HttpResponseMessage<span class="token operator">&gt;</span> <span class="token function">HttpStart</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token class-name">HttpTrigger</span><span class="token punctuation">(</span>AuthorizationLevel<span class="token punctuation">.</span>Anonymous<span class="token punctuation">,</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token class-name">HttpRequestMessage</span> req<span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token class-name">DurableClient</span><span class="token punctuation">]</span> <span class="token class-name">IDurableOrchestrationClient</span> starter<span class="token punctuation">,</span>
   <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// Function input comes from the request content.</span>
  <span class="token keyword">string</span> instanceId <span class="token operator">=</span> <span class="token keyword">await</span> starter<span class="token punctuation">.</span><span class="token function">StartNewAsync</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span>$<span class="token string">&quot;Started orchestration with ID = '{instanceId}'.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> starter<span class="token punctuation">.</span><span class="token function">CreateCheckStatusResponse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> instanceId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>We can see above that we have three input parameters:</p> <ul><li><strong>req</strong>, of type <code>IHttpRequestMessage</code>, this is the incoming web request. Note how this parameter has the HttpTrigger decorator with two input params, AuthorizationLevel, and the strings &quot;get&quot; and &quot;post&quot;. This instructs this method to listen to WebRequests using the HTTP verbs GET and POST.</li> <li><strong>starter</strong>, of type <code>IDurableOrchestrationClient</code>, this is the client that allows us to control the general flow.</li> <li><strong>log</strong>, of type <code>ILogger</code>, this instance lets us log different messages that can be subscribed to by Azure and will also be visible in the terminal while developing our project.</li></ul> <p>Next up our starter instance calls <code>StartNewAsync()</code> which produces an <code>instanceId</code>. The <code>instanceId</code> is a reference or handler to this specific function invocation. It doesn't matter so much for this demo but for the second one we will use that information.
The last thing to happen is that we create an HTTP response by calling <code>CreateCheckStatusResponse()</code>.</p> <h3 id="orchestrator"><a href="#orchestrator" aria-hidden="true" class="header-anchor">#</a> Orchestrator</h3> <p>Let's look at the Orchestrator next. This is where all the interesting things are happening, this is where we set up our flow, what function to be called when and why. Let's look at the code:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">&gt;&gt;</span> <span class="token function">RunOrchestrator</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token class-name">OrchestrationTrigger</span><span class="token punctuation">]</span> <span class="token class-name">IDurableOrchestrationContext</span> context<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">var</span> outputs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Replace &quot;hello&quot; with the name of your Durable Activity Function.</span>
  outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tokyo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Seattle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;London&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// returns [&quot;Hello Tokyo!&quot;, &quot;Hello Seattle!&quot;, &quot;Hello London!&quot;]</span>
  <span class="token keyword">return</span> outputs<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>The first thing we see that we have a method <code>FunctionName(&quot;Orchestration&quot;)</code>. We have an input parameter context of type <code>IDurableOrchestrationContext</code>. This parameter has the capability of controlling the flow but also call helpers but also activity functions, which do the heavy lifting. When context calls <code>CallActivitySync()</code> it does just that, it calls an activity function with the name <code>Orchestration_Hello</code> and pass it a string.</p> <h3 id="orchestration-hello"><a href="#orchestration-hello" aria-hidden="true" class="header-anchor">#</a> Orchestration_Hello</h3> <p>Next up we have an activity function. This is where we carry out all the heavy lifting.</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">FunctionName</span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">string</span> <span class="token function">SayHello</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">ActivityTrigger</span><span class="token punctuation">]</span> <span class="token keyword">string</span> name<span class="token punctuation">,</span> <span class="token class-name">ILogger</span> log<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">LogInformation</span><span class="token punctuation">(</span>$<span class="token string">&quot;Saying hello to {name}.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> $<span class="token string">&quot;Hello {name}!&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>We see that it returns straight away but it could be a long-running activity. The point is whether it runs in a millisecond or takes some time, it doesn't matter, the orchestration function still must wait for it to conclude. Imagine this function can do a lot more, like talking to a database or do an HTTP request.</p> <p>### Debugging</p> <p>You may think you understand everything up to this point, but it really clicks when you see a debugging flow happening. So that's what we are going to be doing next, we are going to start up our durable function from VS Code and you will be able to see how the breakpoints hit and when.</p> <p>Now we are ready to debug so let's hit <em>debug</em> by going to <code>Run/ Start</code> Debugging in the VS Code menu.</p> <p>We should be getting something like this printed in the terminal:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Http Functions:
  Orchestration_HttpStart: <span class="token punctuation">[</span>GET,POST<span class="token punctuation">]</span> http://localhost:7071/api/Orchestration_HttpStart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Next thing we need to do is to kick everything off by hitting our client function route as indicated above <code>http://localhost:7071/api/Orchestration_HttpStart</code>. We need to start the whole thing by calling the mentioned URL.</p> <ol><li>The first thing to happen is our HttpStart function being hit:</li></ol> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/zq8agxqp2xkj0qhh4nf7.png" alt="Http Start breakpoint"></p> <p>We let the debugger advance.</p> <ol start="2"><li>Next, the <code>Orchestration function</code> is being hit.</li></ol> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/y0w68bw1wscdn9ln0l3w.png" alt="Orchestration"></p> <p>Next up we advance to the next breakpoint and we see that our activity.</p> <ol start="3"><li>Next, the function <code>Orchestration_Hello</code> is being hit next.</li></ol> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/kkksnusrkm9butr5ik0y.png" alt="Activity function breakpoint"></p> <ol start="4"><li>We advanced the breakpoint and we find ourselves being back in the orchestration function.</li></ol> <p><img src="https://dev-to-uploads.s3.amazonaws.com/i/y8rdbivktyms5h9vm5sl.png" alt="Back in orchestrator"></p> <p>As you can see it will keep going like this between activity function and orchestrator until orchestrator is done.</p> <h3 id="httpstart-response"><a href="#httpstart-response" aria-hidden="true" class="header-anchor">#</a> HttpStart response</h3> <p>In our browser, we end up coming to a page like this which is the HTTP response from the method called <code>HttpStart</code>.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// 20200721125052</span>
<span class="token comment">// http://localhost:7071/api/Orchestration_HttpStart</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;151c37c2bbc14f659ffb0a4d3ed9e54e&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;statusQueryGetUri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:7071/runtime/webhooks/durabletask/instances/151c37c2bbc14f659ffb0a4d3ed9e54e?taskHub=TestHubName&amp;connection=Storage&amp;code=/XsKEv/uaBc41kmo1ayzMMhI7mh5fNazn4azktrpMbJtuEnSnpm1lA==&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sendEventPostUri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:7071/runtime/webhooks/durabletask/instances/151c37c2bbc14f659ffb0a4d3ed9e54e/raiseEvent/{eventName}?taskHub=TestHubName&amp;connection=Storage&amp;code=/XsKEv/uaBc41kmo1ayzMMhI7mh5fNazn4azktrpMbJtuEnSnpm1lA==&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;terminatePostUri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:7071/runtime/webhooks/durabletask/instances/151c37c2bbc14f659ffb0a4d3ed9e54e/terminate?reason={text}&amp;taskHub=TestHubName&amp;connection=Storage&amp;code=/XsKEv/uaBc41kmo1ayzMMhI7mh5fNazn4azktrpMbJtuEnSnpm1lA==&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;purgeHistoryDeleteUri&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:7071/runtime/webhooks/durabletask/instances/151c37c2bbc14f659ffb0a4d3ed9e54e?taskHub=TestHubName&amp;connection=Storage&amp;code=/XsKEv/uaBc41kmo1ayzMMhI7mh5fNazn4azktrpMbJtuEnSnpm1lA==&quot;</span>
<span class="token punctuation">}</span>
``` 

What's interesting for us to know at this point is what did we end up producing? The answer lies in the URL called `statusQueryGetUri`. Let's follow that link<span class="token operator">:</span>

```json
<span class="token comment">// 20200721122529</span>
<span class="token comment">// http://localhost:7071/runtime/webhooks/durabletask/instances/e1d7e237acb74834a02854050805712e?taskHub=TestHubName&amp;connection=Storage&amp;code=/XsKEv/uaBc41kmo1ayzMMhI7mh5fNazn4azktrpMbJtuEnSnpm1lA==</span>

<span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Orchestration&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;instanceId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e1d7e237acb74834a02854050805712e&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;runtimeStatus&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Completed&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;input&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">&quot;customStatus&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
  <span class="token property">&quot;output&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;Hello Tokyo!&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Hello Seattle!&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Hello London!&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;createdTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-07-21T11:18:28Z&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lastUpdatedTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-07-21T11:24:25Z&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>As you can see above the response from our <code>Orchestration</code> function is an array consisting of the responses from all activity functions, like so:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;output&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">&quot;Hello Tokyo!&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Hello Seattle!&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;Hello London&quot;</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>It ended up that way because of the way we constructed the code, we wrote this:</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code>outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tokyo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Seattle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
outputs<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">await</span> context<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">CallActivityAsync</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;Orchestration_Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;London&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>## Summary</p> <p>There is so much more to learn about Durable Functions but I can already hear some of you snore at this point which is why we will save topics such as Application Patterns and implementation of a pattern Fan-out/fan-in for the next part.</p> <p>So, I hope you are excited about that one.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e3a22685.js" defer></script><script src="/assets/js/9.454b5262.js" defer></script><script src="/assets/js/4.eac68367.js" defer></script><script src="/assets/js/150.b4ba556a.js" defer></script>
  </body>
</html>
