<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Learn Kubernetes - from the beginning, part III scaling my app</title>
    <meta name="description" content="[object Object]">
    <head link="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-abap.js"></head>
    
    <link rel="preload" href="/assets/css/0.styles.f3cdb744.css" as="style"><link rel="preload" href="/assets/js/app.8c96a5ac.js" as="script"><link rel="preload" href="/assets/js/9.20ba5650.js" as="script"><link rel="preload" href="/assets/js/4.b33b06f6.js" as="script"><link rel="preload" href="/assets/js/139.e7e2f4fc.js" as="script"><link rel="prefetch" href="/assets/js/1.76e1fa2c.js"><link rel="prefetch" href="/assets/js/10.e78e8506.js"><link rel="prefetch" href="/assets/js/100.9f271bb1.js"><link rel="prefetch" href="/assets/js/101.160d2e9a.js"><link rel="prefetch" href="/assets/js/102.6d37d64b.js"><link rel="prefetch" href="/assets/js/103.89772e5e.js"><link rel="prefetch" href="/assets/js/104.cff87ef0.js"><link rel="prefetch" href="/assets/js/105.e9f14a21.js"><link rel="prefetch" href="/assets/js/106.c2d324ee.js"><link rel="prefetch" href="/assets/js/107.e56bde0a.js"><link rel="prefetch" href="/assets/js/108.55239339.js"><link rel="prefetch" href="/assets/js/109.bdab2a38.js"><link rel="prefetch" href="/assets/js/11.836ffd95.js"><link rel="prefetch" href="/assets/js/110.db4d057c.js"><link rel="prefetch" href="/assets/js/111.46445704.js"><link rel="prefetch" href="/assets/js/112.c1f25142.js"><link rel="prefetch" href="/assets/js/113.49fa1ce6.js"><link rel="prefetch" href="/assets/js/114.9b04881b.js"><link rel="prefetch" href="/assets/js/115.9fc9e232.js"><link rel="prefetch" href="/assets/js/116.90a64bf4.js"><link rel="prefetch" href="/assets/js/117.23d35494.js"><link rel="prefetch" href="/assets/js/118.47c182d8.js"><link rel="prefetch" href="/assets/js/119.5ff673f9.js"><link rel="prefetch" href="/assets/js/12.0ed640a1.js"><link rel="prefetch" href="/assets/js/120.50d25635.js"><link rel="prefetch" href="/assets/js/121.7e97bf0f.js"><link rel="prefetch" href="/assets/js/122.c2faa5b2.js"><link rel="prefetch" href="/assets/js/123.178e669e.js"><link rel="prefetch" href="/assets/js/124.26c930f2.js"><link rel="prefetch" href="/assets/js/125.c343cfda.js"><link rel="prefetch" href="/assets/js/126.517d61f6.js"><link rel="prefetch" href="/assets/js/127.86cce6e8.js"><link rel="prefetch" href="/assets/js/128.3c8f7db6.js"><link rel="prefetch" href="/assets/js/129.586ef1be.js"><link rel="prefetch" href="/assets/js/13.9b870990.js"><link rel="prefetch" href="/assets/js/130.c932cc50.js"><link rel="prefetch" href="/assets/js/131.4e2fe734.js"><link rel="prefetch" href="/assets/js/132.1b0009d2.js"><link rel="prefetch" href="/assets/js/133.45065461.js"><link rel="prefetch" href="/assets/js/134.5e7a52d1.js"><link rel="prefetch" href="/assets/js/135.dac10c72.js"><link rel="prefetch" href="/assets/js/136.0b82340b.js"><link rel="prefetch" href="/assets/js/137.5f16faab.js"><link rel="prefetch" href="/assets/js/138.c2345556.js"><link rel="prefetch" href="/assets/js/14.4794068b.js"><link rel="prefetch" href="/assets/js/140.67e7e471.js"><link rel="prefetch" href="/assets/js/141.7a130991.js"><link rel="prefetch" href="/assets/js/142.babf56eb.js"><link rel="prefetch" href="/assets/js/143.eb8e2fdc.js"><link rel="prefetch" href="/assets/js/144.28b1ecf4.js"><link rel="prefetch" href="/assets/js/145.961ac7e9.js"><link rel="prefetch" href="/assets/js/146.afb0cb53.js"><link rel="prefetch" href="/assets/js/147.7daacdff.js"><link rel="prefetch" href="/assets/js/148.5be44647.js"><link rel="prefetch" href="/assets/js/149.dfd05b01.js"><link rel="prefetch" href="/assets/js/15.e392c70f.js"><link rel="prefetch" href="/assets/js/150.9beacbeb.js"><link rel="prefetch" href="/assets/js/151.94914b22.js"><link rel="prefetch" href="/assets/js/152.98fb8ae8.js"><link rel="prefetch" href="/assets/js/153.e65e43a4.js"><link rel="prefetch" href="/assets/js/154.9257ceb0.js"><link rel="prefetch" href="/assets/js/155.d95701eb.js"><link rel="prefetch" href="/assets/js/156.749f7732.js"><link rel="prefetch" href="/assets/js/16.019de8ce.js"><link rel="prefetch" href="/assets/js/17.c628a80f.js"><link rel="prefetch" href="/assets/js/18.4ab7403e.js"><link rel="prefetch" href="/assets/js/19.ae2840ee.js"><link rel="prefetch" href="/assets/js/20.f35f7928.js"><link rel="prefetch" href="/assets/js/21.b56d9e83.js"><link rel="prefetch" href="/assets/js/22.ddc02800.js"><link rel="prefetch" href="/assets/js/23.f071d7ac.js"><link rel="prefetch" href="/assets/js/24.32bba910.js"><link rel="prefetch" href="/assets/js/25.e37583c4.js"><link rel="prefetch" href="/assets/js/26.a10546b0.js"><link rel="prefetch" href="/assets/js/27.a14dc72b.js"><link rel="prefetch" href="/assets/js/28.523ca887.js"><link rel="prefetch" href="/assets/js/29.a8869a85.js"><link rel="prefetch" href="/assets/js/3.95140222.js"><link rel="prefetch" href="/assets/js/30.d6dee1ef.js"><link rel="prefetch" href="/assets/js/31.7d7e60c3.js"><link rel="prefetch" href="/assets/js/32.7ed90aa0.js"><link rel="prefetch" href="/assets/js/33.bc985518.js"><link rel="prefetch" href="/assets/js/34.0a3b552f.js"><link rel="prefetch" href="/assets/js/35.40f3020b.js"><link rel="prefetch" href="/assets/js/36.5fb6f635.js"><link rel="prefetch" href="/assets/js/37.bbfe4251.js"><link rel="prefetch" href="/assets/js/38.78dce1f3.js"><link rel="prefetch" href="/assets/js/39.64d08d4e.js"><link rel="prefetch" href="/assets/js/40.18bf0852.js"><link rel="prefetch" href="/assets/js/41.4cce3a1c.js"><link rel="prefetch" href="/assets/js/42.b53de554.js"><link rel="prefetch" href="/assets/js/43.c5471ea1.js"><link rel="prefetch" href="/assets/js/44.a5a36f06.js"><link rel="prefetch" href="/assets/js/45.931abcf1.js"><link rel="prefetch" href="/assets/js/46.29a07c70.js"><link rel="prefetch" href="/assets/js/47.ea4a708d.js"><link rel="prefetch" href="/assets/js/48.e01067bc.js"><link rel="prefetch" href="/assets/js/49.40bc9c85.js"><link rel="prefetch" href="/assets/js/5.44d1fb4e.js"><link rel="prefetch" href="/assets/js/50.f591266f.js"><link rel="prefetch" href="/assets/js/51.77d16183.js"><link rel="prefetch" href="/assets/js/52.ab81ebd7.js"><link rel="prefetch" href="/assets/js/53.27264aee.js"><link rel="prefetch" href="/assets/js/54.733a10fa.js"><link rel="prefetch" href="/assets/js/55.90fb8ebb.js"><link rel="prefetch" href="/assets/js/56.23b35d89.js"><link rel="prefetch" href="/assets/js/57.7def6b4a.js"><link rel="prefetch" href="/assets/js/58.89ab3d68.js"><link rel="prefetch" href="/assets/js/59.4fa61218.js"><link rel="prefetch" href="/assets/js/6.67cc1f3f.js"><link rel="prefetch" href="/assets/js/60.53f7b467.js"><link rel="prefetch" href="/assets/js/61.95a028c2.js"><link rel="prefetch" href="/assets/js/62.2cd74190.js"><link rel="prefetch" href="/assets/js/63.7cb0dbb1.js"><link rel="prefetch" href="/assets/js/64.8ebf3831.js"><link rel="prefetch" href="/assets/js/65.747f44ba.js"><link rel="prefetch" href="/assets/js/66.a224a0e5.js"><link rel="prefetch" href="/assets/js/67.b46f3f0e.js"><link rel="prefetch" href="/assets/js/68.42484148.js"><link rel="prefetch" href="/assets/js/69.83c2b112.js"><link rel="prefetch" href="/assets/js/7.30873a64.js"><link rel="prefetch" href="/assets/js/70.f4d3718c.js"><link rel="prefetch" href="/assets/js/71.002d32ef.js"><link rel="prefetch" href="/assets/js/72.869bc145.js"><link rel="prefetch" href="/assets/js/73.b3b74d9d.js"><link rel="prefetch" href="/assets/js/74.03102f8d.js"><link rel="prefetch" href="/assets/js/75.4e93e65b.js"><link rel="prefetch" href="/assets/js/76.e137a1da.js"><link rel="prefetch" href="/assets/js/77.614596eb.js"><link rel="prefetch" href="/assets/js/78.e801891e.js"><link rel="prefetch" href="/assets/js/79.6a1f078a.js"><link rel="prefetch" href="/assets/js/8.988484b0.js"><link rel="prefetch" href="/assets/js/80.0b0176a2.js"><link rel="prefetch" href="/assets/js/81.a5d77e4c.js"><link rel="prefetch" href="/assets/js/82.f15537f4.js"><link rel="prefetch" href="/assets/js/83.088ef873.js"><link rel="prefetch" href="/assets/js/84.af0157a0.js"><link rel="prefetch" href="/assets/js/85.eab9b9ef.js"><link rel="prefetch" href="/assets/js/86.9a4955c0.js"><link rel="prefetch" href="/assets/js/87.d8b99fa7.js"><link rel="prefetch" href="/assets/js/88.ff88d7fb.js"><link rel="prefetch" href="/assets/js/89.61b24378.js"><link rel="prefetch" href="/assets/js/90.249cfadf.js"><link rel="prefetch" href="/assets/js/91.6bca8497.js"><link rel="prefetch" href="/assets/js/92.964c7e9b.js"><link rel="prefetch" href="/assets/js/93.fa43b929.js"><link rel="prefetch" href="/assets/js/94.660e6988.js"><link rel="prefetch" href="/assets/js/95.667d0e2c.js"><link rel="prefetch" href="/assets/js/96.8d5a62c9.js"><link rel="prefetch" href="/assets/js/97.02285dcd.js"><link rel="prefetch" href="/assets/js/98.4bb921ce.js"><link rel="prefetch" href="/assets/js/99.20cbd72a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f3cdb744.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><a href="/author/" class="nav-link">Author</a></div><div class="nav-item"><a href="/articles/" class="nav-link">Blog</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Learn Kubernetes - from the beginning, part III scaling my app</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/kubernetes-three.html#resources" class="sidebar-link">Resources</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/kubernetes-three.html#scaling-demo-lab" class="sidebar-link">Scaling demo Lab</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/kubernetes-three.html#let-s-scale" class="sidebar-link">Let's scale</a></li><li class="sidebar-sub-header"><a href="/pages/kubernetes-three.html#does-it-load-balance" class="sidebar-link">Does it load balance?</a></li><li class="sidebar-sub-header"><a href="/pages/kubernetes-three.html#scaling-down" class="sidebar-link">Scaling down</a></li></ul></li><li><a href="/pages/kubernetes-three.html#self-healing" class="sidebar-link">Self-healing</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/kubernetes-three.html#different-ways-to-scale" class="sidebar-link">Different ways to scale</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/kubernetes-three.html#summary" class="sidebar-link">Summary</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="learn-kubernetes-from-the-beginning-part-iii-scaling-my-app"><a href="#learn-kubernetes-from-the-beginning-part-iii-scaling-my-app" aria-hidden="true" class="header-anchor">#</a> Learn Kubernetes - from the beginning, part III scaling my app</h1> <p>Follow me on <a href="https://twitter.com/chris_noring" target="_blank" rel="noopener noreferrer">Twitter<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, happy to take your suggestions on topics or improvements /Chris</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/gbc8lilsj6icishim13r.jpg" alt=""></p> <blockquote><p>This third part aims to show how you scale your application. We can easily set the number of Replicas we want of a certain application and let Kubernetes figure out how to do that. This is us defining a so-called <em>desired state</em>.</p></blockquote> <p>When traffic increases, we will need to scale the application to keep up with user demand. We've talked about deployments and services, now lets talk scaling.</p> <ul><li><a href="https://softchris.github.io/pages/kubernetes-one.html" target="_blank" rel="noopener noreferrer">Part I - from the beginning, Part I, Basics, Deployment and Minikube<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
In this part, we cover why Kubernetes, some history and some basic concepts like deploying, Nodes, Pods.</li> <li><a href="https://softchris.github.io/pages/kubernetes-two.html" target="_blank" rel="noopener noreferrer">Part II - introducing Services and Labeling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
In this part, we deepen our knowledge of Pods and Nodes. We also introduce Services and labeling using labels to query our artifacts.</li> <li>Part III - Scaling, <strong>we are here</strong></li> <li><a href="https://softchris.github.io/pages/kubernetes-four.html" target="_blank" rel="noopener noreferrer">Part IV - Auto scaling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> In this part we look at how to set up auto-scaling so we can handle sudden large increases of incoming requests</li></ul> <blockquote><p>What does scaling mean in the context of Kubernetes?</p></blockquote> <p>We get more Pods. More Pods that are scheduled to nodes.</p> <p>Now it's time to talk about <em>desired state</em> again, that we mentioned in previous parts.</p> <p>This is where we relinquish control to Kubernetes. All we need to do is tell Kubernetes how many Pods we want and Kubernetes does the rest.</p> <blockquote><p>So we tell Kubernetes about the number of Pods we want, what does that mean? What does Kubernetes do for us?</p></blockquote> <p>It means we get multiple instances of our application. It also means traffic is being distributed to all of our Pods, ie. <em>load balancing</em>.</p> <p>Furthermore, Kubernetes, or more specifically, services within Kubernetes will monitor which Pods are available and send traffic to those Pods.</p> <h2 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h2> <ul><li><a href="https://azure.microsoft.com/en-gb/free/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Free Azure Account<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> If you want to try out AKS, Azure Kubernetes Service, you will need a free Azure account</li> <li><a href="https://kubernetes.io" target="_blank" rel="noopener noreferrer">Kubernetes.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
One of the best resources to learn about Kubernetes is at this official Kubernetes site by Google.</li> <li><a href="https://azure.microsoft.com/en-gb/topic/kubernetes/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Kubernetes overview<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> An overview of Kubernetes, all its parts and how it works</li> <li><a href="https://azure.microsoft.com/en-gb/services/kubernetes-service/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Kubernetes in the Cloud<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Do you feel you know everything about Kubernetes already and just want to learn how to use a managed service? Then this link is for you</li> <li><a href="https://docs.microsoft.com/en-gb/azure/aks/?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Documentation on AKS, Azure Kubernetes Service<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
Azure Kubernetes Service, a managed Kubernetes</li> <li><a href="https://docs.microsoft.com/en-us/azure/aks/best-practices?wt.mc_id=personal-blog-chnoring" target="_blank" rel="noopener noreferrer">Best practices on AKS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> You already know AKS and want to learn how to use it better?</li></ul> <h2 id="scaling-demo-lab"><a href="#scaling-demo-lab" aria-hidden="true" class="header-anchor">#</a> Scaling demo Lab</h2> <p>If you haven't followed the first two parts I do recommend you go back and have a read. What you need for the following to work is at least a deployment. So if you haven't created one, here is how:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl run kubernetes-first-app --image=gcr.io/google-samples/kubernetes-bootcamp:v1 --port=8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let's have a look at our deployments:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get deployments
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let's look closer at the response we get:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/4aaumkq7u6b7i4dmms1z.png" alt=""></p> <p>We have three pieces of information that are important to us. First, we have the <code>READY</code> column in which we should read the value in the following way, <code>CURRENT STATE/DESIRED STATE</code>. Next up is the <code>UP_TO_DATE</code> column which shows the number of replicas that were updated to match the desired state.
Lastly, we have the <code>AVAILABLE</code> column that shows how many replicas we have available to do work.</p> <h3 id="let-s-scale"><a href="#let-s-scale" aria-hidden="true" class="header-anchor">#</a> Let's scale</h3> <p>Now, let's do some scaling. For that we will use the <code>scale</code> command like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl scale deployments/kubernetes-first-app --replicas=4 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/jvvpqmon3r2ttqt5tc06.png" alt=""></p> <p>as we can see above the number of replicas was increased to <code>4</code> and kubernetes is thereby ready to load balance any incoming requests.</p> <p>Let's have a look at our Pods next:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/upzhxkfxlmbt23nr52z3.png" alt=""></p> <p>When we asked for <code>4</code> replicas we got <code>4</code> Pods.</p> <p>We can see that this scaling operation took place by using the <code>describe</code> command, like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl describe deployments/kubernetes-first-app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/4q17yyfnkf7ahtfbzxn9.png" alt=""></p> <p>In the above image, we are given quite a lot of information on our <code>Replicas</code> for example, but there is some other information in there that we will explain later on.</p> <h3 id="does-it-load-balance"><a href="#does-it-load-balance" aria-hidden="true" class="header-anchor">#</a> Does it load balance?</h3> <p>The whole point with the scaling was so that we could balance the load on incoming requests. That means that not the same Pod would handle all the requests but that different Pods would be hit.
We can easily try this out, now that we have scaled our app to contain <code>4</code> replicas of itself.</p> <p>So far we used the <code>describe</code> command to describe the deployment but we can use it to describe the IP and port of. Once we have the IP and port we can then hit it with different HTTP requests.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl describe services/kubernetes-first-app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/ulqxs3mgl0pbjxozvtxo.png" alt=""></p> <p>Especially look at the <code>NodePort</code> and the <code>Endpoints</code>. <code>NodePort</code> is the port value that we want to hit with an HTTP request.</p> <p>Now we will actually invoke the cURL command and ensure that it hits a different port each time and thereby prove our load balancing is working. Let's do the following:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>NODE_PORT=30450
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Next up the cURL call:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>curl $(minikube ip):$NODE_PORT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/nl053zu36v7kjnhg2ou0.png" alt=""></p> <p>As you can see above we are doing the call 4 times. Judging by the output and the name of the instance we see that we are hitting a different Pod for each request. Thereby we see that the load balancing is working.</p> <h3 id="scaling-down"><a href="#scaling-down" aria-hidden="true" class="header-anchor">#</a> Scaling down</h3> <p>So far we have scaled up. We managed to go from one Pod to 4 Pods thanks to the <code>scale</code> command. We can use the same command to <em>scale down</em>, like so:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl scale deployments/kubernetes-first-app --replicas=2 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://thepracticaldev.s3.amazonaws.com/i/vjg7bi5l1jr2c5uznmf3.png" alt=""></p> <p>Now if we are really fast adding the next command we can see how the Pods are being removed as Kubernetes is trying to adjust to <em>desired state</em>.</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/z2u4j326zqfv71d3dehx.png" alt=""></p> <p>2 out of 4 Pods are saying <code>Terminating</code> as only 2 Pods are needed to maintain the new <em>desired state</em>.</p> <p>Running our command again we see that only 2 Pods remain and thereby our new <em>desired state</em> have been reached:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/ezqizyogxg36qu4tux2r.png" alt=""></p> <p>We can also look at our deployment to see that our <code>scale</code> instruction has been parsed correctly:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/cqdvsh1adbgbl82ntkfw.png" alt=""></p> <h2 id="self-healing"><a href="#self-healing" aria-hidden="true" class="header-anchor">#</a> Self-healing</h2> <p><em>Self-healing</em> is Kubernetes way of ensuring that the <em>desired state</em> is maintained. Pods don't self heal cause Pods can die. What happens is that a new Pod appears in its place, thanks to Kubernetes.</p> <blockquote><p>So how do we test this?</p></blockquote> <p>Glad you asked, we can delete a Pod and see what happens. So how do we do that? We use the <code>delete</code> command. We need to know the name of our Pod though so we need to call <code>get pods</code> for that. So let's start with that:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Then lets pick one of our two Pods <code>kubernetes-first-app-669789f4f8-6glpx</code> and assign it to a variable:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POD_NAME=kubernetes-first-app-669789f4f8-6glpx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Now remove it:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl delete pods $POD_NAME
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Let's be quick about it and check our Pod status with <code>get pods</code>. It should say <em>Terminating</em> like so:</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/yh5unu9kijodhrvpnx91.png" alt=""></p> <p>Wait some time and then echo out our variable <code>$POD_NAME</code> followed by <code>get pods</code>. That should give you a result similar to the below.</p> <p><img src="https://thepracticaldev.s3.amazonaws.com/i/qv87cbtz76bzkr2s0yfr.png" alt=""></p> <p>So what does the above image tell us? It tells us that the Pod we deleted is truly deleted but it also tells us that the <em>desired state</em> of two replicas has been achieved by spinning up a new Pod. What we are seeing is * self-healing* at work.</p> <h2 id="different-ways-to-scale"><a href="#different-ways-to-scale" aria-hidden="true" class="header-anchor">#</a> Different ways to scale</h2> <p>Ok, we looked at a way to scale by explicitly saying how many replicas we want of a certain deployment. Sometimes, however, we might want a different way to scale namely <em>auto-scaling</em>. Auto-scaling is about you not having to set the exact number of replicas you want but rather rely on Kubernetes to create the number of replicas it thinks it needs. So how would Kubernetes know that? Well, it can look at more than one thing but a common metric is CPU utilization. So let's say you have a booking site and suddenly someone releases Bruce Springsteen tickets you are likely to want to rely on auto-scaling, cause the next day when the tickets are all sold out you want the number of Pods to go back to normal and you wouldn't want to do this manually.</p> <p>Auto-scaling is a topic I plan to cover more in detail in a future article so if you are really curious how that is done I recommend you have a look <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="summary"><a href="#summary" aria-hidden="true" class="header-anchor">#</a> Summary</h2> <p>Ok. So we did it. We managed to scale an app by creating replicas of it. It wasn't so hard to accomplish. We showed how we only needed to provide Kubernetes with a <em>desired state</em> and it would do its utmost to preserve said state, also called * self-healing*. Furthermore, we mentioned that there was another way to scale, namely <em>auto-scaling</em> but decided to leave that topic for another article. Hopefully, you are now more in awe of how amazing Kubernetes is and how easy it is to scale your app.</p> <p><a href="https://softchris.github.io/pages/kubernetes-four.html" target="_blank" rel="noopener noreferrer">To part 4, auto scaling<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8c96a5ac.js" defer></script><script src="/assets/js/9.20ba5650.js" defer></script><script src="/assets/js/4.b33b06f6.js" defer></script><script src="/assets/js/139.e7e2f4fc.js" defer></script>
  </body>
</html>
